{"check_type": "terraform", "results": {"passed_checks": [{"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[23, "resource \"aws_security_group\" \"alb\" {\n"], [24, "  name        = \"openclaw-alb-sg\"\n"], [25, "  description = \"Security group for internal ALB\"\n"], [26, "  vpc_id      = aws_vpc.main.id\n"], [27, "\n"], [28, "  # Allow from CloudFront (VPC origin uses internal IPs)\n"], [29, "  ingress {\n"], [30, "    from_port   = 443\n"], [31, "    to_port     = 443\n"], [32, "    protocol    = \"tcp\"\n"], [33, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [34, "    description = \"HTTPS from VPC\"\n"], [35, "  }\n"], [36, "\n"], [37, "  ingress {\n"], [38, "    from_port   = 80\n"], [39, "    to_port     = 80\n"], [40, "    protocol    = \"tcp\"\n"], [41, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [42, "    description = \"HTTP from VPC\"\n"], [43, "  }\n"], [44, "\n"], [45, "  egress {\n"], [46, "    from_port   = 18789\n"], [47, "    to_port     = 18789\n"], [48, "    protocol    = \"tcp\"\n"], [49, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [50, "    description = \"Allow outbound to OpenClaw EC2\"\n"], [51, "  }\n"], [52, "\n"], [53, "  tags = {\n"], [54, "    Name = \"openclaw-alb-sg\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [23, 56], "resource": "aws_security_group.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "openclaw-alb-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "breadcrumbs": {"egress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "egress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[23, "resource \"aws_security_group\" \"alb\" {\n"], [24, "  name        = \"openclaw-alb-sg\"\n"], [25, "  description = \"Security group for internal ALB\"\n"], [26, "  vpc_id      = aws_vpc.main.id\n"], [27, "\n"], [28, "  # Allow from CloudFront (VPC origin uses internal IPs)\n"], [29, "  ingress {\n"], [30, "    from_port   = 443\n"], [31, "    to_port     = 443\n"], [32, "    protocol    = \"tcp\"\n"], [33, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [34, "    description = \"HTTPS from VPC\"\n"], [35, "  }\n"], [36, "\n"], [37, "  ingress {\n"], [38, "    from_port   = 80\n"], [39, "    to_port     = 80\n"], [40, "    protocol    = \"tcp\"\n"], [41, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [42, "    description = \"HTTP from VPC\"\n"], [43, "  }\n"], [44, "\n"], [45, "  egress {\n"], [46, "    from_port   = 18789\n"], [47, "    to_port     = 18789\n"], [48, "    protocol    = \"tcp\"\n"], [49, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [50, "    description = \"Allow outbound to OpenClaw EC2\"\n"], [51, "  }\n"], [52, "\n"], [53, "  tags = {\n"], [54, "    Name = \"openclaw-alb-sg\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [23, 56], "resource": "aws_security_group.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "openclaw-alb-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "breadcrumbs": {"egress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "egress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[23, "resource \"aws_security_group\" \"alb\" {\n"], [24, "  name        = \"openclaw-alb-sg\"\n"], [25, "  description = \"Security group for internal ALB\"\n"], [26, "  vpc_id      = aws_vpc.main.id\n"], [27, "\n"], [28, "  # Allow from CloudFront (VPC origin uses internal IPs)\n"], [29, "  ingress {\n"], [30, "    from_port   = 443\n"], [31, "    to_port     = 443\n"], [32, "    protocol    = \"tcp\"\n"], [33, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [34, "    description = \"HTTPS from VPC\"\n"], [35, "  }\n"], [36, "\n"], [37, "  ingress {\n"], [38, "    from_port   = 80\n"], [39, "    to_port     = 80\n"], [40, "    protocol    = \"tcp\"\n"], [41, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [42, "    description = \"HTTP from VPC\"\n"], [43, "  }\n"], [44, "\n"], [45, "  egress {\n"], [46, "    from_port   = 18789\n"], [47, "    to_port     = 18789\n"], [48, "    protocol    = \"tcp\"\n"], [49, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [50, "    description = \"Allow outbound to OpenClaw EC2\"\n"], [51, "  }\n"], [52, "\n"], [53, "  tags = {\n"], [54, "    Name = \"openclaw-alb-sg\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [23, 56], "resource": "aws_security_group.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "openclaw-alb-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "breadcrumbs": {"egress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "egress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["description"]}, "code_block": [[23, "resource \"aws_security_group\" \"alb\" {\n"], [24, "  name        = \"openclaw-alb-sg\"\n"], [25, "  description = \"Security group for internal ALB\"\n"], [26, "  vpc_id      = aws_vpc.main.id\n"], [27, "\n"], [28, "  # Allow from CloudFront (VPC origin uses internal IPs)\n"], [29, "  ingress {\n"], [30, "    from_port   = 443\n"], [31, "    to_port     = 443\n"], [32, "    protocol    = \"tcp\"\n"], [33, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [34, "    description = \"HTTPS from VPC\"\n"], [35, "  }\n"], [36, "\n"], [37, "  ingress {\n"], [38, "    from_port   = 80\n"], [39, "    to_port     = 80\n"], [40, "    protocol    = \"tcp\"\n"], [41, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [42, "    description = \"HTTP from VPC\"\n"], [43, "  }\n"], [44, "\n"], [45, "  egress {\n"], [46, "    from_port   = 18789\n"], [47, "    to_port     = 18789\n"], [48, "    protocol    = \"tcp\"\n"], [49, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [50, "    description = \"Allow outbound to OpenClaw EC2\"\n"], [51, "  }\n"], [52, "\n"], [53, "  tags = {\n"], [54, "    Name = \"openclaw-alb-sg\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [23, 56], "resource": "aws_security_group.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "openclaw-alb-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "breadcrumbs": {"egress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "egress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[23, "resource \"aws_security_group\" \"alb\" {\n"], [24, "  name        = \"openclaw-alb-sg\"\n"], [25, "  description = \"Security group for internal ALB\"\n"], [26, "  vpc_id      = aws_vpc.main.id\n"], [27, "\n"], [28, "  # Allow from CloudFront (VPC origin uses internal IPs)\n"], [29, "  ingress {\n"], [30, "    from_port   = 443\n"], [31, "    to_port     = 443\n"], [32, "    protocol    = \"tcp\"\n"], [33, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [34, "    description = \"HTTPS from VPC\"\n"], [35, "  }\n"], [36, "\n"], [37, "  ingress {\n"], [38, "    from_port   = 80\n"], [39, "    to_port     = 80\n"], [40, "    protocol    = \"tcp\"\n"], [41, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [42, "    description = \"HTTP from VPC\"\n"], [43, "  }\n"], [44, "\n"], [45, "  egress {\n"], [46, "    from_port   = 18789\n"], [47, "    to_port     = 18789\n"], [48, "    protocol    = \"tcp\"\n"], [49, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [50, "    description = \"Allow outbound to OpenClaw EC2\"\n"], [51, "  }\n"], [52, "\n"], [53, "  tags = {\n"], [54, "    Name = \"openclaw-alb-sg\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [23, 56], "resource": "aws_security_group.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "openclaw-alb-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "breadcrumbs": {"egress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "egress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[23, "resource \"aws_security_group\" \"alb\" {\n"], [24, "  name        = \"openclaw-alb-sg\"\n"], [25, "  description = \"Security group for internal ALB\"\n"], [26, "  vpc_id      = aws_vpc.main.id\n"], [27, "\n"], [28, "  # Allow from CloudFront (VPC origin uses internal IPs)\n"], [29, "  ingress {\n"], [30, "    from_port   = 443\n"], [31, "    to_port     = 443\n"], [32, "    protocol    = \"tcp\"\n"], [33, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [34, "    description = \"HTTPS from VPC\"\n"], [35, "  }\n"], [36, "\n"], [37, "  ingress {\n"], [38, "    from_port   = 80\n"], [39, "    to_port     = 80\n"], [40, "    protocol    = \"tcp\"\n"], [41, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [42, "    description = \"HTTP from VPC\"\n"], [43, "  }\n"], [44, "\n"], [45, "  egress {\n"], [46, "    from_port   = 18789\n"], [47, "    to_port     = 18789\n"], [48, "    protocol    = \"tcp\"\n"], [49, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [50, "    description = \"Allow outbound to OpenClaw EC2\"\n"], [51, "  }\n"], [52, "\n"], [53, "  tags = {\n"], [54, "    Name = \"openclaw-alb-sg\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [23, 56], "resource": "aws_security_group.alb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "openclaw-alb-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "breadcrumbs": {"egress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "egress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_150", "bc_check_id": "BC_AWS_NETWORKING_62", "check_name": "Ensure that Load Balancer has deletion protection enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_deletion_protection"]}, "code_block": [[58, "resource \"aws_lb\" \"internal\" {\n"], [59, "  name                       = \"openclaw-internal-alb\"\n"], [60, "  internal                   = true # Not internet-facing\n"], [61, "  load_balancer_type         = \"application\"\n"], [62, "  security_groups            = [aws_security_group.alb.id]\n"], [63, "  subnets                    = [aws_subnet.private_a.id, aws_subnet.private_b.id]\n"], [64, "  enable_deletion_protection = true\n"], [65, "  drop_invalid_header_fields = true\n"], [66, "\n"], [67, "  tags = {\n"], [68, "    Name = \"openclaw-internal-alb\"\n"], [69, "  }\n"], [70, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [58, 70], "resource": "aws_lb.internal", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBDeletionProtection", "fixed_definition": null, "entity_tags": {"Name": "openclaw-internal-alb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-150", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_328", "bc_check_id": "BC_AWS_NETWORKING_89", "check_name": "Ensure that ALB is configured with defensive or strictest desync mitigation mode", "check_result": {"result": "PASSED", "evaluated_keys": ["desync_mitigation_mode"]}, "code_block": [[58, "resource \"aws_lb\" \"internal\" {\n"], [59, "  name                       = \"openclaw-internal-alb\"\n"], [60, "  internal                   = true # Not internet-facing\n"], [61, "  load_balancer_type         = \"application\"\n"], [62, "  security_groups            = [aws_security_group.alb.id]\n"], [63, "  subnets                    = [aws_subnet.private_a.id, aws_subnet.private_b.id]\n"], [64, "  enable_deletion_protection = true\n"], [65, "  drop_invalid_header_fields = true\n"], [66, "\n"], [67, "  tags = {\n"], [68, "    Name = \"openclaw-internal-alb\"\n"], [69, "  }\n"], [70, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [58, 70], "resource": "aws_lb.internal", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBDesyncMode", "fixed_definition": null, "entity_tags": {"Name": "openclaw-internal-alb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-328", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_131", "bc_check_id": "BC_AWS_NETWORKING_41", "check_name": "Ensure that ALB drops HTTP headers", "check_result": {"result": "PASSED", "evaluated_keys": ["drop_invalid_header_fields"]}, "code_block": [[58, "resource \"aws_lb\" \"internal\" {\n"], [59, "  name                       = \"openclaw-internal-alb\"\n"], [60, "  internal                   = true # Not internet-facing\n"], [61, "  load_balancer_type         = \"application\"\n"], [62, "  security_groups            = [aws_security_group.alb.id]\n"], [63, "  subnets                    = [aws_subnet.private_a.id, aws_subnet.private_b.id]\n"], [64, "  enable_deletion_protection = true\n"], [65, "  drop_invalid_header_fields = true\n"], [66, "\n"], [67, "  tags = {\n"], [68, "    Name = \"openclaw-internal-alb\"\n"], [69, "  }\n"], [70, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [58, 70], "resource": "aws_lb.internal", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBDropHttpHeaders", "fixed_definition": null, "entity_tags": {"Name": "openclaw-internal-alb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-alb-drops-http-headers", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_261", "bc_check_id": "BC_AWS_GENERAL_177", "check_name": "Ensure HTTP HTTPS Target group defines Healthcheck", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[72, "resource \"aws_lb_target_group\" \"openclaw\" {\n"], [73, "  name        = \"openclaw-tg\"\n"], [74, "  port        = 18789\n"], [75, "  protocol    = \"HTTP\"\n"], [76, "  vpc_id      = aws_vpc.main.id\n"], [77, "  target_type = \"instance\"\n"], [78, "\n"], [79, "  health_check {\n"], [80, "    enabled             = true\n"], [81, "    healthy_threshold   = 2\n"], [82, "    unhealthy_threshold = 3\n"], [83, "    timeout             = 5\n"], [84, "    interval            = 30\n"], [85, "    path                = \"/health\"\n"], [86, "    protocol            = \"HTTP\"\n"], [87, "  }\n"], [88, "\n"], [89, "  tags = {\n"], [90, "    Name = \"openclaw-tg\"\n"], [91, "  }\n"], [92, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [72, 92], "resource": "aws_lb_target_group.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LBTargetGroupsDefinesHealthcheck", "fixed_definition": null, "entity_tags": {"Name": "openclaw-tg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-kendra-index-server-side-encryption-uses-customer-managed-keys-cmks", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_374", "bc_check_id": "BC_AWS_NETWORKING_97", "check_name": "Ensure AWS CloudFront web distribution has geo restriction enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrictions/[0]/geo_restriction/[0]/restriction_type"]}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudFrontGeoRestrictionDisabled", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-374", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_34", "bc_check_id": "BC_AWS_NETWORKING_32", "check_name": "Ensure CloudFront distribution ViewerProtocolPolicy is set to HTTPS", "check_result": {"result": "PASSED", "evaluated_keys": ["default_cache_behavior/[0]/viewer_protocol_policy"]}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionEncryption", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-32", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_68", "bc_check_id": "BC_AWS_GENERAL_27", "check_name": "CloudFront Distribution should have WAF enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["web_acl_id"]}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFEnabled", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-27", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_216", "bc_check_id": "BC_AWS_GENERAL_148", "check_name": "Ensure CloudFront distribution is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enabled"]}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionEnabled", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-cloudfront-distribution-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_192", "bc_check_id": "BC_AWS_NETWORKING_61", "check_name": "Ensure WAF prevents message lookup in Log4j2. See CVE-2021-44228 aka log4jshell", "check_result": {"result": "PASSED", "evaluated_keys": ["rule/[2]/statement/[0]/managed_rule_group_statement/[0]/name", "rule/[2]/statement/[0]/managed_rule_group_statement/[0]/excluded_rule", "rule/[2]/override_action/[0]/none"]}, "code_block": [[189, "resource \"aws_wafv2_web_acl\" \"main\" {\n"], [190, "  name        = \"openclaw-waf\"\n"], [191, "  description = \"WAF rules for OpenClaw\"\n"], [192, "  scope       = \"CLOUDFRONT\"\n"], [193, "\n"], [194, "  # Default action - allow traffic that doesn't match any rules\n"], [195, "  default_action {\n"], [196, "    allow {}\n"], [197, "  }\n"], [198, "\n"], [199, "  # Rule 1: Rate limiting - prevent DDoS/brute force\n"], [200, "  rule {\n"], [201, "    name     = \"RateLimitRule\"\n"], [202, "    priority = 1\n"], [203, "\n"], [204, "    override_action {\n"], [205, "      none {}\n"], [206, "    }\n"], [207, "\n"], [208, "    statement {\n"], [209, "      rate_based_statement {\n"], [210, "        limit              = var.waf_rate_limit\n"], [211, "        aggregate_key_type = \"IP\"\n"], [212, "      }\n"], [213, "    }\n"], [214, "\n"], [215, "    visibility_config {\n"], [216, "      cloudwatch_metrics_enabled = true\n"], [217, "      metric_name                = \"RateLimitRule\"\n"], [218, "      sampled_requests_enabled   = true\n"], [219, "    }\n"], [220, "  }\n"], [221, "\n"], [222, "  # Rule 2: AWS Managed Common Rule Set\n"], [223, "  rule {\n"], [224, "    name     = \"AWSManagedRulesCommonRuleSet\"\n"], [225, "    priority = 2\n"], [226, "\n"], [227, "    override_action {\n"], [228, "      none {}\n"], [229, "    }\n"], [230, "\n"], [231, "    statement {\n"], [232, "      managed_rule_group_statement {\n"], [233, "        name        = \"AWSManagedRulesCommonRuleSet\"\n"], [234, "        vendor_name = \"AWS\"\n"], [235, "      }\n"], [236, "    }\n"], [237, "\n"], [238, "    visibility_config {\n"], [239, "      cloudwatch_metrics_enabled = true\n"], [240, "      metric_name                = \"AWSManagedRulesCommonRuleSet\"\n"], [241, "      sampled_requests_enabled   = true\n"], [242, "    }\n"], [243, "  }\n"], [244, "\n"], [245, "  # Rule 3: Known Bad Inputs\n"], [246, "  rule {\n"], [247, "    name     = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [248, "    priority = 3\n"], [249, "\n"], [250, "    override_action {\n"], [251, "      none {}\n"], [252, "    }\n"], [253, "\n"], [254, "    statement {\n"], [255, "      managed_rule_group_statement {\n"], [256, "        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [257, "        vendor_name = \"AWS\"\n"], [258, "      }\n"], [259, "    }\n"], [260, "\n"], [261, "    visibility_config {\n"], [262, "      cloudwatch_metrics_enabled = true\n"], [263, "      metric_name                = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [264, "      sampled_requests_enabled   = true\n"], [265, "    }\n"], [266, "  }\n"], [267, "\n"], [268, "  # Rule 4: IP Reputation\n"], [269, "  rule {\n"], [270, "    name     = \"AWSManagedRulesAmazonIpReputationList\"\n"], [271, "    priority = 4\n"], [272, "\n"], [273, "    override_action {\n"], [274, "      none {}\n"], [275, "    }\n"], [276, "\n"], [277, "    statement {\n"], [278, "      managed_rule_group_statement {\n"], [279, "        name        = \"AWSManagedRulesAmazonIpReputationList\"\n"], [280, "        vendor_name = \"AWS\"\n"], [281, "      }\n"], [282, "    }\n"], [283, "\n"], [284, "    visibility_config {\n"], [285, "      cloudwatch_metrics_enabled = true\n"], [286, "      metric_name                = \"AWSManagedRulesAmazonIpReputationList\"\n"], [287, "      sampled_requests_enabled   = true\n"], [288, "    }\n"], [289, "  }\n"], [290, "\n"], [291, "  visibility_config {\n"], [292, "    cloudwatch_metrics_enabled = true\n"], [293, "    metric_name                = \"openclaw-waf\"\n"], [294, "    sampled_requests_enabled   = true\n"], [295, "  }\n"], [296, "\n"], [297, "  tags = {\n"], [298, "    Name = \"openclaw-waf\"\n"], [299, "  }\n"], [300, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [189, 300], "resource": "aws_wafv2_web_acl.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFACLCVE202144228", "fixed_definition": null, "entity_tags": {"Name": "openclaw-waf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-waf-prevents-message-lookup-in-log4j2", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "breadcrumbs": {"rule.0.statement.rate_based_statement.limit": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "rule.0.statement.rate_based_statement": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "rule.0.statement": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "rule.0": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_342", "bc_check_id": "BC_AWS_GENERAL_245", "check_name": "Ensure WAF rule has any actions", "check_result": {"result": "PASSED", "evaluated_keys": ["rule", "rules", "activated_rule"]}, "code_block": [[189, "resource \"aws_wafv2_web_acl\" \"main\" {\n"], [190, "  name        = \"openclaw-waf\"\n"], [191, "  description = \"WAF rules for OpenClaw\"\n"], [192, "  scope       = \"CLOUDFRONT\"\n"], [193, "\n"], [194, "  # Default action - allow traffic that doesn't match any rules\n"], [195, "  default_action {\n"], [196, "    allow {}\n"], [197, "  }\n"], [198, "\n"], [199, "  # Rule 1: Rate limiting - prevent DDoS/brute force\n"], [200, "  rule {\n"], [201, "    name     = \"RateLimitRule\"\n"], [202, "    priority = 1\n"], [203, "\n"], [204, "    override_action {\n"], [205, "      none {}\n"], [206, "    }\n"], [207, "\n"], [208, "    statement {\n"], [209, "      rate_based_statement {\n"], [210, "        limit              = var.waf_rate_limit\n"], [211, "        aggregate_key_type = \"IP\"\n"], [212, "      }\n"], [213, "    }\n"], [214, "\n"], [215, "    visibility_config {\n"], [216, "      cloudwatch_metrics_enabled = true\n"], [217, "      metric_name                = \"RateLimitRule\"\n"], [218, "      sampled_requests_enabled   = true\n"], [219, "    }\n"], [220, "  }\n"], [221, "\n"], [222, "  # Rule 2: AWS Managed Common Rule Set\n"], [223, "  rule {\n"], [224, "    name     = \"AWSManagedRulesCommonRuleSet\"\n"], [225, "    priority = 2\n"], [226, "\n"], [227, "    override_action {\n"], [228, "      none {}\n"], [229, "    }\n"], [230, "\n"], [231, "    statement {\n"], [232, "      managed_rule_group_statement {\n"], [233, "        name        = \"AWSManagedRulesCommonRuleSet\"\n"], [234, "        vendor_name = \"AWS\"\n"], [235, "      }\n"], [236, "    }\n"], [237, "\n"], [238, "    visibility_config {\n"], [239, "      cloudwatch_metrics_enabled = true\n"], [240, "      metric_name                = \"AWSManagedRulesCommonRuleSet\"\n"], [241, "      sampled_requests_enabled   = true\n"], [242, "    }\n"], [243, "  }\n"], [244, "\n"], [245, "  # Rule 3: Known Bad Inputs\n"], [246, "  rule {\n"], [247, "    name     = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [248, "    priority = 3\n"], [249, "\n"], [250, "    override_action {\n"], [251, "      none {}\n"], [252, "    }\n"], [253, "\n"], [254, "    statement {\n"], [255, "      managed_rule_group_statement {\n"], [256, "        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [257, "        vendor_name = \"AWS\"\n"], [258, "      }\n"], [259, "    }\n"], [260, "\n"], [261, "    visibility_config {\n"], [262, "      cloudwatch_metrics_enabled = true\n"], [263, "      metric_name                = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [264, "      sampled_requests_enabled   = true\n"], [265, "    }\n"], [266, "  }\n"], [267, "\n"], [268, "  # Rule 4: IP Reputation\n"], [269, "  rule {\n"], [270, "    name     = \"AWSManagedRulesAmazonIpReputationList\"\n"], [271, "    priority = 4\n"], [272, "\n"], [273, "    override_action {\n"], [274, "      none {}\n"], [275, "    }\n"], [276, "\n"], [277, "    statement {\n"], [278, "      managed_rule_group_statement {\n"], [279, "        name        = \"AWSManagedRulesAmazonIpReputationList\"\n"], [280, "        vendor_name = \"AWS\"\n"], [281, "      }\n"], [282, "    }\n"], [283, "\n"], [284, "    visibility_config {\n"], [285, "      cloudwatch_metrics_enabled = true\n"], [286, "      metric_name                = \"AWSManagedRulesAmazonIpReputationList\"\n"], [287, "      sampled_requests_enabled   = true\n"], [288, "    }\n"], [289, "  }\n"], [290, "\n"], [291, "  visibility_config {\n"], [292, "    cloudwatch_metrics_enabled = true\n"], [293, "    metric_name                = \"openclaw-waf\"\n"], [294, "    sampled_requests_enabled   = true\n"], [295, "  }\n"], [296, "\n"], [297, "  tags = {\n"], [298, "    Name = \"openclaw-waf\"\n"], [299, "  }\n"], [300, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [189, 300], "resource": "aws_wafv2_web_acl.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFRuleHasAnyActions", "fixed_definition": null, "entity_tags": {"Name": "openclaw-waf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-342", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "breadcrumbs": {"rule.0.statement.rate_based_statement.limit": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "rule.0.statement.rate_based_statement": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "rule.0.statement": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "rule.0": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_175", "bc_check_id": "BC_AWS_NETWORKING_64", "check_name": "Ensure WAF has associated rules", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[189, "resource \"aws_wafv2_web_acl\" \"main\" {\n"], [190, "  name        = \"openclaw-waf\"\n"], [191, "  description = \"WAF rules for OpenClaw\"\n"], [192, "  scope       = \"CLOUDFRONT\"\n"], [193, "\n"], [194, "  # Default action - allow traffic that doesn't match any rules\n"], [195, "  default_action {\n"], [196, "    allow {}\n"], [197, "  }\n"], [198, "\n"], [199, "  # Rule 1: Rate limiting - prevent DDoS/brute force\n"], [200, "  rule {\n"], [201, "    name     = \"RateLimitRule\"\n"], [202, "    priority = 1\n"], [203, "\n"], [204, "    override_action {\n"], [205, "      none {}\n"], [206, "    }\n"], [207, "\n"], [208, "    statement {\n"], [209, "      rate_based_statement {\n"], [210, "        limit              = var.waf_rate_limit\n"], [211, "        aggregate_key_type = \"IP\"\n"], [212, "      }\n"], [213, "    }\n"], [214, "\n"], [215, "    visibility_config {\n"], [216, "      cloudwatch_metrics_enabled = true\n"], [217, "      metric_name                = \"RateLimitRule\"\n"], [218, "      sampled_requests_enabled   = true\n"], [219, "    }\n"], [220, "  }\n"], [221, "\n"], [222, "  # Rule 2: AWS Managed Common Rule Set\n"], [223, "  rule {\n"], [224, "    name     = \"AWSManagedRulesCommonRuleSet\"\n"], [225, "    priority = 2\n"], [226, "\n"], [227, "    override_action {\n"], [228, "      none {}\n"], [229, "    }\n"], [230, "\n"], [231, "    statement {\n"], [232, "      managed_rule_group_statement {\n"], [233, "        name        = \"AWSManagedRulesCommonRuleSet\"\n"], [234, "        vendor_name = \"AWS\"\n"], [235, "      }\n"], [236, "    }\n"], [237, "\n"], [238, "    visibility_config {\n"], [239, "      cloudwatch_metrics_enabled = true\n"], [240, "      metric_name                = \"AWSManagedRulesCommonRuleSet\"\n"], [241, "      sampled_requests_enabled   = true\n"], [242, "    }\n"], [243, "  }\n"], [244, "\n"], [245, "  # Rule 3: Known Bad Inputs\n"], [246, "  rule {\n"], [247, "    name     = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [248, "    priority = 3\n"], [249, "\n"], [250, "    override_action {\n"], [251, "      none {}\n"], [252, "    }\n"], [253, "\n"], [254, "    statement {\n"], [255, "      managed_rule_group_statement {\n"], [256, "        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [257, "        vendor_name = \"AWS\"\n"], [258, "      }\n"], [259, "    }\n"], [260, "\n"], [261, "    visibility_config {\n"], [262, "      cloudwatch_metrics_enabled = true\n"], [263, "      metric_name                = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [264, "      sampled_requests_enabled   = true\n"], [265, "    }\n"], [266, "  }\n"], [267, "\n"], [268, "  # Rule 4: IP Reputation\n"], [269, "  rule {\n"], [270, "    name     = \"AWSManagedRulesAmazonIpReputationList\"\n"], [271, "    priority = 4\n"], [272, "\n"], [273, "    override_action {\n"], [274, "      none {}\n"], [275, "    }\n"], [276, "\n"], [277, "    statement {\n"], [278, "      managed_rule_group_statement {\n"], [279, "        name        = \"AWSManagedRulesAmazonIpReputationList\"\n"], [280, "        vendor_name = \"AWS\"\n"], [281, "      }\n"], [282, "    }\n"], [283, "\n"], [284, "    visibility_config {\n"], [285, "      cloudwatch_metrics_enabled = true\n"], [286, "      metric_name                = \"AWSManagedRulesAmazonIpReputationList\"\n"], [287, "      sampled_requests_enabled   = true\n"], [288, "    }\n"], [289, "  }\n"], [290, "\n"], [291, "  visibility_config {\n"], [292, "    cloudwatch_metrics_enabled = true\n"], [293, "    metric_name                = \"openclaw-waf\"\n"], [294, "    sampled_requests_enabled   = true\n"], [295, "  }\n"], [296, "\n"], [297, "  tags = {\n"], [298, "    Name = \"openclaw-waf\"\n"], [299, "  }\n"], [300, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [189, 300], "resource": "aws_wafv2_web_acl.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.WAFHasAnyRules", "fixed_definition": null, "entity_tags": {"Name": "openclaw-waf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-64", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "breadcrumbs": {"rule.0.statement.rate_based_statement.limit": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "rule.0.statement.rate_based_statement": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "rule.0.statement": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "rule.0": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "PASSED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[113, "resource \"aws_cloudwatch_log_group\" \"dns_logs\" {\n"], [114, "  name              = \"/openclaw/dns-queries\"\n"], [115, "  retention_in_days = 365\n"], [116, "  kms_key_id        = aws_kms_key.openclaw.arn\n"], [117, "\n"], [118, "  tags = {\n"], [119, "    Name = \"openclaw-dns-logs\"\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "/dns_firewall.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/dns_firewall.tf", "repo_file_path": "/dns_firewall.tf", "file_line_range": [113, 121], "resource": "aws_cloudwatch_log_group.dns_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Name": "openclaw-dns-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/dns_firewall.tf"}, {"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[113, "resource \"aws_cloudwatch_log_group\" \"dns_logs\" {\n"], [114, "  name              = \"/openclaw/dns-queries\"\n"], [115, "  retention_in_days = 365\n"], [116, "  kms_key_id        = aws_kms_key.openclaw.arn\n"], [117, "\n"], [118, "  tags = {\n"], [119, "    Name = \"openclaw-dns-logs\"\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "/dns_firewall.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/dns_firewall.tf", "repo_file_path": "/dns_firewall.tf", "file_line_range": [113, 121], "resource": "aws_cloudwatch_log_group.dns_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": {"Name": "openclaw-dns-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/dns_firewall.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[113, "resource \"aws_cloudwatch_log_group\" \"dns_logs\" {\n"], [114, "  name              = \"/openclaw/dns-queries\"\n"], [115, "  retention_in_days = 365\n"], [116, "  kms_key_id        = aws_kms_key.openclaw.arn\n"], [117, "\n"], [118, "  tags = {\n"], [119, "    Name = \"openclaw-dns-logs\"\n"], [120, "  }\n"], [121, "}\n"]], "file_path": "/dns_firewall.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/dns_firewall.tf", "repo_file_path": "/dns_firewall.tf", "file_line_range": [113, 121], "resource": "aws_cloudwatch_log_group.dns_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": {"Name": "openclaw-dns-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/dns_firewall.tf"}, {"check_id": "CKV_AWS_386", "bc_check_id": "BC_AWS_GENERAL_271", "check_name": "Reduce potential for WhoAMI cloud image name confusion attack", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[74, "data \"aws_ami\" \"ubuntu\" {\n"], [75, "  most_recent = true\n"], [76, "  owners      = [\"099720109477\"] # Canonical\n"], [77, "\n"], [78, "  filter {\n"], [79, "    name   = \"name\"\n"], [80, "    values = [\"ubuntu/images/hvm-ssd/ubuntu-jammy-22.04-amd64-server-*\"]\n"], [81, "  }\n"], [82, "\n"], [83, "  filter {\n"], [84, "    name   = \"virtualization-type\"\n"], [85, "    values = [\"hvm\"]\n"], [86, "  }\n"], [87, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [74, 87], "resource": "aws_ami.ubuntu", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.WhoAMI", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-supply-chain-policies/bc-aws-386", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf"}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[24, "resource \"aws_security_group\" \"openclaw\" {\n"], [25, "  name        = \"openclaw-ec2-sg\"\n"], [26, "  description = \"Security group for OpenClaw EC2\"\n"], [27, "  vpc_id      = aws_vpc.main.id\n"], [28, "\n"], [29, "  # Allow inbound from CloudFront (via VPC origin)\n"], [30, "  ingress {\n"], [31, "    from_port   = 18789\n"], [32, "    to_port     = 18789\n"], [33, "    protocol    = \"tcp\"\n"], [34, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [35, "    description = \"OpenClaw gateway from VPC\"\n"], [36, "  }\n"], [37, "\n"], [38, "  # HTTPS outbound for API calls\n"], [39, "  egress {\n"], [40, "    from_port   = 443\n"], [41, "    to_port     = 443\n"], [42, "    protocol    = \"tcp\"\n"], [43, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [44, "    description = \"HTTPS for API calls and package downloads\"\n"], [45, "  }\n"], [46, "\n"], [47, "  # HTTP outbound for package repos (some still use HTTP)\n"], [48, "  egress {\n"], [49, "    from_port   = 80\n"], [50, "    to_port     = 80\n"], [51, "    protocol    = \"tcp\"\n"], [52, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [53, "    description = \"HTTP for package downloads\"\n"], [54, "  }\n"], [55, "\n"], [56, "  # DNS for Route53 DNS Firewall\n"], [57, "  egress {\n"], [58, "    from_port   = 53\n"], [59, "    to_port     = 53\n"], [60, "    protocol    = \"udp\"\n"], [61, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [62, "    description = \"DNS queries\"\n"], [63, "  }\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name = \"openclaw-ec2-sg\"\n"], [67, "  }\n"], [68, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [24, 68], "resource": "aws_security_group.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ec2-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[24, "resource \"aws_security_group\" \"openclaw\" {\n"], [25, "  name        = \"openclaw-ec2-sg\"\n"], [26, "  description = \"Security group for OpenClaw EC2\"\n"], [27, "  vpc_id      = aws_vpc.main.id\n"], [28, "\n"], [29, "  # Allow inbound from CloudFront (via VPC origin)\n"], [30, "  ingress {\n"], [31, "    from_port   = 18789\n"], [32, "    to_port     = 18789\n"], [33, "    protocol    = \"tcp\"\n"], [34, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [35, "    description = \"OpenClaw gateway from VPC\"\n"], [36, "  }\n"], [37, "\n"], [38, "  # HTTPS outbound for API calls\n"], [39, "  egress {\n"], [40, "    from_port   = 443\n"], [41, "    to_port     = 443\n"], [42, "    protocol    = \"tcp\"\n"], [43, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [44, "    description = \"HTTPS for API calls and package downloads\"\n"], [45, "  }\n"], [46, "\n"], [47, "  # HTTP outbound for package repos (some still use HTTP)\n"], [48, "  egress {\n"], [49, "    from_port   = 80\n"], [50, "    to_port     = 80\n"], [51, "    protocol    = \"tcp\"\n"], [52, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [53, "    description = \"HTTP for package downloads\"\n"], [54, "  }\n"], [55, "\n"], [56, "  # DNS for Route53 DNS Firewall\n"], [57, "  egress {\n"], [58, "    from_port   = 53\n"], [59, "    to_port     = 53\n"], [60, "    protocol    = \"udp\"\n"], [61, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [62, "    description = \"DNS queries\"\n"], [63, "  }\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name = \"openclaw-ec2-sg\"\n"], [67, "  }\n"], [68, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [24, 68], "resource": "aws_security_group.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ec2-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[24, "resource \"aws_security_group\" \"openclaw\" {\n"], [25, "  name        = \"openclaw-ec2-sg\"\n"], [26, "  description = \"Security group for OpenClaw EC2\"\n"], [27, "  vpc_id      = aws_vpc.main.id\n"], [28, "\n"], [29, "  # Allow inbound from CloudFront (via VPC origin)\n"], [30, "  ingress {\n"], [31, "    from_port   = 18789\n"], [32, "    to_port     = 18789\n"], [33, "    protocol    = \"tcp\"\n"], [34, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [35, "    description = \"OpenClaw gateway from VPC\"\n"], [36, "  }\n"], [37, "\n"], [38, "  # HTTPS outbound for API calls\n"], [39, "  egress {\n"], [40, "    from_port   = 443\n"], [41, "    to_port     = 443\n"], [42, "    protocol    = \"tcp\"\n"], [43, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [44, "    description = \"HTTPS for API calls and package downloads\"\n"], [45, "  }\n"], [46, "\n"], [47, "  # HTTP outbound for package repos (some still use HTTP)\n"], [48, "  egress {\n"], [49, "    from_port   = 80\n"], [50, "    to_port     = 80\n"], [51, "    protocol    = \"tcp\"\n"], [52, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [53, "    description = \"HTTP for package downloads\"\n"], [54, "  }\n"], [55, "\n"], [56, "  # DNS for Route53 DNS Firewall\n"], [57, "  egress {\n"], [58, "    from_port   = 53\n"], [59, "    to_port     = 53\n"], [60, "    protocol    = \"udp\"\n"], [61, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [62, "    description = \"DNS queries\"\n"], [63, "  }\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name = \"openclaw-ec2-sg\"\n"], [67, "  }\n"], [68, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [24, 68], "resource": "aws_security_group.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ec2-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["description"]}, "code_block": [[24, "resource \"aws_security_group\" \"openclaw\" {\n"], [25, "  name        = \"openclaw-ec2-sg\"\n"], [26, "  description = \"Security group for OpenClaw EC2\"\n"], [27, "  vpc_id      = aws_vpc.main.id\n"], [28, "\n"], [29, "  # Allow inbound from CloudFront (via VPC origin)\n"], [30, "  ingress {\n"], [31, "    from_port   = 18789\n"], [32, "    to_port     = 18789\n"], [33, "    protocol    = \"tcp\"\n"], [34, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [35, "    description = \"OpenClaw gateway from VPC\"\n"], [36, "  }\n"], [37, "\n"], [38, "  # HTTPS outbound for API calls\n"], [39, "  egress {\n"], [40, "    from_port   = 443\n"], [41, "    to_port     = 443\n"], [42, "    protocol    = \"tcp\"\n"], [43, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [44, "    description = \"HTTPS for API calls and package downloads\"\n"], [45, "  }\n"], [46, "\n"], [47, "  # HTTP outbound for package repos (some still use HTTP)\n"], [48, "  egress {\n"], [49, "    from_port   = 80\n"], [50, "    to_port     = 80\n"], [51, "    protocol    = \"tcp\"\n"], [52, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [53, "    description = \"HTTP for package downloads\"\n"], [54, "  }\n"], [55, "\n"], [56, "  # DNS for Route53 DNS Firewall\n"], [57, "  egress {\n"], [58, "    from_port   = 53\n"], [59, "    to_port     = 53\n"], [60, "    protocol    = \"udp\"\n"], [61, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [62, "    description = \"DNS queries\"\n"], [63, "  }\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name = \"openclaw-ec2-sg\"\n"], [67, "  }\n"], [68, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [24, 68], "resource": "aws_security_group.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ec2-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[24, "resource \"aws_security_group\" \"openclaw\" {\n"], [25, "  name        = \"openclaw-ec2-sg\"\n"], [26, "  description = \"Security group for OpenClaw EC2\"\n"], [27, "  vpc_id      = aws_vpc.main.id\n"], [28, "\n"], [29, "  # Allow inbound from CloudFront (via VPC origin)\n"], [30, "  ingress {\n"], [31, "    from_port   = 18789\n"], [32, "    to_port     = 18789\n"], [33, "    protocol    = \"tcp\"\n"], [34, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [35, "    description = \"OpenClaw gateway from VPC\"\n"], [36, "  }\n"], [37, "\n"], [38, "  # HTTPS outbound for API calls\n"], [39, "  egress {\n"], [40, "    from_port   = 443\n"], [41, "    to_port     = 443\n"], [42, "    protocol    = \"tcp\"\n"], [43, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [44, "    description = \"HTTPS for API calls and package downloads\"\n"], [45, "  }\n"], [46, "\n"], [47, "  # HTTP outbound for package repos (some still use HTTP)\n"], [48, "  egress {\n"], [49, "    from_port   = 80\n"], [50, "    to_port     = 80\n"], [51, "    protocol    = \"tcp\"\n"], [52, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [53, "    description = \"HTTP for package downloads\"\n"], [54, "  }\n"], [55, "\n"], [56, "  # DNS for Route53 DNS Firewall\n"], [57, "  egress {\n"], [58, "    from_port   = 53\n"], [59, "    to_port     = 53\n"], [60, "    protocol    = \"udp\"\n"], [61, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [62, "    description = \"DNS queries\"\n"], [63, "  }\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name = \"openclaw-ec2-sg\"\n"], [67, "  }\n"], [68, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [24, 68], "resource": "aws_security_group.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ec2-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[24, "resource \"aws_security_group\" \"openclaw\" {\n"], [25, "  name        = \"openclaw-ec2-sg\"\n"], [26, "  description = \"Security group for OpenClaw EC2\"\n"], [27, "  vpc_id      = aws_vpc.main.id\n"], [28, "\n"], [29, "  # Allow inbound from CloudFront (via VPC origin)\n"], [30, "  ingress {\n"], [31, "    from_port   = 18789\n"], [32, "    to_port     = 18789\n"], [33, "    protocol    = \"tcp\"\n"], [34, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [35, "    description = \"OpenClaw gateway from VPC\"\n"], [36, "  }\n"], [37, "\n"], [38, "  # HTTPS outbound for API calls\n"], [39, "  egress {\n"], [40, "    from_port   = 443\n"], [41, "    to_port     = 443\n"], [42, "    protocol    = \"tcp\"\n"], [43, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [44, "    description = \"HTTPS for API calls and package downloads\"\n"], [45, "  }\n"], [46, "\n"], [47, "  # HTTP outbound for package repos (some still use HTTP)\n"], [48, "  egress {\n"], [49, "    from_port   = 80\n"], [50, "    to_port     = 80\n"], [51, "    protocol    = \"tcp\"\n"], [52, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [53, "    description = \"HTTP for package downloads\"\n"], [54, "  }\n"], [55, "\n"], [56, "  # DNS for Route53 DNS Firewall\n"], [57, "  egress {\n"], [58, "    from_port   = 53\n"], [59, "    to_port     = 53\n"], [60, "    protocol    = \"udp\"\n"], [61, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [62, "    description = \"DNS queries\"\n"], [63, "  }\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name = \"openclaw-ec2-sg\"\n"], [67, "  }\n"], [68, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [24, 68], "resource": "aws_security_group.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ec2-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "PASSED", "evaluated_keys": ["associate_public_ip_address"]}, "code_block": [[93, "resource \"aws_instance\" \"openclaw\" {\n"], [94, "  ami                    = data.aws_ami.ubuntu.id\n"], [95, "  instance_type          = var.instance_type\n"], [96, "  subnet_id              = aws_subnet.private_a.id\n"], [97, "  vpc_security_group_ids = [aws_security_group.openclaw.id]\n"], [98, "  iam_instance_profile   = aws_iam_instance_profile.openclaw.name\n"], [99, "  ebs_optimized          = true\n"], [100, "\n"], [101, "  # No public IP - private subnet only\n"], [102, "  associate_public_ip_address = false\n"], [103, "\n"], [104, "  # Encrypted root volume\n"], [105, "  root_block_device {\n"], [106, "    volume_size           = 30 # GB - enough for Docker images\n"], [107, "    volume_type           = \"gp3\"\n"], [108, "    encrypted             = true\n"], [109, "    delete_on_termination = true\n"], [110, "\n"], [111, "    tags = {\n"], [112, "      Name = \"openclaw-root-volume\"\n"], [113, "    }\n"], [114, "  }\n"], [115, "\n"], [116, "  # IMDSv2 required - blocks SSRF credential theft\n"], [117, "  metadata_options {\n"], [118, "    http_endpoint               = \"enabled\"\n"], [119, "    http_tokens                 = \"required\"\n"], [120, "    http_put_response_hop_limit = 1\n"], [121, "  }\n"], [122, "\n"], [123, "  # User data runs Ansible on first boot\n"], [124, "  user_data = base64encode(<<-EOF\n"], [125, "    #!/bin/bash\n"], [126, "    set -e\n"], [127, "\n"], [128, "    # Log everything\n"], [129, "    exec > >(tee /var/log/user-data.log) 2>&1\n"], [130, "    echo \"Starting OpenClaw setup at $(date)\"\n"], [131, "\n"], [132, "    # Install Ansible\n"], [133, "    apt-get update\n"], [134, "    apt-get install -y ansible git\n"], [135, "\n"], [136, "    # Clone OpenClaw Ansible repo\n"], [137, "    git clone https://github.com/openclaw/openclaw-ansible.git /opt/openclaw-ansible\n"], [138, "    cd /opt/openclaw-ansible\n"], [139, "\n"], [140, "    # Install Ansible collections\n"], [141, "    ansible-galaxy collection install -r requirements.yml\n"], [142, "\n"], [143, "    # Run playbook (non-interactive)\n"], [144, "    ansible-playbook playbook.yml --connection=local\n"], [145, "\n"], [146, "    echo \"OpenClaw setup completed at $(date)\"\n"], [147, "  EOF\n"], [148, "  )\n"], [149, "\n"], [150, "  # Enable detailed monitoring\n"], [151, "  monitoring = true\n"], [152, "\n"], [153, "  tags = {\n"], [154, "    Name = \"openclaw-instance\"\n"], [155, "  }\n"], [156, "\n"], [157, "  # Wait for IAM role\n"], [158, "  depends_on = [\n"], [159, "    aws_iam_role_policy_attachment.openclaw_ssm,\n"], [160, "    aws_iam_role_policy_attachment.openclaw_secrets\n"], [161, "  ]\n"], [162, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [93, 162], "resource": "aws_instance.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": {"Name": "openclaw-instance"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"instance_type": [{"type": "variable", "name": "instance_type", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "iam_instance_profile": [{"type": "resource", "name": "aws_iam_instance_profile.openclaw", "path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "PASSED", "evaluated_keys": ["user_data"]}, "code_block": [[93, "resource \"aws_instance\" \"openclaw\" {\n"], [94, "  ami                    = data.aws_ami.ubuntu.id\n"], [95, "  instance_type          = var.instance_type\n"], [96, "  subnet_id              = aws_subnet.private_a.id\n"], [97, "  vpc_security_group_ids = [aws_security_group.openclaw.id]\n"], [98, "  iam_instance_profile   = aws_iam_instance_profile.openclaw.name\n"], [99, "  ebs_optimized          = true\n"], [100, "\n"], [101, "  # No public IP - private subnet only\n"], [102, "  associate_public_ip_address = false\n"], [103, "\n"], [104, "  # Encrypted root volume\n"], [105, "  root_block_device {\n"], [106, "    volume_size           = 30 # GB - enough for Docker images\n"], [107, "    volume_type           = \"gp3\"\n"], [108, "    encrypted             = true\n"], [109, "    delete_on_termination = true\n"], [110, "\n"], [111, "    tags = {\n"], [112, "      Name = \"openclaw-root-volume\"\n"], [113, "    }\n"], [114, "  }\n"], [115, "\n"], [116, "  # IMDSv2 required - blocks SSRF credential theft\n"], [117, "  metadata_options {\n"], [118, "    http_endpoint               = \"enabled\"\n"], [119, "    http_tokens                 = \"required\"\n"], [120, "    http_put_response_hop_limit = 1\n"], [121, "  }\n"], [122, "\n"], [123, "  # User data runs Ansible on first boot\n"], [124, "  user_data = base64encode(<<-EOF\n"], [125, "    #!/bin/bash\n"], [126, "    set -e\n"], [127, "\n"], [128, "    # Log everything\n"], [129, "    exec > >(tee /var/log/user-data.log) 2>&1\n"], [130, "    echo \"Starting OpenClaw setup at $(date)\"\n"], [131, "\n"], [132, "    # Install Ansible\n"], [133, "    apt-get update\n"], [134, "    apt-get install -y ansible git\n"], [135, "\n"], [136, "    # Clone OpenClaw Ansible repo\n"], [137, "    git clone https://github.com/openclaw/openclaw-ansible.git /opt/openclaw-ansible\n"], [138, "    cd /opt/openclaw-ansible\n"], [139, "\n"], [140, "    # Install Ansible collections\n"], [141, "    ansible-galaxy collection install -r requirements.yml\n"], [142, "\n"], [143, "    # Run playbook (non-interactive)\n"], [144, "    ansible-playbook playbook.yml --connection=local\n"], [145, "\n"], [146, "    echo \"OpenClaw setup completed at $(date)\"\n"], [147, "  EOF\n"], [148, "  )\n"], [149, "\n"], [150, "  # Enable detailed monitoring\n"], [151, "  monitoring = true\n"], [152, "\n"], [153, "  tags = {\n"], [154, "    Name = \"openclaw-instance\"\n"], [155, "  }\n"], [156, "\n"], [157, "  # Wait for IAM role\n"], [158, "  depends_on = [\n"], [159, "    aws_iam_role_policy_attachment.openclaw_ssm,\n"], [160, "    aws_iam_role_policy_attachment.openclaw_secrets\n"], [161, "  ]\n"], [162, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [93, 162], "resource": "aws_instance.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": {"Name": "openclaw-instance"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"instance_type": [{"type": "variable", "name": "instance_type", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "iam_instance_profile": [{"type": "resource", "name": "aws_iam_instance_profile.openclaw", "path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["metadata_options/[0]/http_tokens"]}, "code_block": [[93, "resource \"aws_instance\" \"openclaw\" {\n"], [94, "  ami                    = data.aws_ami.ubuntu.id\n"], [95, "  instance_type          = var.instance_type\n"], [96, "  subnet_id              = aws_subnet.private_a.id\n"], [97, "  vpc_security_group_ids = [aws_security_group.openclaw.id]\n"], [98, "  iam_instance_profile   = aws_iam_instance_profile.openclaw.name\n"], [99, "  ebs_optimized          = true\n"], [100, "\n"], [101, "  # No public IP - private subnet only\n"], [102, "  associate_public_ip_address = false\n"], [103, "\n"], [104, "  # Encrypted root volume\n"], [105, "  root_block_device {\n"], [106, "    volume_size           = 30 # GB - enough for Docker images\n"], [107, "    volume_type           = \"gp3\"\n"], [108, "    encrypted             = true\n"], [109, "    delete_on_termination = true\n"], [110, "\n"], [111, "    tags = {\n"], [112, "      Name = \"openclaw-root-volume\"\n"], [113, "    }\n"], [114, "  }\n"], [115, "\n"], [116, "  # IMDSv2 required - blocks SSRF credential theft\n"], [117, "  metadata_options {\n"], [118, "    http_endpoint               = \"enabled\"\n"], [119, "    http_tokens                 = \"required\"\n"], [120, "    http_put_response_hop_limit = 1\n"], [121, "  }\n"], [122, "\n"], [123, "  # User data runs Ansible on first boot\n"], [124, "  user_data = base64encode(<<-EOF\n"], [125, "    #!/bin/bash\n"], [126, "    set -e\n"], [127, "\n"], [128, "    # Log everything\n"], [129, "    exec > >(tee /var/log/user-data.log) 2>&1\n"], [130, "    echo \"Starting OpenClaw setup at $(date)\"\n"], [131, "\n"], [132, "    # Install Ansible\n"], [133, "    apt-get update\n"], [134, "    apt-get install -y ansible git\n"], [135, "\n"], [136, "    # Clone OpenClaw Ansible repo\n"], [137, "    git clone https://github.com/openclaw/openclaw-ansible.git /opt/openclaw-ansible\n"], [138, "    cd /opt/openclaw-ansible\n"], [139, "\n"], [140, "    # Install Ansible collections\n"], [141, "    ansible-galaxy collection install -r requirements.yml\n"], [142, "\n"], [143, "    # Run playbook (non-interactive)\n"], [144, "    ansible-playbook playbook.yml --connection=local\n"], [145, "\n"], [146, "    echo \"OpenClaw setup completed at $(date)\"\n"], [147, "  EOF\n"], [148, "  )\n"], [149, "\n"], [150, "  # Enable detailed monitoring\n"], [151, "  monitoring = true\n"], [152, "\n"], [153, "  tags = {\n"], [154, "    Name = \"openclaw-instance\"\n"], [155, "  }\n"], [156, "\n"], [157, "  # Wait for IAM role\n"], [158, "  depends_on = [\n"], [159, "    aws_iam_role_policy_attachment.openclaw_ssm,\n"], [160, "    aws_iam_role_policy_attachment.openclaw_secrets\n"], [161, "  ]\n"], [162, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [93, 162], "resource": "aws_instance.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": {"Name": "openclaw-instance"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"instance_type": [{"type": "variable", "name": "instance_type", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "iam_instance_profile": [{"type": "resource", "name": "aws_iam_instance_profile.openclaw", "path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_135", "bc_check_id": "BC_AWS_GENERAL_68", "check_name": "Ensure that EC2 is EBS optimized", "check_result": {"result": "PASSED", "evaluated_keys": ["ebs_optimized"]}, "code_block": [[93, "resource \"aws_instance\" \"openclaw\" {\n"], [94, "  ami                    = data.aws_ami.ubuntu.id\n"], [95, "  instance_type          = var.instance_type\n"], [96, "  subnet_id              = aws_subnet.private_a.id\n"], [97, "  vpc_security_group_ids = [aws_security_group.openclaw.id]\n"], [98, "  iam_instance_profile   = aws_iam_instance_profile.openclaw.name\n"], [99, "  ebs_optimized          = true\n"], [100, "\n"], [101, "  # No public IP - private subnet only\n"], [102, "  associate_public_ip_address = false\n"], [103, "\n"], [104, "  # Encrypted root volume\n"], [105, "  root_block_device {\n"], [106, "    volume_size           = 30 # GB - enough for Docker images\n"], [107, "    volume_type           = \"gp3\"\n"], [108, "    encrypted             = true\n"], [109, "    delete_on_termination = true\n"], [110, "\n"], [111, "    tags = {\n"], [112, "      Name = \"openclaw-root-volume\"\n"], [113, "    }\n"], [114, "  }\n"], [115, "\n"], [116, "  # IMDSv2 required - blocks SSRF credential theft\n"], [117, "  metadata_options {\n"], [118, "    http_endpoint               = \"enabled\"\n"], [119, "    http_tokens                 = \"required\"\n"], [120, "    http_put_response_hop_limit = 1\n"], [121, "  }\n"], [122, "\n"], [123, "  # User data runs Ansible on first boot\n"], [124, "  user_data = base64encode(<<-EOF\n"], [125, "    #!/bin/bash\n"], [126, "    set -e\n"], [127, "\n"], [128, "    # Log everything\n"], [129, "    exec > >(tee /var/log/user-data.log) 2>&1\n"], [130, "    echo \"Starting OpenClaw setup at $(date)\"\n"], [131, "\n"], [132, "    # Install Ansible\n"], [133, "    apt-get update\n"], [134, "    apt-get install -y ansible git\n"], [135, "\n"], [136, "    # Clone OpenClaw Ansible repo\n"], [137, "    git clone https://github.com/openclaw/openclaw-ansible.git /opt/openclaw-ansible\n"], [138, "    cd /opt/openclaw-ansible\n"], [139, "\n"], [140, "    # Install Ansible collections\n"], [141, "    ansible-galaxy collection install -r requirements.yml\n"], [142, "\n"], [143, "    # Run playbook (non-interactive)\n"], [144, "    ansible-playbook playbook.yml --connection=local\n"], [145, "\n"], [146, "    echo \"OpenClaw setup completed at $(date)\"\n"], [147, "  EOF\n"], [148, "  )\n"], [149, "\n"], [150, "  # Enable detailed monitoring\n"], [151, "  monitoring = true\n"], [152, "\n"], [153, "  tags = {\n"], [154, "    Name = \"openclaw-instance\"\n"], [155, "  }\n"], [156, "\n"], [157, "  # Wait for IAM role\n"], [158, "  depends_on = [\n"], [159, "    aws_iam_role_policy_attachment.openclaw_ssm,\n"], [160, "    aws_iam_role_policy_attachment.openclaw_secrets\n"], [161, "  ]\n"], [162, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [93, 162], "resource": "aws_instance.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2EBSOptimized", "fixed_definition": null, "entity_tags": {"Name": "openclaw-instance"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"instance_type": [{"type": "variable", "name": "instance_type", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "iam_instance_profile": [{"type": "resource", "name": "aws_iam_instance_profile.openclaw", "path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_126", "bc_check_id": "BC_AWS_LOGGING_26", "check_name": "Ensure that detailed monitoring is enabled for EC2 instances", "check_result": {"result": "PASSED", "evaluated_keys": ["monitoring"]}, "code_block": [[93, "resource \"aws_instance\" \"openclaw\" {\n"], [94, "  ami                    = data.aws_ami.ubuntu.id\n"], [95, "  instance_type          = var.instance_type\n"], [96, "  subnet_id              = aws_subnet.private_a.id\n"], [97, "  vpc_security_group_ids = [aws_security_group.openclaw.id]\n"], [98, "  iam_instance_profile   = aws_iam_instance_profile.openclaw.name\n"], [99, "  ebs_optimized          = true\n"], [100, "\n"], [101, "  # No public IP - private subnet only\n"], [102, "  associate_public_ip_address = false\n"], [103, "\n"], [104, "  # Encrypted root volume\n"], [105, "  root_block_device {\n"], [106, "    volume_size           = 30 # GB - enough for Docker images\n"], [107, "    volume_type           = \"gp3\"\n"], [108, "    encrypted             = true\n"], [109, "    delete_on_termination = true\n"], [110, "\n"], [111, "    tags = {\n"], [112, "      Name = \"openclaw-root-volume\"\n"], [113, "    }\n"], [114, "  }\n"], [115, "\n"], [116, "  # IMDSv2 required - blocks SSRF credential theft\n"], [117, "  metadata_options {\n"], [118, "    http_endpoint               = \"enabled\"\n"], [119, "    http_tokens                 = \"required\"\n"], [120, "    http_put_response_hop_limit = 1\n"], [121, "  }\n"], [122, "\n"], [123, "  # User data runs Ansible on first boot\n"], [124, "  user_data = base64encode(<<-EOF\n"], [125, "    #!/bin/bash\n"], [126, "    set -e\n"], [127, "\n"], [128, "    # Log everything\n"], [129, "    exec > >(tee /var/log/user-data.log) 2>&1\n"], [130, "    echo \"Starting OpenClaw setup at $(date)\"\n"], [131, "\n"], [132, "    # Install Ansible\n"], [133, "    apt-get update\n"], [134, "    apt-get install -y ansible git\n"], [135, "\n"], [136, "    # Clone OpenClaw Ansible repo\n"], [137, "    git clone https://github.com/openclaw/openclaw-ansible.git /opt/openclaw-ansible\n"], [138, "    cd /opt/openclaw-ansible\n"], [139, "\n"], [140, "    # Install Ansible collections\n"], [141, "    ansible-galaxy collection install -r requirements.yml\n"], [142, "\n"], [143, "    # Run playbook (non-interactive)\n"], [144, "    ansible-playbook playbook.yml --connection=local\n"], [145, "\n"], [146, "    echo \"OpenClaw setup completed at $(date)\"\n"], [147, "  EOF\n"], [148, "  )\n"], [149, "\n"], [150, "  # Enable detailed monitoring\n"], [151, "  monitoring = true\n"], [152, "\n"], [153, "  tags = {\n"], [154, "    Name = \"openclaw-instance\"\n"], [155, "  }\n"], [156, "\n"], [157, "  # Wait for IAM role\n"], [158, "  depends_on = [\n"], [159, "    aws_iam_role_policy_attachment.openclaw_ssm,\n"], [160, "    aws_iam_role_policy_attachment.openclaw_secrets\n"], [161, "  ]\n"], [162, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [93, 162], "resource": "aws_instance.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2DetailedMonitoringEnabled", "fixed_definition": null, "entity_tags": {"Name": "openclaw-instance"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"instance_type": [{"type": "variable", "name": "instance_type", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "iam_instance_profile": [{"type": "resource", "name": "aws_iam_instance_profile.openclaw", "path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_8", "bc_check_id": "BC_AWS_GENERAL_13", "check_name": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "check_result": {"result": "PASSED", "evaluated_keys": ["root_block_device", "ebs_block_device"]}, "code_block": [[93, "resource \"aws_instance\" \"openclaw\" {\n"], [94, "  ami                    = data.aws_ami.ubuntu.id\n"], [95, "  instance_type          = var.instance_type\n"], [96, "  subnet_id              = aws_subnet.private_a.id\n"], [97, "  vpc_security_group_ids = [aws_security_group.openclaw.id]\n"], [98, "  iam_instance_profile   = aws_iam_instance_profile.openclaw.name\n"], [99, "  ebs_optimized          = true\n"], [100, "\n"], [101, "  # No public IP - private subnet only\n"], [102, "  associate_public_ip_address = false\n"], [103, "\n"], [104, "  # Encrypted root volume\n"], [105, "  root_block_device {\n"], [106, "    volume_size           = 30 # GB - enough for Docker images\n"], [107, "    volume_type           = \"gp3\"\n"], [108, "    encrypted             = true\n"], [109, "    delete_on_termination = true\n"], [110, "\n"], [111, "    tags = {\n"], [112, "      Name = \"openclaw-root-volume\"\n"], [113, "    }\n"], [114, "  }\n"], [115, "\n"], [116, "  # IMDSv2 required - blocks SSRF credential theft\n"], [117, "  metadata_options {\n"], [118, "    http_endpoint               = \"enabled\"\n"], [119, "    http_tokens                 = \"required\"\n"], [120, "    http_put_response_hop_limit = 1\n"], [121, "  }\n"], [122, "\n"], [123, "  # User data runs Ansible on first boot\n"], [124, "  user_data = base64encode(<<-EOF\n"], [125, "    #!/bin/bash\n"], [126, "    set -e\n"], [127, "\n"], [128, "    # Log everything\n"], [129, "    exec > >(tee /var/log/user-data.log) 2>&1\n"], [130, "    echo \"Starting OpenClaw setup at $(date)\"\n"], [131, "\n"], [132, "    # Install Ansible\n"], [133, "    apt-get update\n"], [134, "    apt-get install -y ansible git\n"], [135, "\n"], [136, "    # Clone OpenClaw Ansible repo\n"], [137, "    git clone https://github.com/openclaw/openclaw-ansible.git /opt/openclaw-ansible\n"], [138, "    cd /opt/openclaw-ansible\n"], [139, "\n"], [140, "    # Install Ansible collections\n"], [141, "    ansible-galaxy collection install -r requirements.yml\n"], [142, "\n"], [143, "    # Run playbook (non-interactive)\n"], [144, "    ansible-playbook playbook.yml --connection=local\n"], [145, "\n"], [146, "    echo \"OpenClaw setup completed at $(date)\"\n"], [147, "  EOF\n"], [148, "  )\n"], [149, "\n"], [150, "  # Enable detailed monitoring\n"], [151, "  monitoring = true\n"], [152, "\n"], [153, "  tags = {\n"], [154, "    Name = \"openclaw-instance\"\n"], [155, "  }\n"], [156, "\n"], [157, "  # Wait for IAM role\n"], [158, "  depends_on = [\n"], [159, "    aws_iam_role_policy_attachment.openclaw_ssm,\n"], [160, "    aws_iam_role_policy_attachment.openclaw_secrets\n"], [161, "  ]\n"], [162, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [93, 162], "resource": "aws_instance.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchConfigurationEBSEncryption", "fixed_definition": null, "entity_tags": {"Name": "openclaw-instance"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"instance_type": [{"type": "variable", "name": "instance_type", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "iam_instance_profile": [{"type": "resource", "name": "aws_iam_instance_profile.openclaw", "path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[25, "resource \"aws_iam_role\" \"openclaw\" {\n"], [26, "  name = \"openclaw-ec2-role\"\n"], [27, "\n"], [28, "  assume_role_policy = jsonencode({\n"], [29, "    Version = \"2012-10-17\"\n"], [30, "    Statement = [\n"], [31, "      {\n"], [32, "        Action = \"sts:AssumeRole\"\n"], [33, "        Effect = \"Allow\"\n"], [34, "        Principal = {\n"], [35, "          Service = \"ec2.amazonaws.com\"\n"], [36, "        }\n"], [37, "      }\n"], [38, "    ]\n"], [39, "  })\n"], [40, "\n"], [41, "  tags = {\n"], [42, "    Name = \"openclaw-ec2-role\"\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [25, 44], "resource": "aws_iam_role.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ec2-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[25, "resource \"aws_iam_role\" \"openclaw\" {\n"], [26, "  name = \"openclaw-ec2-role\"\n"], [27, "\n"], [28, "  assume_role_policy = jsonencode({\n"], [29, "    Version = \"2012-10-17\"\n"], [30, "    Statement = [\n"], [31, "      {\n"], [32, "        Action = \"sts:AssumeRole\"\n"], [33, "        Effect = \"Allow\"\n"], [34, "        Principal = {\n"], [35, "          Service = \"ec2.amazonaws.com\"\n"], [36, "        }\n"], [37, "      }\n"], [38, "    ]\n"], [39, "  })\n"], [40, "\n"], [41, "  tags = {\n"], [42, "    Name = \"openclaw-ec2-role\"\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [25, 44], "resource": "aws_iam_role.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ec2-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[25, "resource \"aws_iam_role\" \"openclaw\" {\n"], [26, "  name = \"openclaw-ec2-role\"\n"], [27, "\n"], [28, "  assume_role_policy = jsonencode({\n"], [29, "    Version = \"2012-10-17\"\n"], [30, "    Statement = [\n"], [31, "      {\n"], [32, "        Action = \"sts:AssumeRole\"\n"], [33, "        Effect = \"Allow\"\n"], [34, "        Principal = {\n"], [35, "          Service = \"ec2.amazonaws.com\"\n"], [36, "        }\n"], [37, "      }\n"], [38, "    ]\n"], [39, "  })\n"], [40, "\n"], [41, "  tags = {\n"], [42, "    Name = \"openclaw-ec2-role\"\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [25, 44], "resource": "aws_iam_role.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ec2-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[52, "resource \"aws_iam_role_policy_attachment\" \"openclaw_ssm\" {\n"], [53, "  role       = aws_iam_role.openclaw.name\n"], [54, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore\"\n"], [55, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [52, 55], "resource": "aws_iam_role_policy_attachment.openclaw_ssm", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.openclaw", "path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_286", "bc_check_id": "BC_AWS_IAM_81", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[58, "resource \"aws_iam_policy\" \"openclaw_secrets\" {\n"], [59, "  name        = \"openclaw-secrets-policy\"\n"], [60, "  description = \"Allow OpenClaw to read its API keys\"\n"], [61, "\n"], [62, "  policy = jsonencode({\n"], [63, "    Version = \"2012-10-17\"\n"], [64, "    Statement = [\n"], [65, "      {\n"], [66, "        Sid    = \"GetSecretValue\"\n"], [67, "        Effect = \"Allow\"\n"], [68, "        Action = [\n"], [69, "          \"secretsmanager:GetSecretValue\"\n"], [70, "        ]\n"], [71, "        Resource = aws_secretsmanager_secret.api_keys.arn\n"], [72, "      }\n"], [73, "    ]\n"], [74, "  })\n"], [75, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [58, 75], "resource": "aws_iam_policy.openclaw_secrets", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[58, "resource \"aws_iam_policy\" \"openclaw_secrets\" {\n"], [59, "  name        = \"openclaw-secrets-policy\"\n"], [60, "  description = \"Allow OpenClaw to read its API keys\"\n"], [61, "\n"], [62, "  policy = jsonencode({\n"], [63, "    Version = \"2012-10-17\"\n"], [64, "    Statement = [\n"], [65, "      {\n"], [66, "        Sid    = \"GetSecretValue\"\n"], [67, "        Effect = \"Allow\"\n"], [68, "        Action = [\n"], [69, "          \"secretsmanager:GetSecretValue\"\n"], [70, "        ]\n"], [71, "        Resource = aws_secretsmanager_secret.api_keys.arn\n"], [72, "      }\n"], [73, "    ]\n"], [74, "  })\n"], [75, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [58, 75], "resource": "aws_iam_policy.openclaw_secrets", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[58, "resource \"aws_iam_policy\" \"openclaw_secrets\" {\n"], [59, "  name        = \"openclaw-secrets-policy\"\n"], [60, "  description = \"Allow OpenClaw to read its API keys\"\n"], [61, "\n"], [62, "  policy = jsonencode({\n"], [63, "    Version = \"2012-10-17\"\n"], [64, "    Statement = [\n"], [65, "      {\n"], [66, "        Sid    = \"GetSecretValue\"\n"], [67, "        Effect = \"Allow\"\n"], [68, "        Action = [\n"], [69, "          \"secretsmanager:GetSecretValue\"\n"], [70, "        ]\n"], [71, "        Resource = aws_secretsmanager_secret.api_keys.arn\n"], [72, "      }\n"], [73, "    ]\n"], [74, "  })\n"], [75, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [58, 75], "resource": "aws_iam_policy.openclaw_secrets", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_289", "bc_check_id": "BC_AWS_IAM_84", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[58, "resource \"aws_iam_policy\" \"openclaw_secrets\" {\n"], [59, "  name        = \"openclaw-secrets-policy\"\n"], [60, "  description = \"Allow OpenClaw to read its API keys\"\n"], [61, "\n"], [62, "  policy = jsonencode({\n"], [63, "    Version = \"2012-10-17\"\n"], [64, "    Statement = [\n"], [65, "      {\n"], [66, "        Sid    = \"GetSecretValue\"\n"], [67, "        Effect = \"Allow\"\n"], [68, "        Action = [\n"], [69, "          \"secretsmanager:GetSecretValue\"\n"], [70, "        ]\n"], [71, "        Resource = aws_secretsmanager_secret.api_keys.arn\n"], [72, "      }\n"], [73, "    ]\n"], [74, "  })\n"], [75, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [58, 75], "resource": "aws_iam_policy.openclaw_secrets", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_288", "bc_check_id": "BC_AWS_IAM_83", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[58, "resource \"aws_iam_policy\" \"openclaw_secrets\" {\n"], [59, "  name        = \"openclaw-secrets-policy\"\n"], [60, "  description = \"Allow OpenClaw to read its API keys\"\n"], [61, "\n"], [62, "  policy = jsonencode({\n"], [63, "    Version = \"2012-10-17\"\n"], [64, "    Statement = [\n"], [65, "      {\n"], [66, "        Sid    = \"GetSecretValue\"\n"], [67, "        Effect = \"Allow\"\n"], [68, "        Action = [\n"], [69, "          \"secretsmanager:GetSecretValue\"\n"], [70, "        ]\n"], [71, "        Resource = aws_secretsmanager_secret.api_keys.arn\n"], [72, "      }\n"], [73, "    ]\n"], [74, "  })\n"], [75, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [58, 75], "resource": "aws_iam_policy.openclaw_secrets", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_355", "bc_check_id": "BC_AWS_IAM_88", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[58, "resource \"aws_iam_policy\" \"openclaw_secrets\" {\n"], [59, "  name        = \"openclaw-secrets-policy\"\n"], [60, "  description = \"Allow OpenClaw to read its API keys\"\n"], [61, "\n"], [62, "  policy = jsonencode({\n"], [63, "    Version = \"2012-10-17\"\n"], [64, "    Statement = [\n"], [65, "      {\n"], [66, "        Sid    = \"GetSecretValue\"\n"], [67, "        Effect = \"Allow\"\n"], [68, "        Action = [\n"], [69, "          \"secretsmanager:GetSecretValue\"\n"], [70, "        ]\n"], [71, "        Resource = aws_secretsmanager_secret.api_keys.arn\n"], [72, "      }\n"], [73, "    ]\n"], [74, "  })\n"], [75, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [58, 75], "resource": "aws_iam_policy.openclaw_secrets", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_287", "bc_check_id": "BC_AWS_IAM_82", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[58, "resource \"aws_iam_policy\" \"openclaw_secrets\" {\n"], [59, "  name        = \"openclaw-secrets-policy\"\n"], [60, "  description = \"Allow OpenClaw to read its API keys\"\n"], [61, "\n"], [62, "  policy = jsonencode({\n"], [63, "    Version = \"2012-10-17\"\n"], [64, "    Statement = [\n"], [65, "      {\n"], [66, "        Sid    = \"GetSecretValue\"\n"], [67, "        Effect = \"Allow\"\n"], [68, "        Action = [\n"], [69, "          \"secretsmanager:GetSecretValue\"\n"], [70, "        ]\n"], [71, "        Resource = aws_secretsmanager_secret.api_keys.arn\n"], [72, "      }\n"], [73, "    ]\n"], [74, "  })\n"], [75, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [58, 75], "resource": "aws_iam_policy.openclaw_secrets", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_290", "bc_check_id": "BC_AWS_IAM_85", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[58, "resource \"aws_iam_policy\" \"openclaw_secrets\" {\n"], [59, "  name        = \"openclaw-secrets-policy\"\n"], [60, "  description = \"Allow OpenClaw to read its API keys\"\n"], [61, "\n"], [62, "  policy = jsonencode({\n"], [63, "    Version = \"2012-10-17\"\n"], [64, "    Statement = [\n"], [65, "      {\n"], [66, "        Sid    = \"GetSecretValue\"\n"], [67, "        Effect = \"Allow\"\n"], [68, "        Action = [\n"], [69, "          \"secretsmanager:GetSecretValue\"\n"], [70, "        ]\n"], [71, "        Resource = aws_secretsmanager_secret.api_keys.arn\n"], [72, "      }\n"], [73, "    ]\n"], [74, "  })\n"], [75, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [58, 75], "resource": "aws_iam_policy.openclaw_secrets", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[77, "resource \"aws_iam_role_policy_attachment\" \"openclaw_secrets\" {\n"], [78, "  role       = aws_iam_role.openclaw.name\n"], [79, "  policy_arn = aws_iam_policy.openclaw_secrets.arn\n"], [80, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [77, 80], "resource": "aws_iam_role_policy_attachment.openclaw_secrets", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.openclaw", "path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[83, "resource \"aws_iam_policy\" \"openclaw_cloudwatch\" {\n"], [84, "  name        = \"openclaw-cloudwatch-policy\"\n"], [85, "  description = \"Allow OpenClaw to write CloudWatch logs\"\n"], [86, "\n"], [87, "  policy = jsonencode({\n"], [88, "    Version = \"2012-10-17\"\n"], [89, "    Statement = [\n"], [90, "      {\n"], [91, "        Sid    = \"WriteLogs\"\n"], [92, "        Effect = \"Allow\"\n"], [93, "        Action = [\n"], [94, "          \"logs:CreateLogStream\",\n"], [95, "          \"logs:PutLogEvents\",\n"], [96, "          \"logs:DescribeLogStreams\"\n"], [97, "        ]\n"], [98, "        Resource = [\n"], [99, "          aws_cloudwatch_log_group.openclaw.arn,\n"], [100, "          \"${aws_cloudwatch_log_group.openclaw.arn}:*\"\n"], [101, "        ]\n"], [102, "      }\n"], [103, "    ]\n"], [104, "  })\n"], [105, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [83, 105], "resource": "aws_iam_policy.openclaw_cloudwatch", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[83, "resource \"aws_iam_policy\" \"openclaw_cloudwatch\" {\n"], [84, "  name        = \"openclaw-cloudwatch-policy\"\n"], [85, "  description = \"Allow OpenClaw to write CloudWatch logs\"\n"], [86, "\n"], [87, "  policy = jsonencode({\n"], [88, "    Version = \"2012-10-17\"\n"], [89, "    Statement = [\n"], [90, "      {\n"], [91, "        Sid    = \"WriteLogs\"\n"], [92, "        Effect = \"Allow\"\n"], [93, "        Action = [\n"], [94, "          \"logs:CreateLogStream\",\n"], [95, "          \"logs:PutLogEvents\",\n"], [96, "          \"logs:DescribeLogStreams\"\n"], [97, "        ]\n"], [98, "        Resource = [\n"], [99, "          aws_cloudwatch_log_group.openclaw.arn,\n"], [100, "          \"${aws_cloudwatch_log_group.openclaw.arn}:*\"\n"], [101, "        ]\n"], [102, "      }\n"], [103, "    ]\n"], [104, "  })\n"], [105, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [83, 105], "resource": "aws_iam_policy.openclaw_cloudwatch", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[107, "resource \"aws_iam_role_policy_attachment\" \"openclaw_cloudwatch\" {\n"], [108, "  role       = aws_iam_role.openclaw.name\n"], [109, "  policy_arn = aws_iam_policy.openclaw_cloudwatch.arn\n"], [110, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [107, 110], "resource": "aws_iam_role_policy_attachment.openclaw_cloudwatch", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.openclaw", "path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "PASSED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[116, "resource \"aws_cloudwatch_log_group\" \"openclaw\" {\n"], [117, "  name              = \"/openclaw/gateway\"\n"], [118, "  retention_in_days = 365\n"], [119, "  kms_key_id        = aws_kms_key.openclaw.arn\n"], [120, "\n"], [121, "  tags = {\n"], [122, "    Name = \"openclaw-gateway-logs\"\n"], [123, "  }\n"], [124, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [116, 124], "resource": "aws_cloudwatch_log_group.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Name": "openclaw-gateway-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[116, "resource \"aws_cloudwatch_log_group\" \"openclaw\" {\n"], [117, "  name              = \"/openclaw/gateway\"\n"], [118, "  retention_in_days = 365\n"], [119, "  kms_key_id        = aws_kms_key.openclaw.arn\n"], [120, "\n"], [121, "  tags = {\n"], [122, "    Name = \"openclaw-gateway-logs\"\n"], [123, "  }\n"], [124, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [116, 124], "resource": "aws_cloudwatch_log_group.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": {"Name": "openclaw-gateway-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[116, "resource \"aws_cloudwatch_log_group\" \"openclaw\" {\n"], [117, "  name              = \"/openclaw/gateway\"\n"], [118, "  retention_in_days = 365\n"], [119, "  kms_key_id        = aws_kms_key.openclaw.arn\n"], [120, "\n"], [121, "  tags = {\n"], [122, "    Name = \"openclaw-gateway-logs\"\n"], [123, "  }\n"], [124, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [116, 124], "resource": "aws_cloudwatch_log_group.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": {"Name": "openclaw-gateway-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[21, "resource \"aws_iam_role\" \"janitor_lambda\" {\n"], [22, "  name = \"openclaw-janitor-lambda-role\"\n"], [23, "\n"], [24, "  assume_role_policy = jsonencode({\n"], [25, "    Version = \"2012-10-17\"\n"], [26, "    Statement = [\n"], [27, "      {\n"], [28, "        Action = \"sts:AssumeRole\"\n"], [29, "        Effect = \"Allow\"\n"], [30, "        Principal = {\n"], [31, "          Service = \"lambda.amazonaws.com\"\n"], [32, "        }\n"], [33, "      }\n"], [34, "    ]\n"], [35, "  })\n"], [36, "\n"], [37, "  tags = {\n"], [38, "    Name = \"openclaw-janitor-role\"\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [21, 40], "resource": "aws_iam_role.janitor_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Name": "openclaw-janitor-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[21, "resource \"aws_iam_role\" \"janitor_lambda\" {\n"], [22, "  name = \"openclaw-janitor-lambda-role\"\n"], [23, "\n"], [24, "  assume_role_policy = jsonencode({\n"], [25, "    Version = \"2012-10-17\"\n"], [26, "    Statement = [\n"], [27, "      {\n"], [28, "        Action = \"sts:AssumeRole\"\n"], [29, "        Effect = \"Allow\"\n"], [30, "        Principal = {\n"], [31, "          Service = \"lambda.amazonaws.com\"\n"], [32, "        }\n"], [33, "      }\n"], [34, "    ]\n"], [35, "  })\n"], [36, "\n"], [37, "  tags = {\n"], [38, "    Name = \"openclaw-janitor-role\"\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [21, 40], "resource": "aws_iam_role.janitor_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Name": "openclaw-janitor-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[21, "resource \"aws_iam_role\" \"janitor_lambda\" {\n"], [22, "  name = \"openclaw-janitor-lambda-role\"\n"], [23, "\n"], [24, "  assume_role_policy = jsonencode({\n"], [25, "    Version = \"2012-10-17\"\n"], [26, "    Statement = [\n"], [27, "      {\n"], [28, "        Action = \"sts:AssumeRole\"\n"], [29, "        Effect = \"Allow\"\n"], [30, "        Principal = {\n"], [31, "          Service = \"lambda.amazonaws.com\"\n"], [32, "        }\n"], [33, "      }\n"], [34, "    ]\n"], [35, "  })\n"], [36, "\n"], [37, "  tags = {\n"], [38, "    Name = \"openclaw-janitor-role\"\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [21, 40], "resource": "aws_iam_role.janitor_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Name": "openclaw-janitor-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV_AWS_286", "bc_check_id": "BC_AWS_IAM_81", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[42, "resource \"aws_iam_role_policy\" \"janitor_lambda\" {\n"], [43, "  name = \"openclaw-janitor-policy\"\n"], [44, "  role = aws_iam_role.janitor_lambda.id\n"], [45, "\n"], [46, "  policy = jsonencode({\n"], [47, "    Version = \"2012-10-17\"\n"], [48, "    Statement = [\n"], [49, "      {\n"], [50, "        Sid    = \"EC2Operations\"\n"], [51, "        Effect = \"Allow\"\n"], [52, "        Action = [\n"], [53, "          \"ec2:DescribeInstances\",\n"], [54, "          \"ec2:StopInstances\",\n"], [55, "          \"ec2:StartInstances\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          StringEquals = {\n"], [60, "            \"ec2:ResourceTag/Project\" = \"hardened-openclaw\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"CloudWatchLogs\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Action = [\n"], [68, "          \"logs:CreateLogGroup\",\n"], [69, "          \"logs:CreateLogStream\",\n"], [70, "          \"logs:PutLogEvents\"\n"], [71, "        ]\n"], [72, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [73, "      },\n"], [74, "      {\n"], [75, "        Sid    = \"SSMRunCommand\"\n"], [76, "        Effect = \"Allow\"\n"], [77, "        Action = [\n"], [78, "          \"ssm:SendCommand\",\n"], [79, "          \"ssm:GetCommandInvocation\"\n"], [80, "        ]\n"], [81, "        Resource = \"*\"\n"], [82, "      },\n"], [83, "      {\n"], [84, "        Sid    = \"XRayTracing\"\n"], [85, "        Effect = \"Allow\"\n"], [86, "        Action = [\n"], [87, "          \"xray:PutTraceSegments\",\n"], [88, "          \"xray:PutTelemetryRecords\"\n"], [89, "        ]\n"], [90, "        Resource = \"*\"\n"], [91, "      }\n"], [92, "    ]\n"], [93, "  })\n"], [94, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [42, 94], "resource": "aws_iam_role_policy.janitor_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[42, "resource \"aws_iam_role_policy\" \"janitor_lambda\" {\n"], [43, "  name = \"openclaw-janitor-policy\"\n"], [44, "  role = aws_iam_role.janitor_lambda.id\n"], [45, "\n"], [46, "  policy = jsonencode({\n"], [47, "    Version = \"2012-10-17\"\n"], [48, "    Statement = [\n"], [49, "      {\n"], [50, "        Sid    = \"EC2Operations\"\n"], [51, "        Effect = \"Allow\"\n"], [52, "        Action = [\n"], [53, "          \"ec2:DescribeInstances\",\n"], [54, "          \"ec2:StopInstances\",\n"], [55, "          \"ec2:StartInstances\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          StringEquals = {\n"], [60, "            \"ec2:ResourceTag/Project\" = \"hardened-openclaw\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"CloudWatchLogs\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Action = [\n"], [68, "          \"logs:CreateLogGroup\",\n"], [69, "          \"logs:CreateLogStream\",\n"], [70, "          \"logs:PutLogEvents\"\n"], [71, "        ]\n"], [72, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [73, "      },\n"], [74, "      {\n"], [75, "        Sid    = \"SSMRunCommand\"\n"], [76, "        Effect = \"Allow\"\n"], [77, "        Action = [\n"], [78, "          \"ssm:SendCommand\",\n"], [79, "          \"ssm:GetCommandInvocation\"\n"], [80, "        ]\n"], [81, "        Resource = \"*\"\n"], [82, "      },\n"], [83, "      {\n"], [84, "        Sid    = \"XRayTracing\"\n"], [85, "        Effect = \"Allow\"\n"], [86, "        Action = [\n"], [87, "          \"xray:PutTraceSegments\",\n"], [88, "          \"xray:PutTelemetryRecords\"\n"], [89, "        ]\n"], [90, "        Resource = \"*\"\n"], [91, "      }\n"], [92, "    ]\n"], [93, "  })\n"], [94, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [42, 94], "resource": "aws_iam_role_policy.janitor_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[42, "resource \"aws_iam_role_policy\" \"janitor_lambda\" {\n"], [43, "  name = \"openclaw-janitor-policy\"\n"], [44, "  role = aws_iam_role.janitor_lambda.id\n"], [45, "\n"], [46, "  policy = jsonencode({\n"], [47, "    Version = \"2012-10-17\"\n"], [48, "    Statement = [\n"], [49, "      {\n"], [50, "        Sid    = \"EC2Operations\"\n"], [51, "        Effect = \"Allow\"\n"], [52, "        Action = [\n"], [53, "          \"ec2:DescribeInstances\",\n"], [54, "          \"ec2:StopInstances\",\n"], [55, "          \"ec2:StartInstances\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          StringEquals = {\n"], [60, "            \"ec2:ResourceTag/Project\" = \"hardened-openclaw\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"CloudWatchLogs\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Action = [\n"], [68, "          \"logs:CreateLogGroup\",\n"], [69, "          \"logs:CreateLogStream\",\n"], [70, "          \"logs:PutLogEvents\"\n"], [71, "        ]\n"], [72, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [73, "      },\n"], [74, "      {\n"], [75, "        Sid    = \"SSMRunCommand\"\n"], [76, "        Effect = \"Allow\"\n"], [77, "        Action = [\n"], [78, "          \"ssm:SendCommand\",\n"], [79, "          \"ssm:GetCommandInvocation\"\n"], [80, "        ]\n"], [81, "        Resource = \"*\"\n"], [82, "      },\n"], [83, "      {\n"], [84, "        Sid    = \"XRayTracing\"\n"], [85, "        Effect = \"Allow\"\n"], [86, "        Action = [\n"], [87, "          \"xray:PutTraceSegments\",\n"], [88, "          \"xray:PutTelemetryRecords\"\n"], [89, "        ]\n"], [90, "        Resource = \"*\"\n"], [91, "      }\n"], [92, "    ]\n"], [93, "  })\n"], [94, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [42, 94], "resource": "aws_iam_role_policy.janitor_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV_AWS_289", "bc_check_id": "BC_AWS_IAM_84", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[42, "resource \"aws_iam_role_policy\" \"janitor_lambda\" {\n"], [43, "  name = \"openclaw-janitor-policy\"\n"], [44, "  role = aws_iam_role.janitor_lambda.id\n"], [45, "\n"], [46, "  policy = jsonencode({\n"], [47, "    Version = \"2012-10-17\"\n"], [48, "    Statement = [\n"], [49, "      {\n"], [50, "        Sid    = \"EC2Operations\"\n"], [51, "        Effect = \"Allow\"\n"], [52, "        Action = [\n"], [53, "          \"ec2:DescribeInstances\",\n"], [54, "          \"ec2:StopInstances\",\n"], [55, "          \"ec2:StartInstances\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          StringEquals = {\n"], [60, "            \"ec2:ResourceTag/Project\" = \"hardened-openclaw\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"CloudWatchLogs\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Action = [\n"], [68, "          \"logs:CreateLogGroup\",\n"], [69, "          \"logs:CreateLogStream\",\n"], [70, "          \"logs:PutLogEvents\"\n"], [71, "        ]\n"], [72, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [73, "      },\n"], [74, "      {\n"], [75, "        Sid    = \"SSMRunCommand\"\n"], [76, "        Effect = \"Allow\"\n"], [77, "        Action = [\n"], [78, "          \"ssm:SendCommand\",\n"], [79, "          \"ssm:GetCommandInvocation\"\n"], [80, "        ]\n"], [81, "        Resource = \"*\"\n"], [82, "      },\n"], [83, "      {\n"], [84, "        Sid    = \"XRayTracing\"\n"], [85, "        Effect = \"Allow\"\n"], [86, "        Action = [\n"], [87, "          \"xray:PutTraceSegments\",\n"], [88, "          \"xray:PutTelemetryRecords\"\n"], [89, "        ]\n"], [90, "        Resource = \"*\"\n"], [91, "      }\n"], [92, "    ]\n"], [93, "  })\n"], [94, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [42, 94], "resource": "aws_iam_role_policy.janitor_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV_AWS_288", "bc_check_id": "BC_AWS_IAM_83", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[42, "resource \"aws_iam_role_policy\" \"janitor_lambda\" {\n"], [43, "  name = \"openclaw-janitor-policy\"\n"], [44, "  role = aws_iam_role.janitor_lambda.id\n"], [45, "\n"], [46, "  policy = jsonencode({\n"], [47, "    Version = \"2012-10-17\"\n"], [48, "    Statement = [\n"], [49, "      {\n"], [50, "        Sid    = \"EC2Operations\"\n"], [51, "        Effect = \"Allow\"\n"], [52, "        Action = [\n"], [53, "          \"ec2:DescribeInstances\",\n"], [54, "          \"ec2:StopInstances\",\n"], [55, "          \"ec2:StartInstances\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          StringEquals = {\n"], [60, "            \"ec2:ResourceTag/Project\" = \"hardened-openclaw\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"CloudWatchLogs\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Action = [\n"], [68, "          \"logs:CreateLogGroup\",\n"], [69, "          \"logs:CreateLogStream\",\n"], [70, "          \"logs:PutLogEvents\"\n"], [71, "        ]\n"], [72, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [73, "      },\n"], [74, "      {\n"], [75, "        Sid    = \"SSMRunCommand\"\n"], [76, "        Effect = \"Allow\"\n"], [77, "        Action = [\n"], [78, "          \"ssm:SendCommand\",\n"], [79, "          \"ssm:GetCommandInvocation\"\n"], [80, "        ]\n"], [81, "        Resource = \"*\"\n"], [82, "      },\n"], [83, "      {\n"], [84, "        Sid    = \"XRayTracing\"\n"], [85, "        Effect = \"Allow\"\n"], [86, "        Action = [\n"], [87, "          \"xray:PutTraceSegments\",\n"], [88, "          \"xray:PutTelemetryRecords\"\n"], [89, "        ]\n"], [90, "        Resource = \"*\"\n"], [91, "      }\n"], [92, "    ]\n"], [93, "  })\n"], [94, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [42, 94], "resource": "aws_iam_role_policy.janitor_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV_AWS_287", "bc_check_id": "BC_AWS_IAM_82", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[42, "resource \"aws_iam_role_policy\" \"janitor_lambda\" {\n"], [43, "  name = \"openclaw-janitor-policy\"\n"], [44, "  role = aws_iam_role.janitor_lambda.id\n"], [45, "\n"], [46, "  policy = jsonencode({\n"], [47, "    Version = \"2012-10-17\"\n"], [48, "    Statement = [\n"], [49, "      {\n"], [50, "        Sid    = \"EC2Operations\"\n"], [51, "        Effect = \"Allow\"\n"], [52, "        Action = [\n"], [53, "          \"ec2:DescribeInstances\",\n"], [54, "          \"ec2:StopInstances\",\n"], [55, "          \"ec2:StartInstances\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          StringEquals = {\n"], [60, "            \"ec2:ResourceTag/Project\" = \"hardened-openclaw\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"CloudWatchLogs\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Action = [\n"], [68, "          \"logs:CreateLogGroup\",\n"], [69, "          \"logs:CreateLogStream\",\n"], [70, "          \"logs:PutLogEvents\"\n"], [71, "        ]\n"], [72, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [73, "      },\n"], [74, "      {\n"], [75, "        Sid    = \"SSMRunCommand\"\n"], [76, "        Effect = \"Allow\"\n"], [77, "        Action = [\n"], [78, "          \"ssm:SendCommand\",\n"], [79, "          \"ssm:GetCommandInvocation\"\n"], [80, "        ]\n"], [81, "        Resource = \"*\"\n"], [82, "      },\n"], [83, "      {\n"], [84, "        Sid    = \"XRayTracing\"\n"], [85, "        Effect = \"Allow\"\n"], [86, "        Action = [\n"], [87, "          \"xray:PutTraceSegments\",\n"], [88, "          \"xray:PutTelemetryRecords\"\n"], [89, "        ]\n"], [90, "        Resource = \"*\"\n"], [91, "      }\n"], [92, "    ]\n"], [93, "  })\n"], [94, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [42, 94], "resource": "aws_iam_role_policy.janitor_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV_AWS_45", "bc_check_id": "BC_AWS_SECRETS_3", "check_name": "Ensure no hard-coded secrets exist in lambda environment", "check_result": {"result": "PASSED", "evaluated_keys": ["environment/[0]/variables"]}, "code_block": [[101, "resource \"aws_lambda_function\" \"docker_cleanup\" {\n"], [102, "  filename                       = data.archive_file.docker_cleanup.output_path\n"], [103, "  function_name                  = \"openclaw-docker-cleanup\"\n"], [104, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [105, "  handler                        = \"index.handler\"\n"], [106, "  source_code_hash               = data.archive_file.docker_cleanup.output_base64sha256\n"], [107, "  runtime                        = \"python3.11\"\n"], [108, "  timeout                        = 300\n"], [109, "  reserved_concurrent_executions = 1\n"], [110, "\n"], [111, "  tracing_config {\n"], [112, "    mode = \"Active\"\n"], [113, "  }\n"], [114, "\n"], [115, "  environment {\n"], [116, "    variables = {\n"], [117, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [118, "    }\n"], [119, "  }\n"], [120, "\n"], [121, "  tags = {\n"], [122, "    Name = \"openclaw-docker-cleanup\"\n"], [123, "  }\n"], [124, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [101, 124], "resource": "aws_lambda_function.docker_cleanup", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaEnvironmentCredentials", "fixed_definition": null, "entity_tags": {"Name": "openclaw-docker-cleanup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-3", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.docker_cleanup", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_363", "bc_check_id": "BC_AWS_GENERAL_259", "check_name": "Ensure Lambda Runtime is not deprecated", "check_result": {"result": "PASSED", "evaluated_keys": ["runtime"]}, "code_block": [[101, "resource \"aws_lambda_function\" \"docker_cleanup\" {\n"], [102, "  filename                       = data.archive_file.docker_cleanup.output_path\n"], [103, "  function_name                  = \"openclaw-docker-cleanup\"\n"], [104, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [105, "  handler                        = \"index.handler\"\n"], [106, "  source_code_hash               = data.archive_file.docker_cleanup.output_base64sha256\n"], [107, "  runtime                        = \"python3.11\"\n"], [108, "  timeout                        = 300\n"], [109, "  reserved_concurrent_executions = 1\n"], [110, "\n"], [111, "  tracing_config {\n"], [112, "    mode = \"Active\"\n"], [113, "  }\n"], [114, "\n"], [115, "  environment {\n"], [116, "    variables = {\n"], [117, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [118, "    }\n"], [119, "  }\n"], [120, "\n"], [121, "  tags = {\n"], [122, "    Name = \"openclaw-docker-cleanup\"\n"], [123, "  }\n"], [124, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [101, 124], "resource": "aws_lambda_function.docker_cleanup", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DeprecatedLambdaRuntime", "fixed_definition": null, "entity_tags": {"Name": "openclaw-docker-cleanup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.docker_cleanup", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_50", "bc_check_id": "BC_AWS_SERVERLESS_4", "check_name": "X-Ray tracing is enabled for Lambda", "check_result": {"result": "PASSED", "evaluated_keys": ["tracing_config/[0]/mode"]}, "code_block": [[101, "resource \"aws_lambda_function\" \"docker_cleanup\" {\n"], [102, "  filename                       = data.archive_file.docker_cleanup.output_path\n"], [103, "  function_name                  = \"openclaw-docker-cleanup\"\n"], [104, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [105, "  handler                        = \"index.handler\"\n"], [106, "  source_code_hash               = data.archive_file.docker_cleanup.output_base64sha256\n"], [107, "  runtime                        = \"python3.11\"\n"], [108, "  timeout                        = 300\n"], [109, "  reserved_concurrent_executions = 1\n"], [110, "\n"], [111, "  tracing_config {\n"], [112, "    mode = \"Active\"\n"], [113, "  }\n"], [114, "\n"], [115, "  environment {\n"], [116, "    variables = {\n"], [117, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [118, "    }\n"], [119, "  }\n"], [120, "\n"], [121, "  tags = {\n"], [122, "    Name = \"openclaw-docker-cleanup\"\n"], [123, "  }\n"], [124, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [101, 124], "resource": "aws_lambda_function.docker_cleanup", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaXrayEnabled", "fixed_definition": null, "entity_tags": {"Name": "openclaw-docker-cleanup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.docker_cleanup", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "PASSED", "evaluated_keys": ["reserved_concurrent_executions/[0]"]}, "code_block": [[101, "resource \"aws_lambda_function\" \"docker_cleanup\" {\n"], [102, "  filename                       = data.archive_file.docker_cleanup.output_path\n"], [103, "  function_name                  = \"openclaw-docker-cleanup\"\n"], [104, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [105, "  handler                        = \"index.handler\"\n"], [106, "  source_code_hash               = data.archive_file.docker_cleanup.output_base64sha256\n"], [107, "  runtime                        = \"python3.11\"\n"], [108, "  timeout                        = 300\n"], [109, "  reserved_concurrent_executions = 1\n"], [110, "\n"], [111, "  tracing_config {\n"], [112, "    mode = \"Active\"\n"], [113, "  }\n"], [114, "\n"], [115, "  environment {\n"], [116, "    variables = {\n"], [117, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [118, "    }\n"], [119, "  }\n"], [120, "\n"], [121, "  tags = {\n"], [122, "    Name = \"openclaw-docker-cleanup\"\n"], [123, "  }\n"], [124, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [101, 124], "resource": "aws_lambda_function.docker_cleanup", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": {"Name": "openclaw-docker-cleanup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.docker_cleanup", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_301", "bc_check_id": "BC_AWS_GENERAL_215", "check_name": "Ensure that AWS Lambda function is not publicly accessible", "check_result": {"result": "PASSED", "evaluated_keys": ["principal"]}, "code_block": [[177, "resource \"aws_lambda_permission\" \"docker_cleanup\" {\n"], [178, "  statement_id  = \"AllowEventBridge\"\n"], [179, "  action        = \"lambda:InvokeFunction\"\n"], [180, "  function_name = aws_lambda_function.docker_cleanup.function_name\n"], [181, "  principal     = \"events.amazonaws.com\"\n"], [182, "  source_arn    = aws_cloudwatch_event_rule.docker_cleanup.arn\n"], [183, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [177, 183], "resource": "aws_lambda_permission.docker_cleanup", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaFunctionIsNotPublic", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-301", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"function_name": [{"type": "resource", "name": "aws_lambda_function.docker_cleanup", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_364", "bc_check_id": "BC_AWS_IAM_91", "check_name": "Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount", "check_result": {"result": "PASSED", "evaluated_keys": ["principal", "source_arn", "source_account"]}, "code_block": [[177, "resource \"aws_lambda_permission\" \"docker_cleanup\" {\n"], [178, "  statement_id  = \"AllowEventBridge\"\n"], [179, "  action        = \"lambda:InvokeFunction\"\n"], [180, "  function_name = aws_lambda_function.docker_cleanup.function_name\n"], [181, "  principal     = \"events.amazonaws.com\"\n"], [182, "  source_arn    = aws_cloudwatch_event_rule.docker_cleanup.arn\n"], [183, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [177, 183], "resource": "aws_lambda_permission.docker_cleanup", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaServicePermission", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-364", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"function_name": [{"type": "resource", "name": "aws_lambda_function.docker_cleanup", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_45", "bc_check_id": "BC_AWS_SECRETS_3", "check_name": "Ensure no hard-coded secrets exist in lambda environment", "check_result": {"result": "PASSED", "evaluated_keys": ["environment/[0]/variables"]}, "code_block": [[214, "resource \"aws_lambda_function\" \"patch_check\" {\n"], [215, "  filename                       = data.archive_file.patch_check.output_path\n"], [216, "  function_name                  = \"openclaw-patch-check\"\n"], [217, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [218, "  handler                        = \"index.handler\"\n"], [219, "  source_code_hash               = data.archive_file.patch_check.output_base64sha256\n"], [220, "  runtime                        = \"python3.11\"\n"], [221, "  timeout                        = 300\n"], [222, "  reserved_concurrent_executions = 1\n"], [223, "\n"], [224, "  tracing_config {\n"], [225, "    mode = \"Active\"\n"], [226, "  }\n"], [227, "\n"], [228, "  environment {\n"], [229, "    variables = {\n"], [230, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [231, "      SNS_TOPIC   = aws_sns_topic.alerts.arn\n"], [232, "    }\n"], [233, "  }\n"], [234, "\n"], [235, "  tags = {\n"], [236, "    Name = \"openclaw-patch-check\"\n"], [237, "  }\n"], [238, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [214, 238], "resource": "aws_lambda_function.patch_check", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaEnvironmentCredentials", "fixed_definition": null, "entity_tags": {"Name": "openclaw-patch-check"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-3", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.patch_check", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_363", "bc_check_id": "BC_AWS_GENERAL_259", "check_name": "Ensure Lambda Runtime is not deprecated", "check_result": {"result": "PASSED", "evaluated_keys": ["runtime"]}, "code_block": [[214, "resource \"aws_lambda_function\" \"patch_check\" {\n"], [215, "  filename                       = data.archive_file.patch_check.output_path\n"], [216, "  function_name                  = \"openclaw-patch-check\"\n"], [217, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [218, "  handler                        = \"index.handler\"\n"], [219, "  source_code_hash               = data.archive_file.patch_check.output_base64sha256\n"], [220, "  runtime                        = \"python3.11\"\n"], [221, "  timeout                        = 300\n"], [222, "  reserved_concurrent_executions = 1\n"], [223, "\n"], [224, "  tracing_config {\n"], [225, "    mode = \"Active\"\n"], [226, "  }\n"], [227, "\n"], [228, "  environment {\n"], [229, "    variables = {\n"], [230, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [231, "      SNS_TOPIC   = aws_sns_topic.alerts.arn\n"], [232, "    }\n"], [233, "  }\n"], [234, "\n"], [235, "  tags = {\n"], [236, "    Name = \"openclaw-patch-check\"\n"], [237, "  }\n"], [238, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [214, 238], "resource": "aws_lambda_function.patch_check", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DeprecatedLambdaRuntime", "fixed_definition": null, "entity_tags": {"Name": "openclaw-patch-check"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-363", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.patch_check", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_50", "bc_check_id": "BC_AWS_SERVERLESS_4", "check_name": "X-Ray tracing is enabled for Lambda", "check_result": {"result": "PASSED", "evaluated_keys": ["tracing_config/[0]/mode"]}, "code_block": [[214, "resource \"aws_lambda_function\" \"patch_check\" {\n"], [215, "  filename                       = data.archive_file.patch_check.output_path\n"], [216, "  function_name                  = \"openclaw-patch-check\"\n"], [217, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [218, "  handler                        = \"index.handler\"\n"], [219, "  source_code_hash               = data.archive_file.patch_check.output_base64sha256\n"], [220, "  runtime                        = \"python3.11\"\n"], [221, "  timeout                        = 300\n"], [222, "  reserved_concurrent_executions = 1\n"], [223, "\n"], [224, "  tracing_config {\n"], [225, "    mode = \"Active\"\n"], [226, "  }\n"], [227, "\n"], [228, "  environment {\n"], [229, "    variables = {\n"], [230, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [231, "      SNS_TOPIC   = aws_sns_topic.alerts.arn\n"], [232, "    }\n"], [233, "  }\n"], [234, "\n"], [235, "  tags = {\n"], [236, "    Name = \"openclaw-patch-check\"\n"], [237, "  }\n"], [238, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [214, 238], "resource": "aws_lambda_function.patch_check", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaXrayEnabled", "fixed_definition": null, "entity_tags": {"Name": "openclaw-patch-check"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.patch_check", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "PASSED", "evaluated_keys": ["reserved_concurrent_executions/[0]"]}, "code_block": [[214, "resource \"aws_lambda_function\" \"patch_check\" {\n"], [215, "  filename                       = data.archive_file.patch_check.output_path\n"], [216, "  function_name                  = \"openclaw-patch-check\"\n"], [217, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [218, "  handler                        = \"index.handler\"\n"], [219, "  source_code_hash               = data.archive_file.patch_check.output_base64sha256\n"], [220, "  runtime                        = \"python3.11\"\n"], [221, "  timeout                        = 300\n"], [222, "  reserved_concurrent_executions = 1\n"], [223, "\n"], [224, "  tracing_config {\n"], [225, "    mode = \"Active\"\n"], [226, "  }\n"], [227, "\n"], [228, "  environment {\n"], [229, "    variables = {\n"], [230, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [231, "      SNS_TOPIC   = aws_sns_topic.alerts.arn\n"], [232, "    }\n"], [233, "  }\n"], [234, "\n"], [235, "  tags = {\n"], [236, "    Name = \"openclaw-patch-check\"\n"], [237, "  }\n"], [238, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [214, 238], "resource": "aws_lambda_function.patch_check", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": {"Name": "openclaw-patch-check"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.patch_check", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_301", "bc_check_id": "BC_AWS_GENERAL_215", "check_name": "Ensure that AWS Lambda function is not publicly accessible", "check_result": {"result": "PASSED", "evaluated_keys": ["principal"]}, "code_block": [[296, "resource \"aws_lambda_permission\" \"patch_check\" {\n"], [297, "  statement_id  = \"AllowEventBridge\"\n"], [298, "  action        = \"lambda:InvokeFunction\"\n"], [299, "  function_name = aws_lambda_function.patch_check.function_name\n"], [300, "  principal     = \"events.amazonaws.com\"\n"], [301, "  source_arn    = aws_cloudwatch_event_rule.patch_check.arn\n"], [302, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [296, 302], "resource": "aws_lambda_permission.patch_check", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaFunctionIsNotPublic", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-301", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"function_name": [{"type": "resource", "name": "aws_lambda_function.patch_check", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_364", "bc_check_id": "BC_AWS_IAM_91", "check_name": "Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount", "check_result": {"result": "PASSED", "evaluated_keys": ["principal", "source_arn", "source_account"]}, "code_block": [[296, "resource \"aws_lambda_permission\" \"patch_check\" {\n"], [297, "  statement_id  = \"AllowEventBridge\"\n"], [298, "  action        = \"lambda:InvokeFunction\"\n"], [299, "  function_name = aws_lambda_function.patch_check.function_name\n"], [300, "  principal     = \"events.amazonaws.com\"\n"], [301, "  source_arn    = aws_cloudwatch_event_rule.patch_check.arn\n"], [302, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [296, 302], "resource": "aws_lambda_permission.patch_check", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaServicePermission", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-364", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"function_name": [{"type": "resource", "name": "aws_lambda_function.patch_check", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_41", "bc_check_id": "BC_AWS_SECRETS_5", "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[33, "provider \"aws\" {\n"], [34, "  region = var.aws_region\n"], [35, "\n"], [36, "  # Tags applied to ALL resources - helps with cost tracking and organization\n"], [37, "  default_tags {\n"], [38, "    tags = {\n"], [39, "      Project     = \"hardened-openclaw\"\n"], [40, "      Environment = var.environment\n"], [41, "      ManagedBy   = \"terraform\"\n"], [42, "    }\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [33, 44], "resource": "aws.default", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "breadcrumbs": {"region": [{"type": "variable", "name": "aws_region", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "default_tags.tags.Environment": [{"type": "variable", "name": "environment", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "default_tags.tags": [{"type": "variable", "name": "environment", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[77, "resource \"aws_subnet\" \"private_a\" {\n"], [78, "  vpc_id            = aws_vpc.main.id\n"], [79, "  cidr_block        = \"10.0.1.0/24\"\n"], [80, "  availability_zone = \"${var.aws_region}a\"\n"], [81, "\n"], [82, "  map_public_ip_on_launch = false\n"], [83, "\n"], [84, "  tags = {\n"], [85, "    Name = \"openclaw-private-subnet-a\"\n"], [86, "  }\n"], [87, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [77, 87], "resource": "aws_subnet.private_a", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "openclaw-private-subnet-a"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "aws_region", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "PASSED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[89, "resource \"aws_subnet\" \"private_b\" {\n"], [90, "  vpc_id            = aws_vpc.main.id\n"], [91, "  cidr_block        = \"10.0.3.0/24\"\n"], [92, "  availability_zone = \"${var.aws_region}b\"\n"], [93, "\n"], [94, "  map_public_ip_on_launch = false\n"], [95, "\n"], [96, "  tags = {\n"], [97, "    Name = \"openclaw-private-subnet-b\"\n"], [98, "  }\n"], [99, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [89, 99], "resource": "aws_subnet.private_b", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "openclaw-private-subnet-b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "aws_region", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[113, "resource \"aws_security_group\" \"vpc_endpoints\" {\n"], [114, "  name        = \"vpc-endpoints-sg\"\n"], [115, "  description = \"Allow HTTPS from VPC for AWS service endpoints\"\n"], [116, "  vpc_id      = aws_vpc.main.id\n"], [117, "\n"], [118, "  ingress {\n"], [119, "    from_port   = 443\n"], [120, "    to_port     = 443\n"], [121, "    protocol    = \"tcp\"\n"], [122, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [123, "    description = \"HTTPS from VPC\"\n"], [124, "  }\n"], [125, "\n"], [126, "  tags = {\n"], [127, "    Name = \"vpc-endpoints-sg\"\n"], [128, "  }\n"], [129, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [113, 129], "resource": "aws_security_group.vpc_endpoints", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "vpc-endpoints-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[113, "resource \"aws_security_group\" \"vpc_endpoints\" {\n"], [114, "  name        = \"vpc-endpoints-sg\"\n"], [115, "  description = \"Allow HTTPS from VPC for AWS service endpoints\"\n"], [116, "  vpc_id      = aws_vpc.main.id\n"], [117, "\n"], [118, "  ingress {\n"], [119, "    from_port   = 443\n"], [120, "    to_port     = 443\n"], [121, "    protocol    = \"tcp\"\n"], [122, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [123, "    description = \"HTTPS from VPC\"\n"], [124, "  }\n"], [125, "\n"], [126, "  tags = {\n"], [127, "    Name = \"vpc-endpoints-sg\"\n"], [128, "  }\n"], [129, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [113, 129], "resource": "aws_security_group.vpc_endpoints", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "vpc-endpoints-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[113, "resource \"aws_security_group\" \"vpc_endpoints\" {\n"], [114, "  name        = \"vpc-endpoints-sg\"\n"], [115, "  description = \"Allow HTTPS from VPC for AWS service endpoints\"\n"], [116, "  vpc_id      = aws_vpc.main.id\n"], [117, "\n"], [118, "  ingress {\n"], [119, "    from_port   = 443\n"], [120, "    to_port     = 443\n"], [121, "    protocol    = \"tcp\"\n"], [122, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [123, "    description = \"HTTPS from VPC\"\n"], [124, "  }\n"], [125, "\n"], [126, "  tags = {\n"], [127, "    Name = \"vpc-endpoints-sg\"\n"], [128, "  }\n"], [129, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [113, 129], "resource": "aws_security_group.vpc_endpoints", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "vpc-endpoints-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-2", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security group and rule has a description", "check_result": {"result": "PASSED", "evaluated_keys": ["description"]}, "code_block": [[113, "resource \"aws_security_group\" \"vpc_endpoints\" {\n"], [114, "  name        = \"vpc-endpoints-sg\"\n"], [115, "  description = \"Allow HTTPS from VPC for AWS service endpoints\"\n"], [116, "  vpc_id      = aws_vpc.main.id\n"], [117, "\n"], [118, "  ingress {\n"], [119, "    from_port   = 443\n"], [120, "    to_port     = 443\n"], [121, "    protocol    = \"tcp\"\n"], [122, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [123, "    description = \"HTTPS from VPC\"\n"], [124, "  }\n"], [125, "\n"], [126, "  tags = {\n"], [127, "    Name = \"vpc-endpoints-sg\"\n"], [128, "  }\n"], [129, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [113, 129], "resource": "aws_security_group.vpc_endpoints", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "vpc-endpoints-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_382", "bc_check_id": "BC_AWS_IAM_93", "check_name": "Ensure no security groups allow egress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": ["from_port", "to_port", "cidr_ipv4", "cidr_ipv6"]}, "code_block": [[113, "resource \"aws_security_group\" \"vpc_endpoints\" {\n"], [114, "  name        = \"vpc-endpoints-sg\"\n"], [115, "  description = \"Allow HTTPS from VPC for AWS service endpoints\"\n"], [116, "  vpc_id      = aws_vpc.main.id\n"], [117, "\n"], [118, "  ingress {\n"], [119, "    from_port   = 443\n"], [120, "    to_port     = 443\n"], [121, "    protocol    = \"tcp\"\n"], [122, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [123, "    description = \"HTTPS from VPC\"\n"], [124, "  }\n"], [125, "\n"], [126, "  tags = {\n"], [127, "    Name = \"vpc-endpoints-sg\"\n"], [128, "  }\n"], [129, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [113, 129], "resource": "aws_security_group.vpc_endpoints", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedEgressAny", "fixed_definition": null, "entity_tags": {"Name": "vpc-endpoints-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[113, "resource \"aws_security_group\" \"vpc_endpoints\" {\n"], [114, "  name        = \"vpc-endpoints-sg\"\n"], [115, "  description = \"Allow HTTPS from VPC for AWS service endpoints\"\n"], [116, "  vpc_id      = aws_vpc.main.id\n"], [117, "\n"], [118, "  ingress {\n"], [119, "    from_port   = 443\n"], [120, "    to_port     = 443\n"], [121, "    protocol    = \"tcp\"\n"], [122, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [123, "    description = \"HTTPS from VPC\"\n"], [124, "  }\n"], [125, "\n"], [126, "  tags = {\n"], [127, "    Name = \"vpc-endpoints-sg\"\n"], [128, "  }\n"], [129, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [113, 129], "resource": "aws_security_group.vpc_endpoints", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "vpc-endpoints-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_158", "bc_check_id": "BC_AWS_GENERAL_85", "check_name": "Ensure that CloudWatch Log Group is encrypted by KMS", "check_result": {"result": "PASSED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[334, "resource \"aws_cloudwatch_log_group\" \"flow_logs\" {\n"], [335, "  name              = \"/openclaw/vpc-flow-logs\"\n"], [336, "  retention_in_days = 365\n"], [337, "  kms_key_id        = aws_kms_key.openclaw.arn\n"], [338, "\n"], [339, "  tags = {\n"], [340, "    Name = \"openclaw-flow-logs\"\n"], [341, "  }\n"], [342, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [334, 342], "resource": "aws_cloudwatch_log_group.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupKMSKey", "fixed_definition": null, "entity_tags": {"Name": "openclaw-flow-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-cloudwatch-log-group-is-encrypted-by-kms", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_66", "bc_check_id": "BC_AWS_LOGGING_13", "check_name": "Ensure that CloudWatch Log Group specifies retention days", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[334, "resource \"aws_cloudwatch_log_group\" \"flow_logs\" {\n"], [335, "  name              = \"/openclaw/vpc-flow-logs\"\n"], [336, "  retention_in_days = 365\n"], [337, "  kms_key_id        = aws_kms_key.openclaw.arn\n"], [338, "\n"], [339, "  tags = {\n"], [340, "    Name = \"openclaw-flow-logs\"\n"], [341, "  }\n"], [342, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [334, 342], "resource": "aws_cloudwatch_log_group.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetention", "fixed_definition": null, "entity_tags": {"Name": "openclaw-flow-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-13", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_338", "bc_check_id": "BC_AWS_LOGGING_46", "check_name": "Ensure CloudWatch log groups retains logs for at least 1 year", "check_result": {"result": "PASSED", "evaluated_keys": ["retention_in_days"]}, "code_block": [[334, "resource \"aws_cloudwatch_log_group\" \"flow_logs\" {\n"], [335, "  name              = \"/openclaw/vpc-flow-logs\"\n"], [336, "  retention_in_days = 365\n"], [337, "  kms_key_id        = aws_kms_key.openclaw.arn\n"], [338, "\n"], [339, "  tags = {\n"], [340, "    Name = \"openclaw-flow-logs\"\n"], [341, "  }\n"], [342, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [334, 342], "resource": "aws_cloudwatch_log_group.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchLogGroupRetentionYear", "fixed_definition": null, "entity_tags": {"Name": "openclaw-flow-logs"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-338", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[345, "resource \"aws_iam_role\" \"flow_logs\" {\n"], [346, "  name = \"openclaw-flow-logs-role\"\n"], [347, "\n"], [348, "  assume_role_policy = jsonencode({\n"], [349, "    Version = \"2012-10-17\"\n"], [350, "    Statement = [\n"], [351, "      {\n"], [352, "        Action = \"sts:AssumeRole\"\n"], [353, "        Effect = \"Allow\"\n"], [354, "        Principal = {\n"], [355, "          Service = \"vpc-flow-logs.amazonaws.com\"\n"], [356, "        }\n"], [357, "      }\n"], [358, "    ]\n"], [359, "  })\n"], [360, "\n"], [361, "  tags = {\n"], [362, "    Name = \"openclaw-flow-logs-role\"\n"], [363, "  }\n"], [364, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [345, 364], "resource": "aws_iam_role.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Name": "openclaw-flow-logs-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[345, "resource \"aws_iam_role\" \"flow_logs\" {\n"], [346, "  name = \"openclaw-flow-logs-role\"\n"], [347, "\n"], [348, "  assume_role_policy = jsonencode({\n"], [349, "    Version = \"2012-10-17\"\n"], [350, "    Statement = [\n"], [351, "      {\n"], [352, "        Action = \"sts:AssumeRole\"\n"], [353, "        Effect = \"Allow\"\n"], [354, "        Principal = {\n"], [355, "          Service = \"vpc-flow-logs.amazonaws.com\"\n"], [356, "        }\n"], [357, "      }\n"], [358, "    ]\n"], [359, "  })\n"], [360, "\n"], [361, "  tags = {\n"], [362, "    Name = \"openclaw-flow-logs-role\"\n"], [363, "  }\n"], [364, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [345, 364], "resource": "aws_iam_role.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Name": "openclaw-flow-logs-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[345, "resource \"aws_iam_role\" \"flow_logs\" {\n"], [346, "  name = \"openclaw-flow-logs-role\"\n"], [347, "\n"], [348, "  assume_role_policy = jsonencode({\n"], [349, "    Version = \"2012-10-17\"\n"], [350, "    Statement = [\n"], [351, "      {\n"], [352, "        Action = \"sts:AssumeRole\"\n"], [353, "        Effect = \"Allow\"\n"], [354, "        Principal = {\n"], [355, "          Service = \"vpc-flow-logs.amazonaws.com\"\n"], [356, "        }\n"], [357, "      }\n"], [358, "    ]\n"], [359, "  })\n"], [360, "\n"], [361, "  tags = {\n"], [362, "    Name = \"openclaw-flow-logs-role\"\n"], [363, "  }\n"], [364, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [345, 364], "resource": "aws_iam_role.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Name": "openclaw-flow-logs-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_286", "bc_check_id": "BC_AWS_IAM_81", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[366, "resource \"aws_iam_role_policy\" \"flow_logs\" {\n"], [367, "  name = \"openclaw-flow-logs-policy\"\n"], [368, "  role = aws_iam_role.flow_logs.id\n"], [369, "\n"], [370, "  policy = jsonencode({\n"], [371, "    Version = \"2012-10-17\"\n"], [372, "    Statement = [\n"], [373, "      {\n"], [374, "        Effect = \"Allow\"\n"], [375, "        Action = [\n"], [376, "          \"logs:CreateLogStream\",\n"], [377, "          \"logs:PutLogEvents\",\n"], [378, "          \"logs:DescribeLogGroups\",\n"], [379, "          \"logs:DescribeLogStreams\"\n"], [380, "        ]\n"], [381, "        Resource = \"${aws_cloudwatch_log_group.flow_logs.arn}:*\"\n"], [382, "      }\n"], [383, "    ]\n"], [384, "  })\n"], [385, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [366, 385], "resource": "aws_iam_role_policy.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-286", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[366, "resource \"aws_iam_role_policy\" \"flow_logs\" {\n"], [367, "  name = \"openclaw-flow-logs-policy\"\n"], [368, "  role = aws_iam_role.flow_logs.id\n"], [369, "\n"], [370, "  policy = jsonencode({\n"], [371, "    Version = \"2012-10-17\"\n"], [372, "    Statement = [\n"], [373, "      {\n"], [374, "        Effect = \"Allow\"\n"], [375, "        Action = [\n"], [376, "          \"logs:CreateLogStream\",\n"], [377, "          \"logs:PutLogEvents\",\n"], [378, "          \"logs:DescribeLogGroups\",\n"], [379, "          \"logs:DescribeLogStreams\"\n"], [380, "        ]\n"], [381, "        Resource = \"${aws_cloudwatch_log_group.flow_logs.arn}:*\"\n"], [382, "      }\n"], [383, "    ]\n"], [384, "  })\n"], [385, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [366, 385], "resource": "aws_iam_role_policy.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[366, "resource \"aws_iam_role_policy\" \"flow_logs\" {\n"], [367, "  name = \"openclaw-flow-logs-policy\"\n"], [368, "  role = aws_iam_role.flow_logs.id\n"], [369, "\n"], [370, "  policy = jsonencode({\n"], [371, "    Version = \"2012-10-17\"\n"], [372, "    Statement = [\n"], [373, "      {\n"], [374, "        Effect = \"Allow\"\n"], [375, "        Action = [\n"], [376, "          \"logs:CreateLogStream\",\n"], [377, "          \"logs:PutLogEvents\",\n"], [378, "          \"logs:DescribeLogGroups\",\n"], [379, "          \"logs:DescribeLogStreams\"\n"], [380, "        ]\n"], [381, "        Resource = \"${aws_cloudwatch_log_group.flow_logs.arn}:*\"\n"], [382, "      }\n"], [383, "    ]\n"], [384, "  })\n"], [385, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [366, 385], "resource": "aws_iam_role_policy.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_289", "bc_check_id": "BC_AWS_IAM_84", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[366, "resource \"aws_iam_role_policy\" \"flow_logs\" {\n"], [367, "  name = \"openclaw-flow-logs-policy\"\n"], [368, "  role = aws_iam_role.flow_logs.id\n"], [369, "\n"], [370, "  policy = jsonencode({\n"], [371, "    Version = \"2012-10-17\"\n"], [372, "    Statement = [\n"], [373, "      {\n"], [374, "        Effect = \"Allow\"\n"], [375, "        Action = [\n"], [376, "          \"logs:CreateLogStream\",\n"], [377, "          \"logs:PutLogEvents\",\n"], [378, "          \"logs:DescribeLogGroups\",\n"], [379, "          \"logs:DescribeLogStreams\"\n"], [380, "        ]\n"], [381, "        Resource = \"${aws_cloudwatch_log_group.flow_logs.arn}:*\"\n"], [382, "      }\n"], [383, "    ]\n"], [384, "  })\n"], [385, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [366, 385], "resource": "aws_iam_role_policy.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-289", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_288", "bc_check_id": "BC_AWS_IAM_83", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[366, "resource \"aws_iam_role_policy\" \"flow_logs\" {\n"], [367, "  name = \"openclaw-flow-logs-policy\"\n"], [368, "  role = aws_iam_role.flow_logs.id\n"], [369, "\n"], [370, "  policy = jsonencode({\n"], [371, "    Version = \"2012-10-17\"\n"], [372, "    Statement = [\n"], [373, "      {\n"], [374, "        Effect = \"Allow\"\n"], [375, "        Action = [\n"], [376, "          \"logs:CreateLogStream\",\n"], [377, "          \"logs:PutLogEvents\",\n"], [378, "          \"logs:DescribeLogGroups\",\n"], [379, "          \"logs:DescribeLogStreams\"\n"], [380, "        ]\n"], [381, "        Resource = \"${aws_cloudwatch_log_group.flow_logs.arn}:*\"\n"], [382, "      }\n"], [383, "    ]\n"], [384, "  })\n"], [385, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [366, 385], "resource": "aws_iam_role_policy.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-288", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_355", "bc_check_id": "BC_AWS_IAM_88", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[366, "resource \"aws_iam_role_policy\" \"flow_logs\" {\n"], [367, "  name = \"openclaw-flow-logs-policy\"\n"], [368, "  role = aws_iam_role.flow_logs.id\n"], [369, "\n"], [370, "  policy = jsonencode({\n"], [371, "    Version = \"2012-10-17\"\n"], [372, "    Statement = [\n"], [373, "      {\n"], [374, "        Effect = \"Allow\"\n"], [375, "        Action = [\n"], [376, "          \"logs:CreateLogStream\",\n"], [377, "          \"logs:PutLogEvents\",\n"], [378, "          \"logs:DescribeLogGroups\",\n"], [379, "          \"logs:DescribeLogStreams\"\n"], [380, "        ]\n"], [381, "        Resource = \"${aws_cloudwatch_log_group.flow_logs.arn}:*\"\n"], [382, "      }\n"], [383, "    ]\n"], [384, "  })\n"], [385, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [366, 385], "resource": "aws_iam_role_policy.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_287", "bc_check_id": "BC_AWS_IAM_82", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[366, "resource \"aws_iam_role_policy\" \"flow_logs\" {\n"], [367, "  name = \"openclaw-flow-logs-policy\"\n"], [368, "  role = aws_iam_role.flow_logs.id\n"], [369, "\n"], [370, "  policy = jsonencode({\n"], [371, "    Version = \"2012-10-17\"\n"], [372, "    Statement = [\n"], [373, "      {\n"], [374, "        Effect = \"Allow\"\n"], [375, "        Action = [\n"], [376, "          \"logs:CreateLogStream\",\n"], [377, "          \"logs:PutLogEvents\",\n"], [378, "          \"logs:DescribeLogGroups\",\n"], [379, "          \"logs:DescribeLogStreams\"\n"], [380, "        ]\n"], [381, "        Resource = \"${aws_cloudwatch_log_group.flow_logs.arn}:*\"\n"], [382, "      }\n"], [383, "    ]\n"], [384, "  })\n"], [385, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [366, 385], "resource": "aws_iam_role_policy.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-287", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_290", "bc_check_id": "BC_AWS_IAM_85", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[366, "resource \"aws_iam_role_policy\" \"flow_logs\" {\n"], [367, "  name = \"openclaw-flow-logs-policy\"\n"], [368, "  role = aws_iam_role.flow_logs.id\n"], [369, "\n"], [370, "  policy = jsonencode({\n"], [371, "    Version = \"2012-10-17\"\n"], [372, "    Statement = [\n"], [373, "      {\n"], [374, "        Effect = \"Allow\"\n"], [375, "        Action = [\n"], [376, "          \"logs:CreateLogStream\",\n"], [377, "          \"logs:PutLogEvents\",\n"], [378, "          \"logs:DescribeLogGroups\",\n"], [379, "          \"logs:DescribeLogStreams\"\n"], [380, "        ]\n"], [381, "        Resource = \"${aws_cloudwatch_log_group.flow_logs.arn}:*\"\n"], [382, "      }\n"], [383, "    ]\n"], [384, "  })\n"], [385, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [366, 385], "resource": "aws_iam_role_policy.flow_logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_238", "bc_check_id": "BC_AWS_GENERAL_146", "check_name": "Ensure that GuardDuty detector is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable"]}, "code_block": [[43, "resource \"aws_guardduty_detector\" \"main\" {\n"], [44, "  enable = true\n"], [45, "\n"], [46, "  # S3 protection (if you add S3 later)\n"], [47, "  datasources {\n"], [48, "    s3_logs {\n"], [49, "      enable = true\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  tags = {\n"], [54, "    Name = \"openclaw-guardduty\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/monitoring.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf", "repo_file_path": "/monitoring.tf", "file_line_range": [43, 56], "resource": "aws_guardduty_detector.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.GuarddutyDetectorEnabled", "fixed_definition": null, "entity_tags": {"Name": "openclaw-guardduty"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-guardduty-detector-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf"}, {"check_id": "CKV_AWS_26", "bc_check_id": "BC_AWS_GENERAL_15", "check_name": "Ensure all data stored in the SNS topic is encrypted", "check_result": {"result": "PASSED", "evaluated_keys": ["kms_master_key_id"]}, "code_block": [[63, "resource \"aws_sns_topic\" \"alerts\" {\n"], [64, "  name              = \"openclaw-security-alerts\"\n"], [65, "  kms_master_key_id = aws_kms_key.openclaw.id\n"], [66, "\n"], [67, "  tags = {\n"], [68, "    Name = \"openclaw-alerts\"\n"], [69, "  }\n"], [70, "}\n"]], "file_path": "/monitoring.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf", "repo_file_path": "/monitoring.tf", "file_line_range": [63, 70], "resource": "aws_sns_topic.alerts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSTopicEncryption", "fixed_definition": null, "entity_tags": {"Name": "openclaw-alerts"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf"}, {"check_id": "CKV_AWS_319", "bc_check_id": "BC_AWS_GENERAL_229", "check_name": "Ensure that CloudWatch alarm actions are enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["actions_enabled"]}, "code_block": [[85, "resource \"aws_cloudwatch_metric_alarm\" \"high_cpu\" {\n"], [86, "  alarm_name          = \"openclaw-high-cpu\"\n"], [87, "  comparison_operator = \"GreaterThanThreshold\"\n"], [88, "  evaluation_periods  = 2\n"], [89, "  metric_name         = \"CPUUtilization\"\n"], [90, "  namespace           = \"AWS/EC2\"\n"], [91, "  period              = 300 # 5 minutes\n"], [92, "  statistic           = \"Average\"\n"], [93, "  threshold           = 80\n"], [94, "  alarm_description   = \"CPU utilization above 80% for 10 minutes\"\n"], [95, "  alarm_actions       = [aws_sns_topic.alerts.arn]\n"], [96, "\n"], [97, "  dimensions = {\n"], [98, "    InstanceId = aws_instance.openclaw.id\n"], [99, "  }\n"], [100, "\n"], [101, "  tags = {\n"], [102, "    Name = \"openclaw-high-cpu-alarm\"\n"], [103, "  }\n"], [104, "}\n"]], "file_path": "/monitoring.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf", "repo_file_path": "/monitoring.tf", "file_line_range": [85, 104], "resource": "aws_cloudwatch_metric_alarm.high_cpu", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchAlarmsEnabled", "fixed_definition": null, "entity_tags": {"Name": "openclaw-high-cpu-alarm"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-319", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf"}, {"check_id": "CKV_AWS_319", "bc_check_id": "BC_AWS_GENERAL_229", "check_name": "Ensure that CloudWatch alarm actions are enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["actions_enabled"]}, "code_block": [[107, "resource \"aws_cloudwatch_metric_alarm\" \"high_network_out\" {\n"], [108, "  alarm_name          = \"openclaw-high-network-out\"\n"], [109, "  comparison_operator = \"GreaterThanThreshold\"\n"], [110, "  evaluation_periods  = 2\n"], [111, "  metric_name         = \"NetworkOut\"\n"], [112, "  namespace           = \"AWS/EC2\"\n"], [113, "  period              = 300\n"], [114, "  statistic           = \"Sum\"\n"], [115, "  threshold           = 1000000000 # 1 GB in 5 minutes\n"], [116, "  alarm_description   = \"Unusual outbound network traffic (possible exfiltration)\"\n"], [117, "  alarm_actions       = [aws_sns_topic.alerts.arn]\n"], [118, "\n"], [119, "  dimensions = {\n"], [120, "    InstanceId = aws_instance.openclaw.id\n"], [121, "  }\n"], [122, "\n"], [123, "  tags = {\n"], [124, "    Name = \"openclaw-high-network-alarm\"\n"], [125, "  }\n"], [126, "}\n"]], "file_path": "/monitoring.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf", "repo_file_path": "/monitoring.tf", "file_line_range": [107, 126], "resource": "aws_cloudwatch_metric_alarm.high_network_out", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchAlarmsEnabled", "fixed_definition": null, "entity_tags": {"Name": "openclaw-high-network-alarm"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-319", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf"}, {"check_id": "CKV_AWS_319", "bc_check_id": "BC_AWS_GENERAL_229", "check_name": "Ensure that CloudWatch alarm actions are enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["actions_enabled"]}, "code_block": [[129, "resource \"aws_cloudwatch_metric_alarm\" \"status_check\" {\n"], [130, "  alarm_name          = \"openclaw-status-check-failed\"\n"], [131, "  comparison_operator = \"GreaterThanThreshold\"\n"], [132, "  evaluation_periods  = 2\n"], [133, "  metric_name         = \"StatusCheckFailed\"\n"], [134, "  namespace           = \"AWS/EC2\"\n"], [135, "  period              = 60\n"], [136, "  statistic           = \"Maximum\"\n"], [137, "  threshold           = 0\n"], [138, "  alarm_description   = \"EC2 instance status check failed\"\n"], [139, "  alarm_actions       = [aws_sns_topic.alerts.arn]\n"], [140, "\n"], [141, "  dimensions = {\n"], [142, "    InstanceId = aws_instance.openclaw.id\n"], [143, "  }\n"], [144, "\n"], [145, "  tags = {\n"], [146, "    Name = \"openclaw-status-alarm\"\n"], [147, "  }\n"], [148, "}\n"]], "file_path": "/monitoring.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf", "repo_file_path": "/monitoring.tf", "file_line_range": [129, 148], "resource": "aws_cloudwatch_metric_alarm.status_check", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudWatchAlarmsEnabled", "fixed_definition": null, "entity_tags": {"Name": "openclaw-status-alarm"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-319", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf"}, {"check_id": "CKV_AWS_385", "bc_check_id": null, "check_name": "Ensure AWS SNS topic policies do not allow cross-account access", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[176, "resource \"aws_sns_topic_policy\" \"alerts\" {\n"], [177, "  arn = aws_sns_topic.alerts.arn\n"], [178, "\n"], [179, "  policy = jsonencode({\n"], [180, "    Version = \"2012-10-17\"\n"], [181, "    Statement = [\n"], [182, "      {\n"], [183, "        Sid    = \"AllowEventBridge\"\n"], [184, "        Effect = \"Allow\"\n"], [185, "        Principal = {\n"], [186, "          Service = \"events.amazonaws.com\"\n"], [187, "        }\n"], [188, "        Action   = \"sns:Publish\"\n"], [189, "        Resource = aws_sns_topic.alerts.arn\n"], [190, "      }\n"], [191, "    ]\n"], [192, "  })\n"], [193, "}\n"]], "file_path": "/monitoring.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf", "repo_file_path": "/monitoring.tf", "file_line_range": [176, 193], "resource": "aws_sns_topic_policy.alerts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSCrossAccountAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf"}, {"check_id": "CKV_AWS_169", "bc_check_id": "BC_AWS_GENERAL_92", "check_name": "Ensure SNS topic policy is not public by only allowing specific services or principals to access it", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[176, "resource \"aws_sns_topic_policy\" \"alerts\" {\n"], [177, "  arn = aws_sns_topic.alerts.arn\n"], [178, "\n"], [179, "  policy = jsonencode({\n"], [180, "    Version = \"2012-10-17\"\n"], [181, "    Statement = [\n"], [182, "      {\n"], [183, "        Sid    = \"AllowEventBridge\"\n"], [184, "        Effect = \"Allow\"\n"], [185, "        Principal = {\n"], [186, "          Service = \"events.amazonaws.com\"\n"], [187, "        }\n"], [188, "        Action   = \"sns:Publish\"\n"], [189, "        Resource = aws_sns_topic.alerts.arn\n"], [190, "      }\n"], [191, "    ]\n"], [192, "  })\n"], [193, "}\n"]], "file_path": "/monitoring.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf", "repo_file_path": "/monitoring.tf", "file_line_range": [176, 193], "resource": "aws_sns_topic_policy.alerts", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SNSTopicPolicyAnyPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-sns-topic-policy-is-not-public-by-only-allowing-specific-services-or-principals-to-access-it", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf"}, {"check_id": "CKV_AWS_227", "bc_check_id": "BC_AWS_GENERAL_122", "check_name": "Ensure KMS key is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["is_enabled"]}, "code_block": [[27, "resource \"aws_kms_key\" \"openclaw\" {\n"], [28, "  description             = \"KMS key for OpenClaw encryption\"\n"], [29, "  deletion_window_in_days = 7\n"], [30, "  enable_key_rotation     = true\n"], [31, "\n"], [32, "  policy = jsonencode({\n"], [33, "    Version = \"2012-10-17\"\n"], [34, "    Statement = [\n"], [35, "      {\n"], [36, "        Sid    = \"Enable IAM User Permissions\"\n"], [37, "        Effect = \"Allow\"\n"], [38, "        Principal = {\n"], [39, "          AWS = \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"\n"], [40, "        }\n"], [41, "        Action   = \"kms:*\"\n"], [42, "        Resource = \"*\"\n"], [43, "      },\n"], [44, "      {\n"], [45, "        Sid    = \"Allow CloudWatch Logs\"\n"], [46, "        Effect = \"Allow\"\n"], [47, "        Principal = {\n"], [48, "          Service = \"logs.${var.aws_region}.amazonaws.com\"\n"], [49, "        }\n"], [50, "        Action = [\n"], [51, "          \"kms:Encrypt*\",\n"], [52, "          \"kms:Decrypt*\",\n"], [53, "          \"kms:ReEncrypt*\",\n"], [54, "          \"kms:GenerateDataKey*\",\n"], [55, "          \"kms:Describe*\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          ArnLike = {\n"], [60, "            \"kms:EncryptionContext:aws:logs:arn\" = \"arn:aws:logs:${var.aws_region}:${data.aws_caller_identity.current.account_id}:*\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"Allow SNS\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Principal = {\n"], [68, "          Service = \"sns.amazonaws.com\"\n"], [69, "        }\n"], [70, "        Action = [\n"], [71, "          \"kms:GenerateDataKey*\",\n"], [72, "          \"kms:Decrypt\"\n"], [73, "        ]\n"], [74, "        Resource = \"*\"\n"], [75, "      }\n"], [76, "    ]\n"], [77, "  })\n"], [78, "\n"], [79, "  tags = {\n"], [80, "    Name = \"openclaw-kms-key\"\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "/secrets.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/secrets.tf", "repo_file_path": "/secrets.tf", "file_line_range": [27, 82], "resource": "aws_kms_key.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyIsEnabled", "fixed_definition": null, "entity_tags": {"Name": "openclaw-kms-key"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-key-management-service-kms-key-is-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/secrets.tf", "breadcrumbs": {"policy": [{"type": "variable", "name": "aws_region", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_33", "bc_check_id": "BC_AWS_IAM_63", "check_name": "Ensure KMS key policy does not contain wildcard (*) principal", "check_result": {"result": "PASSED", "evaluated_keys": ["policy/[0]/Statement"]}, "code_block": [[27, "resource \"aws_kms_key\" \"openclaw\" {\n"], [28, "  description             = \"KMS key for OpenClaw encryption\"\n"], [29, "  deletion_window_in_days = 7\n"], [30, "  enable_key_rotation     = true\n"], [31, "\n"], [32, "  policy = jsonencode({\n"], [33, "    Version = \"2012-10-17\"\n"], [34, "    Statement = [\n"], [35, "      {\n"], [36, "        Sid    = \"Enable IAM User Permissions\"\n"], [37, "        Effect = \"Allow\"\n"], [38, "        Principal = {\n"], [39, "          AWS = \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"\n"], [40, "        }\n"], [41, "        Action   = \"kms:*\"\n"], [42, "        Resource = \"*\"\n"], [43, "      },\n"], [44, "      {\n"], [45, "        Sid    = \"Allow CloudWatch Logs\"\n"], [46, "        Effect = \"Allow\"\n"], [47, "        Principal = {\n"], [48, "          Service = \"logs.${var.aws_region}.amazonaws.com\"\n"], [49, "        }\n"], [50, "        Action = [\n"], [51, "          \"kms:Encrypt*\",\n"], [52, "          \"kms:Decrypt*\",\n"], [53, "          \"kms:ReEncrypt*\",\n"], [54, "          \"kms:GenerateDataKey*\",\n"], [55, "          \"kms:Describe*\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          ArnLike = {\n"], [60, "            \"kms:EncryptionContext:aws:logs:arn\" = \"arn:aws:logs:${var.aws_region}:${data.aws_caller_identity.current.account_id}:*\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"Allow SNS\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Principal = {\n"], [68, "          Service = \"sns.amazonaws.com\"\n"], [69, "        }\n"], [70, "        Action = [\n"], [71, "          \"kms:GenerateDataKey*\",\n"], [72, "          \"kms:Decrypt\"\n"], [73, "        ]\n"], [74, "        Resource = \"*\"\n"], [75, "      }\n"], [76, "    ]\n"], [77, "  })\n"], [78, "\n"], [79, "  tags = {\n"], [80, "    Name = \"openclaw-kms-key\"\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "/secrets.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/secrets.tf", "repo_file_path": "/secrets.tf", "file_line_range": [27, 82], "resource": "aws_kms_key.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyWildcardPrincipal", "fixed_definition": null, "entity_tags": {"Name": "openclaw-kms-key"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-kms-key-policy-does-not-contain-wildcard-principal", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/secrets.tf", "breadcrumbs": {"policy": [{"type": "variable", "name": "aws_region", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_7", "bc_check_id": "BC_AWS_LOGGING_8", "check_name": "Ensure rotation for customer created CMKs is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_key_rotation"]}, "code_block": [[27, "resource \"aws_kms_key\" \"openclaw\" {\n"], [28, "  description             = \"KMS key for OpenClaw encryption\"\n"], [29, "  deletion_window_in_days = 7\n"], [30, "  enable_key_rotation     = true\n"], [31, "\n"], [32, "  policy = jsonencode({\n"], [33, "    Version = \"2012-10-17\"\n"], [34, "    Statement = [\n"], [35, "      {\n"], [36, "        Sid    = \"Enable IAM User Permissions\"\n"], [37, "        Effect = \"Allow\"\n"], [38, "        Principal = {\n"], [39, "          AWS = \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"\n"], [40, "        }\n"], [41, "        Action   = \"kms:*\"\n"], [42, "        Resource = \"*\"\n"], [43, "      },\n"], [44, "      {\n"], [45, "        Sid    = \"Allow CloudWatch Logs\"\n"], [46, "        Effect = \"Allow\"\n"], [47, "        Principal = {\n"], [48, "          Service = \"logs.${var.aws_region}.amazonaws.com\"\n"], [49, "        }\n"], [50, "        Action = [\n"], [51, "          \"kms:Encrypt*\",\n"], [52, "          \"kms:Decrypt*\",\n"], [53, "          \"kms:ReEncrypt*\",\n"], [54, "          \"kms:GenerateDataKey*\",\n"], [55, "          \"kms:Describe*\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          ArnLike = {\n"], [60, "            \"kms:EncryptionContext:aws:logs:arn\" = \"arn:aws:logs:${var.aws_region}:${data.aws_caller_identity.current.account_id}:*\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"Allow SNS\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Principal = {\n"], [68, "          Service = \"sns.amazonaws.com\"\n"], [69, "        }\n"], [70, "        Action = [\n"], [71, "          \"kms:GenerateDataKey*\",\n"], [72, "          \"kms:Decrypt\"\n"], [73, "        ]\n"], [74, "        Resource = \"*\"\n"], [75, "      }\n"], [76, "    ]\n"], [77, "  })\n"], [78, "\n"], [79, "  tags = {\n"], [80, "    Name = \"openclaw-kms-key\"\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "/secrets.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/secrets.tf", "repo_file_path": "/secrets.tf", "file_line_range": [27, 82], "resource": "aws_kms_key.openclaw", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSRotation", "fixed_definition": null, "entity_tags": {"Name": "openclaw-kms-key"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-8", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/secrets.tf", "breadcrumbs": {"policy": [{"type": "variable", "name": "aws_region", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_149", "bc_check_id": "BC_AWS_GENERAL_79", "check_name": "Ensure that Secrets Manager secret is encrypted using KMS CMK", "check_result": {"result": "PASSED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[95, "resource \"aws_secretsmanager_secret\" \"api_keys\" {\n"], [96, "  name        = \"openclaw/api-keys\"\n"], [97, "  description = \"API keys for OpenClaw (Anthropic, OpenAI)\"\n"], [98, "  kms_key_id  = aws_kms_key.openclaw.arn\n"], [99, "\n"], [100, "  # Recovery window - how long you can recover a deleted secret\n"], [101, "  # Set to 7 days minimum (can't set to 0 for safety)\n"], [102, "  recovery_window_in_days = 7\n"], [103, "\n"], [104, "  tags = {\n"], [105, "    Name = \"openclaw-api-keys\"\n"], [106, "  }\n"], [107, "}\n"]], "file_path": "/secrets.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/secrets.tf", "repo_file_path": "/secrets.tf", "file_line_range": [95, 107], "resource": "aws_secretsmanager_secret.api_keys", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecretManagerSecretEncrypted", "fixed_definition": null, "entity_tags": {"Name": "openclaw-api-keys"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-secrets-manager-secret-is-encrypted-using-kms", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/secrets.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[130, "resource \"aws_iam_role\" \"ssm_maintenance\" {\n"], [131, "  name = \"openclaw-ssm-maintenance-role\"\n"], [132, "\n"], [133, "  assume_role_policy = jsonencode({\n"], [134, "    Version = \"2012-10-17\"\n"], [135, "    Statement = [\n"], [136, "      {\n"], [137, "        Action = \"sts:AssumeRole\"\n"], [138, "        Effect = \"Allow\"\n"], [139, "        Principal = {\n"], [140, "          Service = \"ssm.amazonaws.com\"\n"], [141, "        }\n"], [142, "      }\n"], [143, "    ]\n"], [144, "  })\n"], [145, "\n"], [146, "  tags = {\n"], [147, "    Name = \"openclaw-ssm-maintenance-role\"\n"], [148, "  }\n"], [149, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [130, 149], "resource": "aws_iam_role.ssm_maintenance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ssm-maintenance-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[130, "resource \"aws_iam_role\" \"ssm_maintenance\" {\n"], [131, "  name = \"openclaw-ssm-maintenance-role\"\n"], [132, "\n"], [133, "  assume_role_policy = jsonencode({\n"], [134, "    Version = \"2012-10-17\"\n"], [135, "    Statement = [\n"], [136, "      {\n"], [137, "        Action = \"sts:AssumeRole\"\n"], [138, "        Effect = \"Allow\"\n"], [139, "        Principal = {\n"], [140, "          Service = \"ssm.amazonaws.com\"\n"], [141, "        }\n"], [142, "      }\n"], [143, "    ]\n"], [144, "  })\n"], [145, "\n"], [146, "  tags = {\n"], [147, "    Name = \"openclaw-ssm-maintenance-role\"\n"], [148, "  }\n"], [149, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [130, 149], "resource": "aws_iam_role.ssm_maintenance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ssm-maintenance-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[130, "resource \"aws_iam_role\" \"ssm_maintenance\" {\n"], [131, "  name = \"openclaw-ssm-maintenance-role\"\n"], [132, "\n"], [133, "  assume_role_policy = jsonencode({\n"], [134, "    Version = \"2012-10-17\"\n"], [135, "    Statement = [\n"], [136, "      {\n"], [137, "        Action = \"sts:AssumeRole\"\n"], [138, "        Effect = \"Allow\"\n"], [139, "        Principal = {\n"], [140, "          Service = \"ssm.amazonaws.com\"\n"], [141, "        }\n"], [142, "      }\n"], [143, "    ]\n"], [144, "  })\n"], [145, "\n"], [146, "  tags = {\n"], [147, "    Name = \"openclaw-ssm-maintenance-role\"\n"], [148, "  }\n"], [149, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [130, 149], "resource": "aws_iam_role.ssm_maintenance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ssm-maintenance-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV_AWS_274", "bc_check_id": "BC_AWS_IAM_78", "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[151, "resource \"aws_iam_role_policy_attachment\" \"ssm_maintenance\" {\n"], [152, "  role       = aws_iam_role.ssm_maintenance.name\n"], [153, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonSSMMaintenanceWindowRole\"\n"], [154, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [151, 154], "resource": "aws_iam_role_policy_attachment.ssm_maintenance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-274", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.ssm_maintenance", "path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[171, "resource \"aws_s3_bucket\" \"compliance\" {\n"], [172, "  bucket_prefix = \"openclaw-compliance-\"\n"], [173, "  force_destroy = true # Allow deletion in dev\n"], [174, "\n"], [175, "  tags = {\n"], [176, "    Name = \"openclaw-compliance-bucket\"\n"], [177, "  }\n"], [178, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [171, 178], "resource": "aws_s3_bucket.compliance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Name": "openclaw-compliance-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-24", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV_AWS_55", "bc_check_id": "BC_AWS_S3_21", "check_name": "Ensure S3 bucket has ignore public ACLs enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["ignore_public_acls"]}, "code_block": [[190, "resource \"aws_s3_bucket_public_access_block\" \"compliance\" {\n"], [191, "  bucket = aws_s3_bucket.compliance.id\n"], [192, "\n"], [193, "  block_public_acls       = true\n"], [194, "  block_public_policy     = true\n"], [195, "  ignore_public_acls      = true\n"], [196, "  restrict_public_buckets = true\n"], [197, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [190, 197], "resource": "aws_s3_bucket_public_access_block.compliance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3IgnorePublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-21", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV_AWS_53", "bc_check_id": "BC_AWS_S3_19", "check_name": "Ensure S3 bucket has block public ACLS enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_acls"]}, "code_block": [[190, "resource \"aws_s3_bucket_public_access_block\" \"compliance\" {\n"], [191, "  bucket = aws_s3_bucket.compliance.id\n"], [192, "\n"], [193, "  block_public_acls       = true\n"], [194, "  block_public_policy     = true\n"], [195, "  ignore_public_acls      = true\n"], [196, "  restrict_public_buckets = true\n"], [197, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [190, 197], "resource": "aws_s3_bucket_public_access_block.compliance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicACLs", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-19", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV_AWS_56", "bc_check_id": "BC_AWS_S3_22", "check_name": "Ensure S3 bucket has 'restrict_public_buckets' enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["restrict_public_buckets"]}, "code_block": [[190, "resource \"aws_s3_bucket_public_access_block\" \"compliance\" {\n"], [191, "  bucket = aws_s3_bucket.compliance.id\n"], [192, "\n"], [193, "  block_public_acls       = true\n"], [194, "  block_public_policy     = true\n"], [195, "  ignore_public_acls      = true\n"], [196, "  restrict_public_buckets = true\n"], [197, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [190, 197], "resource": "aws_s3_bucket_public_access_block.compliance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3RestrictPublicBuckets", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-22", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV_AWS_54", "bc_check_id": "BC_AWS_S3_20", "check_name": "Ensure S3 bucket has block public policy enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["block_public_policy"]}, "code_block": [[190, "resource \"aws_s3_bucket_public_access_block\" \"compliance\" {\n"], [191, "  bucket = aws_s3_bucket.compliance.id\n"], [192, "\n"], [193, "  block_public_acls       = true\n"], [194, "  block_public_policy     = true\n"], [195, "  ignore_public_acls      = true\n"], [196, "  restrict_public_buckets = true\n"], [197, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [190, 197], "resource": "aws_s3_bucket_public_access_block.compliance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BlockPublicPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/bc-aws-s3-20", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV2_AWS_64", "bc_check_id": "BC_AWS_IAM_76", "check_name": "Ensure KMS key Policy is defined", "check_result": {"result": "PASSED", "entity": {"aws_kms_key": {"openclaw": {"__end_line__": 82, "__start_line__": 27, "deletion_window_in_days": [7], "description": ["KMS key for OpenClaw encryption"], "enable_key_rotation": [true], "policy": [{"Version": "2012-10-17", "Statement": [{"Sid": "Enable IAM User Permissions", "Effect": "Allow", "Principal": {"AWS": "arn:aws:iam::data.aws_caller_identity.current.account_id:root"}, "Action": "kms:*", "Resource": "*"}, {"Sid": "Allow CloudWatch Logs", "Effect": "Allow", "Principal": {"Service": "logs.us-east-1.amazonaws.com"}, "Action": ["kms:Encrypt*", "kms:Decrypt*", "kms:ReEncrypt*", "kms:GenerateDataKey*", "kms:Describe*"], "Resource": "*", "Condition": {"ArnLike": {"kms:EncryptionContext:aws:logs:arn": "arn:aws:logs:us-east-1:data.aws_caller_identity.current.account_id:*"}}}, {"Sid": "Allow SNS", "Effect": "Allow", "Principal": {"Service": "sns.amazonaws.com"}, "Action": ["kms:GenerateDataKey*", "kms:Decrypt"], "Resource": "*"}]}], "tags": [{"Name": "openclaw-kms-key"}], "__address__": "aws_kms_key.openclaw"}}}, "evaluated_keys": ["policy", "resource_type"]}, "code_block": [[27, "resource \"aws_kms_key\" \"openclaw\" {\n"], [28, "  description             = \"KMS key for OpenClaw encryption\"\n"], [29, "  deletion_window_in_days = 7\n"], [30, "  enable_key_rotation     = true\n"], [31, "\n"], [32, "  policy = jsonencode({\n"], [33, "    Version = \"2012-10-17\"\n"], [34, "    Statement = [\n"], [35, "      {\n"], [36, "        Sid    = \"Enable IAM User Permissions\"\n"], [37, "        Effect = \"Allow\"\n"], [38, "        Principal = {\n"], [39, "          AWS = \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"\n"], [40, "        }\n"], [41, "        Action   = \"kms:*\"\n"], [42, "        Resource = \"*\"\n"], [43, "      },\n"], [44, "      {\n"], [45, "        Sid    = \"Allow CloudWatch Logs\"\n"], [46, "        Effect = \"Allow\"\n"], [47, "        Principal = {\n"], [48, "          Service = \"logs.${var.aws_region}.amazonaws.com\"\n"], [49, "        }\n"], [50, "        Action = [\n"], [51, "          \"kms:Encrypt*\",\n"], [52, "          \"kms:Decrypt*\",\n"], [53, "          \"kms:ReEncrypt*\",\n"], [54, "          \"kms:GenerateDataKey*\",\n"], [55, "          \"kms:Describe*\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          ArnLike = {\n"], [60, "            \"kms:EncryptionContext:aws:logs:arn\" = \"arn:aws:logs:${var.aws_region}:${data.aws_caller_identity.current.account_id}:*\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"Allow SNS\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Principal = {\n"], [68, "          Service = \"sns.amazonaws.com\"\n"], [69, "        }\n"], [70, "        Action = [\n"], [71, "          \"kms:GenerateDataKey*\",\n"], [72, "          \"kms:Decrypt\"\n"], [73, "        ]\n"], [74, "        Resource = \"*\"\n"], [75, "      }\n"], [76, "    ]\n"], [77, "  })\n"], [78, "\n"], [79, "  tags = {\n"], [80, "    Name = \"openclaw-kms-key\"\n"], [81, "  }\n"], [82, "}\n"]], "file_path": "/secrets.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/secrets.tf", "repo_file_path": "/secrets.tf", "file_line_range": [27, 82], "resource": "aws_kms_key.openclaw", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-kms-key"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-64", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/secrets.tf", "breadcrumbs": {"policy": [{"type": "variable", "name": "aws_region", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_75", "bc_check_id": "BC_AWS_NETWORKING_105", "check_name": "Ensure no open CORS policy", "check_result": {"result": "PASSED", "entity": {"aws_lambda_function": {"docker_cleanup": {"__end_line__": 124, "__start_line__": 101, "environment": [{"variables": [{"INSTANCE_ID": "aws_instance.openclaw.id"}]}], "filename": ["${path.module}/lambda/docker_cleanup.zip"], "function_name": ["openclaw-docker-cleanup"], "handler": ["index.handler"], "reserved_concurrent_executions": [1], "role": ["aws_iam_role.janitor_lambda.arn"], "runtime": ["python3.11"], "source_code_hash": ["data.archive_file.docker_cleanup.output_base64sha256"], "tags": [{"Name": "openclaw-docker-cleanup"}], "timeout": [300], "tracing_config": [{"mode": ["Active"]}], "__address__": "aws_lambda_function.docker_cleanup"}}}, "evaluated_keys": ["cors/allow_origins", "cors/allow_methods", "resource_type"]}, "code_block": [[101, "resource \"aws_lambda_function\" \"docker_cleanup\" {\n"], [102, "  filename                       = data.archive_file.docker_cleanup.output_path\n"], [103, "  function_name                  = \"openclaw-docker-cleanup\"\n"], [104, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [105, "  handler                        = \"index.handler\"\n"], [106, "  source_code_hash               = data.archive_file.docker_cleanup.output_base64sha256\n"], [107, "  runtime                        = \"python3.11\"\n"], [108, "  timeout                        = 300\n"], [109, "  reserved_concurrent_executions = 1\n"], [110, "\n"], [111, "  tracing_config {\n"], [112, "    mode = \"Active\"\n"], [113, "  }\n"], [114, "\n"], [115, "  environment {\n"], [116, "    variables = {\n"], [117, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [118, "    }\n"], [119, "  }\n"], [120, "\n"], [121, "  tags = {\n"], [122, "    Name = \"openclaw-docker-cleanup\"\n"], [123, "  }\n"], [124, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [101, 124], "resource": "aws_lambda_function.docker_cleanup", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-docker-cleanup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-75", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.docker_cleanup", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_75", "bc_check_id": "BC_AWS_NETWORKING_105", "check_name": "Ensure no open CORS policy", "check_result": {"result": "PASSED", "entity": {"aws_lambda_function": {"patch_check": {"__end_line__": 238, "__start_line__": 214, "environment": [{"variables": [{"INSTANCE_ID": "aws_instance.openclaw.id", "SNS_TOPIC": "aws_sns_topic.alerts.arn"}]}], "filename": ["${path.module}/lambda/patch_check.zip"], "function_name": ["openclaw-patch-check"], "handler": ["index.handler"], "reserved_concurrent_executions": [1], "role": ["aws_iam_role.janitor_lambda.arn"], "runtime": ["python3.11"], "source_code_hash": ["data.archive_file.patch_check.output_base64sha256"], "tags": [{"Name": "openclaw-patch-check"}], "timeout": [300], "tracing_config": [{"mode": ["Active"]}], "__address__": "aws_lambda_function.patch_check"}}}, "evaluated_keys": ["cors/allow_origins", "cors/allow_methods", "resource_type"]}, "code_block": [[214, "resource \"aws_lambda_function\" \"patch_check\" {\n"], [215, "  filename                       = data.archive_file.patch_check.output_path\n"], [216, "  function_name                  = \"openclaw-patch-check\"\n"], [217, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [218, "  handler                        = \"index.handler\"\n"], [219, "  source_code_hash               = data.archive_file.patch_check.output_base64sha256\n"], [220, "  runtime                        = \"python3.11\"\n"], [221, "  timeout                        = 300\n"], [222, "  reserved_concurrent_executions = 1\n"], [223, "\n"], [224, "  tracing_config {\n"], [225, "    mode = \"Active\"\n"], [226, "  }\n"], [227, "\n"], [228, "  environment {\n"], [229, "    variables = {\n"], [230, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [231, "      SNS_TOPIC   = aws_sns_topic.alerts.arn\n"], [232, "    }\n"], [233, "  }\n"], [234, "\n"], [235, "  tags = {\n"], [236, "    Name = \"openclaw-patch-check\"\n"], [237, "  }\n"], [238, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [214, 238], "resource": "aws_lambda_function.patch_check", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-patch-check"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-75", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.patch_check", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_41", "bc_check_id": "BC_AWS_IAM_69", "check_name": "Ensure an IAM role is attached to EC2 instance", "check_result": {"result": "PASSED", "entity": {"aws_instance": {"openclaw": {"__end_line__": 162, "__start_line__": 93, "ami": ["data.aws_ami.ubuntu.id"], "associate_public_ip_address": [false], "depends_on": [["aws_iam_role_policy_attachment.openclaw_secrets", "aws_iam_role_policy_attachment.openclaw_ssm"]], "ebs_optimized": [true], "iam_instance_profile": ["openclaw-instance-profile"], "instance_type": ["t3.small"], "metadata_options": [{"http_endpoint": ["enabled"], "http_put_response_hop_limit": [1], "http_tokens": ["required"]}], "monitoring": [true], "root_block_device": [{"delete_on_termination": [true], "encrypted": [true], "tags": [{"Name": "openclaw-root-volume"}], "volume_size": [30], "volume_type": ["gp3"]}], "subnet_id": ["aws_subnet.private_a.id"], "tags": [{"Name": "openclaw-instance"}], "user_data": [null], "vpc_security_group_ids": [["aws_security_group.openclaw.id"]], "__address__": "aws_instance.openclaw"}}}, "evaluated_keys": ["iam_instance_profile"]}, "code_block": [[93, "resource \"aws_instance\" \"openclaw\" {\n"], [94, "  ami                    = data.aws_ami.ubuntu.id\n"], [95, "  instance_type          = var.instance_type\n"], [96, "  subnet_id              = aws_subnet.private_a.id\n"], [97, "  vpc_security_group_ids = [aws_security_group.openclaw.id]\n"], [98, "  iam_instance_profile   = aws_iam_instance_profile.openclaw.name\n"], [99, "  ebs_optimized          = true\n"], [100, "\n"], [101, "  # No public IP - private subnet only\n"], [102, "  associate_public_ip_address = false\n"], [103, "\n"], [104, "  # Encrypted root volume\n"], [105, "  root_block_device {\n"], [106, "    volume_size           = 30 # GB - enough for Docker images\n"], [107, "    volume_type           = \"gp3\"\n"], [108, "    encrypted             = true\n"], [109, "    delete_on_termination = true\n"], [110, "\n"], [111, "    tags = {\n"], [112, "      Name = \"openclaw-root-volume\"\n"], [113, "    }\n"], [114, "  }\n"], [115, "\n"], [116, "  # IMDSv2 required - blocks SSRF credential theft\n"], [117, "  metadata_options {\n"], [118, "    http_endpoint               = \"enabled\"\n"], [119, "    http_tokens                 = \"required\"\n"], [120, "    http_put_response_hop_limit = 1\n"], [121, "  }\n"], [122, "\n"], [123, "  # User data runs Ansible on first boot\n"], [124, "  user_data = base64encode(<<-EOF\n"], [125, "    #!/bin/bash\n"], [126, "    set -e\n"], [127, "\n"], [128, "    # Log everything\n"], [129, "    exec > >(tee /var/log/user-data.log) 2>&1\n"], [130, "    echo \"Starting OpenClaw setup at $(date)\"\n"], [131, "\n"], [132, "    # Install Ansible\n"], [133, "    apt-get update\n"], [134, "    apt-get install -y ansible git\n"], [135, "\n"], [136, "    # Clone OpenClaw Ansible repo\n"], [137, "    git clone https://github.com/openclaw/openclaw-ansible.git /opt/openclaw-ansible\n"], [138, "    cd /opt/openclaw-ansible\n"], [139, "\n"], [140, "    # Install Ansible collections\n"], [141, "    ansible-galaxy collection install -r requirements.yml\n"], [142, "\n"], [143, "    # Run playbook (non-interactive)\n"], [144, "    ansible-playbook playbook.yml --connection=local\n"], [145, "\n"], [146, "    echo \"OpenClaw setup completed at $(date)\"\n"], [147, "  EOF\n"], [148, "  )\n"], [149, "\n"], [150, "  # Enable detailed monitoring\n"], [151, "  monitoring = true\n"], [152, "\n"], [153, "  tags = {\n"], [154, "    Name = \"openclaw-instance\"\n"], [155, "  }\n"], [156, "\n"], [157, "  # Wait for IAM role\n"], [158, "  depends_on = [\n"], [159, "    aws_iam_role_policy_attachment.openclaw_ssm,\n"], [160, "    aws_iam_role_policy_attachment.openclaw_secrets\n"], [161, "  ]\n"], [162, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [93, 162], "resource": "aws_instance.openclaw", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-instance"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"instance_type": [{"type": "variable", "name": "instance_type", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "iam_instance_profile": [{"type": "resource", "name": "aws_iam_instance_profile.openclaw", "path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_54", "bc_check_id": "BC_AWS_NETWORKING_84", "check_name": "Ensure AWS CloudFront distribution is using secure SSL protocols for HTTPS communication", "check_result": {"result": "PASSED", "entity": {"aws_cloudfront_distribution": {"main": {"__end_line__": 170, "__start_line__": 116, "comment": ["OpenClaw secure distribution"], "default_cache_behavior": [{"allowed_methods": [["DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT"]], "cache_policy_id": ["data.aws_cloudfront_cache_policy.disabled.id"], "cached_methods": [["GET", "HEAD"]], "compress": [true], "origin_request_policy_id": ["data.aws_cloudfront_origin_request_policy.all_viewer.id"], "target_origin_id": ["alb-origin"], "viewer_protocol_policy": ["https-only"]}], "default_root_object": [""], "enabled": [true], "origin": [{"custom_origin_config": [{"http_port": [80], "https_port": [443], "origin_protocol_policy": ["http-only"], "origin_ssl_protocols": [["TLSv1.2"]]}], "domain_name": ["aws_lb.internal.dns_name"], "origin_id": ["alb-origin"]}], "price_class": ["PriceClass_100"], "restrictions": [{"geo_restriction": [{"locations": [["AU", "CA", "DE", "FR", "GB", "IE", "NL", "US"]], "restriction_type": ["whitelist"]}]}], "tags": [{"Name": "openclaw-distribution"}], "viewer_certificate": [{"cloudfront_default_certificate": [true]}], "web_acl_id": ["aws_wafv2_web_acl.main.arn"], "__address__": "aws_cloudfront_distribution.main"}}}, "evaluated_keys": ["origin/*/custom_origin_config/origin_ssl_protocols"]}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-54", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV2_AWS_19", "bc_check_id": "BC_AWS_NETWORKING_48", "check_name": "Ensure that all EIP addresses allocated to a VPC are attached to EC2 instances", "check_result": {"result": "PASSED", "entity": {"aws_eip": {"nat": {"__end_line__": 271, "__start_line__": 265, "domain": ["vpc"], "tags": [{"Name": "openclaw-nat-eip"}], "__address__": "aws_eip.nat", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["instance", "instance_id", "vpc", "domain", "resource_type"]}, "code_block": [[265, "resource \"aws_eip\" \"nat\" {\n"], [266, "  domain = \"vpc\"\n"], [267, "\n"], [268, "  tags = {\n"], [269, "    Name = \"openclaw-nat-eip\"\n"], [270, "  }\n"], [271, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [265, 271], "resource": "aws_eip.nat", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-nat-eip"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[274, "resource \"aws_nat_gateway\" \"main\" {\n"], [275, "  allocation_id = aws_eip.nat.id\n"], [276, "  subnet_id     = aws_subnet.public_a.id\n"], [277, "\n"], [278, "  tags = {\n"], [279, "    Name = \"openclaw-nat\"\n"], [280, "  }\n"], [281, "\n"], [282, "  depends_on = [aws_internet_gateway.main]\n"], [283, "}\n"]], "file_path": "/main.tf", "file_line_range": [274, 283], "resource": "aws_nat_gateway.main", "entity_tags": {"Name": "openclaw-nat"}, "evaluations": null, "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-all-eip-addresses-allocated-to-a-vpc-are-attached-to-ec2-instances", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV2_AWS_28", "bc_check_id": "BC_AWS_NETWORKING_58", "check_name": "Ensure public facing ALB are protected by WAF", "check_result": {"result": "PASSED", "entity": {"aws_lb": {"internal": {"__end_line__": 70, "__start_line__": 58, "drop_invalid_header_fields": [true], "enable_deletion_protection": [true], "internal": [true], "load_balancer_type": ["application"], "name": ["openclaw-internal-alb"], "security_groups": [["aws_security_group.alb.id"]], "subnets": [["aws_subnet.private_a.id", "aws_subnet.private_b.id"]], "tags": [{"Name": "openclaw-internal-alb"}], "__address__": "aws_lb.internal"}}}, "evaluated_keys": ["load_balancer_type", "internal", "resource_type"]}, "code_block": [[58, "resource \"aws_lb\" \"internal\" {\n"], [59, "  name                       = \"openclaw-internal-alb\"\n"], [60, "  internal                   = true # Not internet-facing\n"], [61, "  load_balancer_type         = \"application\"\n"], [62, "  security_groups            = [aws_security_group.alb.id]\n"], [63, "  subnets                    = [aws_subnet.private_a.id, aws_subnet.private_b.id]\n"], [64, "  enable_deletion_protection = true\n"], [65, "  drop_invalid_header_fields = true\n"], [66, "\n"], [67, "  tags = {\n"], [68, "    Name = \"openclaw-internal-alb\"\n"], [69, "  }\n"], [70, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [58, 70], "resource": "aws_lb.internal", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-internal-alb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-public-facing-alb-are-protected-by-waf", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"compliance": {"__end_line__": 178, "__start_line__": 171, "bucket_prefix": ["openclaw-compliance-"], "force_destroy": [true], "tags": [{"Name": "openclaw-compliance-bucket"}], "__address__": "aws_s3_bucket.compliance"}}}, "evaluated_keys": ["access_control_policy", "access_control_policy/grant/*/permission", "acl", "access_control_policy/grant/*/grantee/uri", "resource_type", "access_control_policy/grant"]}, "code_block": [[171, "resource \"aws_s3_bucket\" \"compliance\" {\n"], [172, "  bucket_prefix = \"openclaw-compliance-\"\n"], [173, "  force_destroy = true # Allow deletion in dev\n"], [174, "\n"], [175, "  tags = {\n"], [176, "    Name = \"openclaw-compliance-bucket\"\n"], [177, "  }\n"], [178, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [171, 178], "resource": "aws_s3_bucket.compliance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-compliance-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"openclaw": {"__end_line__": 44, "__start_line__": 25, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ec2.amazonaws.com"}}]}], "name": ["openclaw-ec2-role"], "tags": [{"Name": "openclaw-ec2-role"}], "__address__": "aws_iam_role.openclaw"}}}, "evaluated_keys": ["name", "arn", "managed_policy_arn", "policy_arn", "managed_policy_arns/*"]}, "code_block": [[25, "resource \"aws_iam_role\" \"openclaw\" {\n"], [26, "  name = \"openclaw-ec2-role\"\n"], [27, "\n"], [28, "  assume_role_policy = jsonencode({\n"], [29, "    Version = \"2012-10-17\"\n"], [30, "    Statement = [\n"], [31, "      {\n"], [32, "        Action = \"sts:AssumeRole\"\n"], [33, "        Effect = \"Allow\"\n"], [34, "        Principal = {\n"], [35, "          Service = \"ec2.amazonaws.com\"\n"], [36, "        }\n"], [37, "      }\n"], [38, "    ]\n"], [39, "  })\n"], [40, "\n"], [41, "  tags = {\n"], [42, "    Name = \"openclaw-ec2-role\"\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [25, 44], "resource": "aws_iam_role.openclaw", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ec2-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"openclaw_ssm": {"__end_line__": 55, "__start_line__": 52, "policy_arn": ["arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore"], "role": ["openclaw-ec2-role"], "__address__": "aws_iam_role_policy_attachment.openclaw_ssm"}}}, "evaluated_keys": ["name", "arn", "managed_policy_arn", "policy_arn", "managed_policy_arns/*"]}, "code_block": [[52, "resource \"aws_iam_role_policy_attachment\" \"openclaw_ssm\" {\n"], [53, "  role       = aws_iam_role.openclaw.name\n"], [54, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore\"\n"], [55, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [52, 55], "resource": "aws_iam_role_policy_attachment.openclaw_ssm", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.openclaw", "path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"janitor_lambda": {"__end_line__": 40, "__start_line__": 21, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "lambda.amazonaws.com"}}]}], "name": ["openclaw-janitor-lambda-role"], "tags": [{"Name": "openclaw-janitor-role"}], "__address__": "aws_iam_role.janitor_lambda"}}}, "evaluated_keys": ["name", "arn", "managed_policy_arn", "policy_arn", "managed_policy_arns/*"]}, "code_block": [[21, "resource \"aws_iam_role\" \"janitor_lambda\" {\n"], [22, "  name = \"openclaw-janitor-lambda-role\"\n"], [23, "\n"], [24, "  assume_role_policy = jsonencode({\n"], [25, "    Version = \"2012-10-17\"\n"], [26, "    Statement = [\n"], [27, "      {\n"], [28, "        Action = \"sts:AssumeRole\"\n"], [29, "        Effect = \"Allow\"\n"], [30, "        Principal = {\n"], [31, "          Service = \"lambda.amazonaws.com\"\n"], [32, "        }\n"], [33, "      }\n"], [34, "    ]\n"], [35, "  })\n"], [36, "\n"], [37, "  tags = {\n"], [38, "    Name = \"openclaw-janitor-role\"\n"], [39, "  }\n"], [40, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [21, 40], "resource": "aws_iam_role.janitor_lambda", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-janitor-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"flow_logs": {"__end_line__": 364, "__start_line__": 345, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "vpc-flow-logs.amazonaws.com"}}]}], "name": ["openclaw-flow-logs-role"], "tags": [{"Name": "openclaw-flow-logs-role"}], "__address__": "aws_iam_role.flow_logs", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["name", "arn", "managed_policy_arn", "policy_arn", "managed_policy_arns/*"]}, "code_block": [[345, "resource \"aws_iam_role\" \"flow_logs\" {\n"], [346, "  name = \"openclaw-flow-logs-role\"\n"], [347, "\n"], [348, "  assume_role_policy = jsonencode({\n"], [349, "    Version = \"2012-10-17\"\n"], [350, "    Statement = [\n"], [351, "      {\n"], [352, "        Action = \"sts:AssumeRole\"\n"], [353, "        Effect = \"Allow\"\n"], [354, "        Principal = {\n"], [355, "          Service = \"vpc-flow-logs.amazonaws.com\"\n"], [356, "        }\n"], [357, "      }\n"], [358, "    ]\n"], [359, "  })\n"], [360, "\n"], [361, "  tags = {\n"], [362, "    Name = \"openclaw-flow-logs-role\"\n"], [363, "  }\n"], [364, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [345, 364], "resource": "aws_iam_role.flow_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-flow-logs-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role": {"ssm_maintenance": {"__end_line__": 149, "__start_line__": 130, "assume_role_policy": [{"Version": "2012-10-17", "Statement": [{"Action": "sts:AssumeRole", "Effect": "Allow", "Principal": {"Service": "ssm.amazonaws.com"}}]}], "name": ["openclaw-ssm-maintenance-role"], "tags": [{"Name": "openclaw-ssm-maintenance-role"}], "__address__": "aws_iam_role.ssm_maintenance"}}}, "evaluated_keys": ["name", "arn", "managed_policy_arn", "policy_arn", "managed_policy_arns/*"]}, "code_block": [[130, "resource \"aws_iam_role\" \"ssm_maintenance\" {\n"], [131, "  name = \"openclaw-ssm-maintenance-role\"\n"], [132, "\n"], [133, "  assume_role_policy = jsonencode({\n"], [134, "    Version = \"2012-10-17\"\n"], [135, "    Statement = [\n"], [136, "      {\n"], [137, "        Action = \"sts:AssumeRole\"\n"], [138, "        Effect = \"Allow\"\n"], [139, "        Principal = {\n"], [140, "          Service = \"ssm.amazonaws.com\"\n"], [141, "        }\n"], [142, "      }\n"], [143, "    ]\n"], [144, "  })\n"], [145, "\n"], [146, "  tags = {\n"], [147, "    Name = \"openclaw-ssm-maintenance-role\"\n"], [148, "  }\n"], [149, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [130, 149], "resource": "aws_iam_role.ssm_maintenance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ssm-maintenance-role"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV2_AWS_56", "bc_check_id": "BC_AWS_IAM_75", "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"ssm_maintenance": {"__end_line__": 154, "__start_line__": 151, "policy_arn": ["arn:aws:iam::aws:policy/service-role/AmazonSSMMaintenanceWindowRole"], "role": ["openclaw-ssm-maintenance-role"], "__address__": "aws_iam_role_policy_attachment.ssm_maintenance"}}}, "evaluated_keys": ["name", "arn", "managed_policy_arn", "policy_arn", "managed_policy_arns/*"]}, "code_block": [[151, "resource \"aws_iam_role_policy_attachment\" \"ssm_maintenance\" {\n"], [152, "  role       = aws_iam_role.ssm_maintenance.name\n"], [153, "  policy_arn = \"arn:aws:iam::aws:policy/service-role/AmazonSSMMaintenanceWindowRole\"\n"], [154, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [151, 154], "resource": "aws_iam_role_policy_attachment.ssm_maintenance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-56", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "breadcrumbs": {"role": [{"type": "resource", "name": "aws_iam_role.ssm_maintenance", "path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_44", "bc_check_id": "BC_AWS_NETWORKING_80", "check_name": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"public": {"__end_line__": 252, "__start_line__": 241, "route": [{"cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.main.id"]}], "tags": [{"Name": "openclaw-public-rt"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_route_table.public", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["route/*/cidr_block", "route/*/ipv6_cidr_block", "route/*/vpc_peering_connection_id", "destination_ipv6_cidr_block", "vpc_peering_connection_id", "destination_cidr_block"]}, "code_block": [[241, "resource \"aws_route_table\" \"public\" {\n"], [242, "  vpc_id = aws_vpc.main.id\n"], [243, "\n"], [244, "  route {\n"], [245, "    cidr_block = \"0.0.0.0/0\"\n"], [246, "    gateway_id = aws_internet_gateway.main.id\n"], [247, "  }\n"], [248, "\n"], [249, "  tags = {\n"], [250, "    Name = \"openclaw-public-rt\"\n"], [251, "  }\n"], [252, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [241, 252], "resource": "aws_route_table.public", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-public-rt"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV2_AWS_44", "bc_check_id": "BC_AWS_NETWORKING_80", "check_name": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"private": {"__end_line__": 297, "__start_line__": 286, "route": [{"cidr_block": ["0.0.0.0/0"], "nat_gateway_id": ["aws_nat_gateway.main.id"]}], "tags": [{"Name": "openclaw-private-rt"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_route_table.private", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["route/*/cidr_block", "route/*/ipv6_cidr_block", "route/*/vpc_peering_connection_id", "destination_ipv6_cidr_block", "vpc_peering_connection_id", "destination_cidr_block"]}, "code_block": [[286, "resource \"aws_route_table\" \"private\" {\n"], [287, "  vpc_id = aws_vpc.main.id\n"], [288, "\n"], [289, "  route {\n"], [290, "    cidr_block     = \"0.0.0.0/0\"\n"], [291, "    nat_gateway_id = aws_nat_gateway.main.id\n"], [292, "  }\n"], [293, "\n"], [294, "  tags = {\n"], [295, "    Name = \"openclaw-private-rt\"\n"], [296, "  }\n"], [297, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [286, 297], "resource": "aws_route_table.private", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-private-rt"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "PASSED", "entity": {"aws_security_group": {"alb": {"__end_line__": 56, "__start_line__": 23, "description": ["Security group for internal ALB"], "egress": [{"cidr_blocks": [["10.0.0.0/16"]], "description": ["Allow outbound to OpenClaw EC2"], "from_port": [18789], "protocol": ["tcp"], "to_port": [18789]}], "ingress": [{"cidr_blocks": [["10.0.0.0/16"]], "description": ["HTTPS from VPC"], "from_port": [443], "protocol": ["tcp"], "to_port": [443]}, {"cidr_blocks": [["10.0.0.0/16"]], "description": ["HTTP from VPC"], "from_port": [80], "protocol": ["tcp"], "to_port": [80]}], "name": ["openclaw-alb-sg"], "tags": [{"Name": "openclaw-alb-sg"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_security_group.alb"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[23, "resource \"aws_security_group\" \"alb\" {\n"], [24, "  name        = \"openclaw-alb-sg\"\n"], [25, "  description = \"Security group for internal ALB\"\n"], [26, "  vpc_id      = aws_vpc.main.id\n"], [27, "\n"], [28, "  # Allow from CloudFront (VPC origin uses internal IPs)\n"], [29, "  ingress {\n"], [30, "    from_port   = 443\n"], [31, "    to_port     = 443\n"], [32, "    protocol    = \"tcp\"\n"], [33, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [34, "    description = \"HTTPS from VPC\"\n"], [35, "  }\n"], [36, "\n"], [37, "  ingress {\n"], [38, "    from_port   = 80\n"], [39, "    to_port     = 80\n"], [40, "    protocol    = \"tcp\"\n"], [41, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [42, "    description = \"HTTP from VPC\"\n"], [43, "  }\n"], [44, "\n"], [45, "  egress {\n"], [46, "    from_port   = 18789\n"], [47, "    to_port     = 18789\n"], [48, "    protocol    = \"tcp\"\n"], [49, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [50, "    description = \"Allow outbound to OpenClaw EC2\"\n"], [51, "  }\n"], [52, "\n"], [53, "  tags = {\n"], [54, "    Name = \"openclaw-alb-sg\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [23, 56], "resource": "aws_security_group.alb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-alb-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "breadcrumbs": {"egress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "egress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.1": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "PASSED", "entity": {"aws_security_group": {"openclaw": {"__end_line__": 68, "__start_line__": 24, "description": ["Security group for OpenClaw EC2"], "egress": [{"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTPS for API calls and package downloads"], "from_port": [443], "protocol": ["tcp"], "to_port": [443]}, {"cidr_blocks": [["0.0.0.0/0"]], "description": ["HTTP for package downloads"], "from_port": [80], "protocol": ["tcp"], "to_port": [80]}, {"cidr_blocks": [["0.0.0.0/0"]], "description": ["DNS queries"], "from_port": [53], "protocol": ["udp"], "to_port": [53]}], "ingress": [{"cidr_blocks": [["10.0.0.0/16"]], "description": ["OpenClaw gateway from VPC"], "from_port": [18789], "protocol": ["tcp"], "to_port": [18789]}], "name": ["openclaw-ec2-sg"], "tags": [{"Name": "openclaw-ec2-sg"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_security_group.openclaw"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[24, "resource \"aws_security_group\" \"openclaw\" {\n"], [25, "  name        = \"openclaw-ec2-sg\"\n"], [26, "  description = \"Security group for OpenClaw EC2\"\n"], [27, "  vpc_id      = aws_vpc.main.id\n"], [28, "\n"], [29, "  # Allow inbound from CloudFront (via VPC origin)\n"], [30, "  ingress {\n"], [31, "    from_port   = 18789\n"], [32, "    to_port     = 18789\n"], [33, "    protocol    = \"tcp\"\n"], [34, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [35, "    description = \"OpenClaw gateway from VPC\"\n"], [36, "  }\n"], [37, "\n"], [38, "  # HTTPS outbound for API calls\n"], [39, "  egress {\n"], [40, "    from_port   = 443\n"], [41, "    to_port     = 443\n"], [42, "    protocol    = \"tcp\"\n"], [43, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [44, "    description = \"HTTPS for API calls and package downloads\"\n"], [45, "  }\n"], [46, "\n"], [47, "  # HTTP outbound for package repos (some still use HTTP)\n"], [48, "  egress {\n"], [49, "    from_port   = 80\n"], [50, "    to_port     = 80\n"], [51, "    protocol    = \"tcp\"\n"], [52, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [53, "    description = \"HTTP for package downloads\"\n"], [54, "  }\n"], [55, "\n"], [56, "  # DNS for Route53 DNS Firewall\n"], [57, "  egress {\n"], [58, "    from_port   = 53\n"], [59, "    to_port     = 53\n"], [60, "    protocol    = \"udp\"\n"], [61, "    cidr_blocks = [\"0.0.0.0/0\"]\n"], [62, "    description = \"DNS queries\"\n"], [63, "  }\n"], [64, "\n"], [65, "  tags = {\n"], [66, "    Name = \"openclaw-ec2-sg\"\n"], [67, "  }\n"], [68, "}\n"]], "file_path": "/ec2.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "repo_file_path": "/ec2.tf", "file_line_range": [24, 68], "resource": "aws_security_group.openclaw", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-ec2-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ec2.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "PASSED", "entity": {"aws_security_group": {"vpc_endpoints": {"__end_line__": 129, "__start_line__": 113, "description": ["Allow HTTPS from VPC for AWS service endpoints"], "ingress": [{"cidr_blocks": [["10.0.0.0/16"]], "description": ["HTTPS from VPC"], "from_port": [443], "protocol": ["tcp"], "to_port": [443]}], "name": ["vpc-endpoints-sg"], "tags": [{"Name": "vpc-endpoints-sg"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_security_group.vpc_endpoints", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[113, "resource \"aws_security_group\" \"vpc_endpoints\" {\n"], [114, "  name        = \"vpc-endpoints-sg\"\n"], [115, "  description = \"Allow HTTPS from VPC for AWS service endpoints\"\n"], [116, "  vpc_id      = aws_vpc.main.id\n"], [117, "\n"], [118, "  ingress {\n"], [119, "    from_port   = 443\n"], [120, "    to_port     = 443\n"], [121, "    protocol    = \"tcp\"\n"], [122, "    cidr_blocks = [aws_vpc.main.cidr_block]\n"], [123, "    description = \"HTTPS from VPC\"\n"], [124, "  }\n"], [125, "\n"], [126, "  tags = {\n"], [127, "    Name = \"vpc-endpoints-sg\"\n"], [128, "  }\n"], [129, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [113, 129], "resource": "aws_security_group.vpc_endpoints", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "vpc-endpoints-sg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "breadcrumbs": {"ingress.cidr_blocks.0": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}], "ingress.cidr_blocks": [{"type": "resource", "name": "aws_vpc.main", "path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_76", "bc_check_id": null, "check_name": "Ensure AWS ALB attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability", "check_result": {"result": "PASSED", "entity": {"aws_lb": {"internal": {"__end_line__": 70, "__start_line__": 58, "drop_invalid_header_fields": [true], "enable_deletion_protection": [true], "internal": [true], "load_balancer_type": ["application"], "name": ["openclaw-internal-alb"], "security_groups": [["aws_security_group.alb.id"]], "subnets": [["aws_subnet.private_a.id", "aws_subnet.private_b.id"]], "tags": [{"Name": "openclaw-internal-alb"}], "__address__": "aws_lb.internal"}}}, "evaluated_keys": ["rule/*/statement/managed_rule_group_statement/name", "internal", "resource_type"]}, "code_block": [[58, "resource \"aws_lb\" \"internal\" {\n"], [59, "  name                       = \"openclaw-internal-alb\"\n"], [60, "  internal                   = true # Not internet-facing\n"], [61, "  load_balancer_type         = \"application\"\n"], [62, "  security_groups            = [aws_security_group.alb.id]\n"], [63, "  subnets                    = [aws_subnet.private_a.id, aws_subnet.private_b.id]\n"], [64, "  enable_deletion_protection = true\n"], [65, "  drop_invalid_header_fields = true\n"], [66, "\n"], [67, "  tags = {\n"], [68, "    Name = \"openclaw-internal-alb\"\n"], [69, "  }\n"], [70, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [58, 70], "resource": "aws_lb.internal", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-internal-alb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV2_AWS_35", "bc_check_id": "BC_AWS_NETWORKING_77", "check_name": "AWS NAT Gateways should be utilized for the default route", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"public": {"__end_line__": 252, "__start_line__": 241, "route": [{"cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.main.id"]}], "tags": [{"Name": "openclaw-public-rt"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_route_table.public", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["route/*/cidr_block", "route/*/instance_id", "instance_id", "destination_cidr_block"]}, "code_block": [[241, "resource \"aws_route_table\" \"public\" {\n"], [242, "  vpc_id = aws_vpc.main.id\n"], [243, "\n"], [244, "  route {\n"], [245, "    cidr_block = \"0.0.0.0/0\"\n"], [246, "    gateway_id = aws_internet_gateway.main.id\n"], [247, "  }\n"], [248, "\n"], [249, "  tags = {\n"], [250, "    Name = \"openclaw-public-rt\"\n"], [251, "  }\n"], [252, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [241, 252], "resource": "aws_route_table.public", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-public-rt"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV2_AWS_35", "bc_check_id": "BC_AWS_NETWORKING_77", "check_name": "AWS NAT Gateways should be utilized for the default route", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"private": {"__end_line__": 297, "__start_line__": 286, "route": [{"cidr_block": ["0.0.0.0/0"], "nat_gateway_id": ["aws_nat_gateway.main.id"]}], "tags": [{"Name": "openclaw-private-rt"}], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_route_table.private", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["route/*/cidr_block", "route/*/instance_id", "instance_id", "destination_cidr_block"]}, "code_block": [[286, "resource \"aws_route_table\" \"private\" {\n"], [287, "  vpc_id = aws_vpc.main.id\n"], [288, "\n"], [289, "  route {\n"], [290, "    cidr_block     = \"0.0.0.0/0\"\n"], [291, "    nat_gateway_id = aws_nat_gateway.main.id\n"], [292, "  }\n"], [293, "\n"], [294, "  tags = {\n"], [295, "    Name = \"openclaw-private-rt\"\n"], [296, "  }\n"], [297, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [286, 297], "resource": "aws_route_table.private", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-private-rt"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV2_AWS_74", "bc_check_id": "BC_AWS_NETWORKING_104", "check_name": "Ensure AWS Load Balancers use strong ciphers", "check_result": {"result": "PASSED", "entity": {"aws_lb_listener": {"http": {"__end_line__": 109, "__start_line__": 100, "default_action": [{"target_group_arn": ["aws_lb_target_group.openclaw.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.internal.arn"], "port": [80], "protocol": ["HTTP"], "__address__": "aws_lb_listener.http"}}}, "evaluated_keys": ["ssl_policy", "protocol"]}, "code_block": [[100, "resource \"aws_lb_listener\" \"http\" {\n"], [101, "  load_balancer_arn = aws_lb.internal.arn\n"], [102, "  port              = 80\n"], [103, "  protocol          = \"HTTP\"\n"], [104, "\n"], [105, "  default_action {\n"], [106, "    type             = \"forward\"\n"], [107, "    target_group_arn = aws_lb_target_group.openclaw.arn\n"], [108, "  }\n"], [109, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [100, 109], "resource": "aws_lb_listener.http", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-2-74", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"compliance": {"__end_line__": 178, "__start_line__": 171, "bucket_prefix": ["openclaw-compliance-"], "force_destroy": [true], "tags": [{"Name": "openclaw-compliance-bucket"}], "__address__": "aws_s3_bucket.compliance"}}}, "evaluated_keys": ["block_public_acls", "resource_type", "block_public_policy"]}, "code_block": [[171, "resource \"aws_s3_bucket\" \"compliance\" {\n"], [172, "  bucket_prefix = \"openclaw-compliance-\"\n"], [173, "  force_destroy = true # Allow deletion in dev\n"], [174, "\n"], [175, "  tags = {\n"], [176, "    Name = \"openclaw-compliance-bucket\"\n"], [177, "  }\n"], [178, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [171, 178], "resource": "aws_s3_bucket.compliance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-compliance-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[190, "resource \"aws_s3_bucket_public_access_block\" \"compliance\" {\n"], [191, "  bucket = aws_s3_bucket.compliance.id\n"], [192, "\n"], [193, "  block_public_acls       = true\n"], [194, "  block_public_policy     = true\n"], [195, "  ignore_public_acls      = true\n"], [196, "  restrict_public_buckets = true\n"], [197, "}\n"]], "file_path": "/ssm.tf", "file_line_range": [190, 197], "resource": "aws_s3_bucket_public_access_block.compliance", "entity_tags": {}, "evaluations": null, "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"compliance": {"__end_line__": 178, "__start_line__": 171, "bucket_prefix": ["openclaw-compliance-"], "force_destroy": [true], "tags": [{"Name": "openclaw-compliance-bucket"}], "__address__": "aws_s3_bucket.compliance"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[171, "resource \"aws_s3_bucket\" \"compliance\" {\n"], [172, "  bucket_prefix = \"openclaw-compliance-\"\n"], [173, "  force_destroy = true # Allow deletion in dev\n"], [174, "\n"], [175, "  tags = {\n"], [176, "    Name = \"openclaw-compliance-bucket\"\n"], [177, "  }\n"], [178, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [171, 178], "resource": "aws_s3_bucket.compliance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-compliance-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[180, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"compliance\" {\n"], [181, "  bucket = aws_s3_bucket.compliance.id\n"], [182, "\n"], [183, "  rule {\n"], [184, "    apply_server_side_encryption_by_default {\n"], [185, "      sse_algorithm = \"AES256\"\n"], [186, "    }\n"], [187, "  }\n"], [188, "}\n"]], "file_path": "/ssm.tf", "file_line_range": [180, 188], "resource": "aws_s3_bucket_server_side_encryption_configuration.compliance", "entity_tags": {}, "evaluations": null, "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": "BC_AWS_IAM_73", "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy": {"openclaw_secrets": {"__end_line__": 75, "__start_line__": 58, "description": ["Allow OpenClaw to read its API keys"], "name": ["openclaw-secrets-policy"], "policy": [{"Version": "2012-10-17", "Statement": [{"Sid": "GetSecretValue", "Effect": "Allow", "Action": ["secretsmanager:GetSecretValue"], "Resource": "aws_secretsmanager_secret.api_keys.arn"}]}], "__address__": "aws_iam_policy.openclaw_secrets"}}}, "evaluated_keys": ["policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]", "statement[?(@/effect == Allow)]/actions[*]"]}, "code_block": [[58, "resource \"aws_iam_policy\" \"openclaw_secrets\" {\n"], [59, "  name        = \"openclaw-secrets-policy\"\n"], [60, "  description = \"Allow OpenClaw to read its API keys\"\n"], [61, "\n"], [62, "  policy = jsonencode({\n"], [63, "    Version = \"2012-10-17\"\n"], [64, "    Statement = [\n"], [65, "      {\n"], [66, "        Sid    = \"GetSecretValue\"\n"], [67, "        Effect = \"Allow\"\n"], [68, "        Action = [\n"], [69, "          \"secretsmanager:GetSecretValue\"\n"], [70, "        ]\n"], [71, "        Resource = aws_secretsmanager_secret.api_keys.arn\n"], [72, "      }\n"], [73, "    ]\n"], [74, "  })\n"], [75, "}\n"]], "file_path": "/iam.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf", "repo_file_path": "/iam.tf", "file_line_range": [58, 75], "resource": "aws_iam_policy.openclaw_secrets", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/iam.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": "BC_AWS_IAM_73", "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy": {"janitor_lambda": {"__end_line__": 94, "__start_line__": 42, "name": ["openclaw-janitor-policy"], "policy": [{"Version": "2012-10-17", "Statement": [{"Sid": "EC2Operations", "Effect": "Allow", "Action": ["ec2:DescribeInstances", "ec2:StopInstances", "ec2:StartInstances"], "Resource": "*", "Condition": {"StringEquals": {"ec2:ResourceTag/Project": "hardened-openclaw"}}}, {"Sid": "CloudWatchLogs", "Effect": "Allow", "Action": ["logs:CreateLogGroup", "logs:CreateLogStream", "logs:PutLogEvents"], "Resource": "arn:aws:logs:*:*:*"}, {"Sid": "SSMRunCommand", "Effect": "Allow", "Action": ["ssm:SendCommand", "ssm:GetCommandInvocation"], "Resource": "*"}, {"Sid": "XRayTracing", "Effect": "Allow", "Action": ["xray:PutTraceSegments", "xray:PutTelemetryRecords"], "Resource": "*"}]}], "role": ["aws_iam_role.janitor_lambda.id"], "__address__": "aws_iam_role_policy.janitor_lambda"}}}, "evaluated_keys": ["policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]", "statement[?(@/effect == Allow)]/actions[*]"]}, "code_block": [[42, "resource \"aws_iam_role_policy\" \"janitor_lambda\" {\n"], [43, "  name = \"openclaw-janitor-policy\"\n"], [44, "  role = aws_iam_role.janitor_lambda.id\n"], [45, "\n"], [46, "  policy = jsonencode({\n"], [47, "    Version = \"2012-10-17\"\n"], [48, "    Statement = [\n"], [49, "      {\n"], [50, "        Sid    = \"EC2Operations\"\n"], [51, "        Effect = \"Allow\"\n"], [52, "        Action = [\n"], [53, "          \"ec2:DescribeInstances\",\n"], [54, "          \"ec2:StopInstances\",\n"], [55, "          \"ec2:StartInstances\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          StringEquals = {\n"], [60, "            \"ec2:ResourceTag/Project\" = \"hardened-openclaw\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"CloudWatchLogs\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Action = [\n"], [68, "          \"logs:CreateLogGroup\",\n"], [69, "          \"logs:CreateLogStream\",\n"], [70, "          \"logs:PutLogEvents\"\n"], [71, "        ]\n"], [72, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [73, "      },\n"], [74, "      {\n"], [75, "        Sid    = \"SSMRunCommand\"\n"], [76, "        Effect = \"Allow\"\n"], [77, "        Action = [\n"], [78, "          \"ssm:SendCommand\",\n"], [79, "          \"ssm:GetCommandInvocation\"\n"], [80, "        ]\n"], [81, "        Resource = \"*\"\n"], [82, "      },\n"], [83, "      {\n"], [84, "        Sid    = \"XRayTracing\"\n"], [85, "        Effect = \"Allow\"\n"], [86, "        Action = [\n"], [87, "          \"xray:PutTraceSegments\",\n"], [88, "          \"xray:PutTelemetryRecords\"\n"], [89, "        ]\n"], [90, "        Resource = \"*\"\n"], [91, "      }\n"], [92, "    ]\n"], [93, "  })\n"], [94, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [42, 94], "resource": "aws_iam_role_policy.janitor_lambda", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": "BC_AWS_IAM_73", "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy": {"flow_logs": {"__end_line__": 385, "__start_line__": 366, "name": ["openclaw-flow-logs-policy"], "policy": [{"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["logs:CreateLogStream", "logs:PutLogEvents", "logs:DescribeLogGroups", "logs:DescribeLogStreams"], "Resource": "aws_cloudwatch_log_group.flow_logs.arn:*"}]}], "role": ["aws_iam_role.flow_logs.id"], "__address__": "aws_iam_role_policy.flow_logs", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]", "statement[?(@/effect == Allow)]/actions[*]"]}, "code_block": [[366, "resource \"aws_iam_role_policy\" \"flow_logs\" {\n"], [367, "  name = \"openclaw-flow-logs-policy\"\n"], [368, "  role = aws_iam_role.flow_logs.id\n"], [369, "\n"], [370, "  policy = jsonencode({\n"], [371, "    Version = \"2012-10-17\"\n"], [372, "    Statement = [\n"], [373, "      {\n"], [374, "        Effect = \"Allow\"\n"], [375, "        Action = [\n"], [376, "          \"logs:CreateLogStream\",\n"], [377, "          \"logs:PutLogEvents\",\n"], [378, "          \"logs:DescribeLogGroups\",\n"], [379, "          \"logs:DescribeLogStreams\"\n"], [380, "        ]\n"], [381, "        Resource = \"${aws_cloudwatch_log_group.flow_logs.arn}:*\"\n"], [382, "      }\n"], [383, "    ]\n"], [384, "  })\n"], [385, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [366, 385], "resource": "aws_iam_role_policy.flow_logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-2-40", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV2_AWS_11", "bc_check_id": "BC_AWS_LOGGING_9", "check_name": "Ensure VPC flow logging is enabled in all VPCs", "check_result": {"result": "PASSED", "entity": {"aws_vpc": {"main": {"__end_line__": 66, "__start_line__": 56, "cidr_block": ["10.0.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "openclaw-vpc"}], "__address__": "aws_vpc.main", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[56, "resource \"aws_vpc\" \"main\" {\n"], [57, "  cidr_block = \"10.0.0.0/16\"\n"], [58, "\n"], [59, "  # DNS settings - needed for ECS service discovery\n"], [60, "  enable_dns_hostnames = true\n"], [61, "  enable_dns_support   = true\n"], [62, "\n"], [63, "  tags = {\n"], [64, "    Name = \"openclaw-vpc\"\n"], [65, "  }\n"], [66, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [56, 66], "resource": "aws_vpc.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[321, "resource \"aws_flow_log\" \"main\" {\n"], [322, "  vpc_id                   = aws_vpc.main.id\n"], [323, "  traffic_type             = \"ALL\" # ACCEPT, REJECT, or ALL\n"], [324, "  log_destination_type     = \"cloud-watch-logs\"\n"], [325, "  log_destination          = aws_cloudwatch_log_group.flow_logs.arn\n"], [326, "  iam_role_arn             = aws_iam_role.flow_logs.arn\n"], [327, "  max_aggregation_interval = 60 # 1 minute (or 600 for 10 min)\n"], [328, "\n"], [329, "  tags = {\n"], [330, "    Name = \"openclaw-vpc-flow-logs\"\n"], [331, "  }\n"], [332, "}\n"]], "file_path": "/main.tf", "file_line_range": [321, 332], "resource": "aws_flow_log.main", "entity_tags": {"Name": "openclaw-vpc-flow-logs"}, "evaluations": null, "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"compliance": {"__end_line__": 178, "__start_line__": 171, "bucket_prefix": ["openclaw-compliance-"], "force_destroy": [true], "tags": [{"Name": "openclaw-compliance-bucket"}], "__address__": "aws_s3_bucket.compliance"}}}, "evaluated_keys": ["access_control_policy", "acl", "access_control_policy/grant/*/grantee/uri", "resource_type", "access_control_policy/grant"]}, "code_block": [[171, "resource \"aws_s3_bucket\" \"compliance\" {\n"], [172, "  bucket_prefix = \"openclaw-compliance-\"\n"], [173, "  force_destroy = true # Allow deletion in dev\n"], [174, "\n"], [175, "  tags = {\n"], [176, "    Name = \"openclaw-compliance-bucket\"\n"], [177, "  }\n"], [178, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [171, 178], "resource": "aws_s3_bucket.compliance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-compliance-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV2_AWS_46", "bc_check_id": "BC_AWS_IAM_71", "check_name": "Ensure AWS CloudFront Distribution with S3 have Origin Access set to enabled", "check_result": {"result": "PASSED", "entity": {"aws_cloudfront_distribution": {"main": {"__end_line__": 170, "__start_line__": 116, "comment": ["OpenClaw secure distribution"], "default_cache_behavior": [{"allowed_methods": [["DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT"]], "cache_policy_id": ["data.aws_cloudfront_cache_policy.disabled.id"], "cached_methods": [["GET", "HEAD"]], "compress": [true], "origin_request_policy_id": ["data.aws_cloudfront_origin_request_policy.all_viewer.id"], "target_origin_id": ["alb-origin"], "viewer_protocol_policy": ["https-only"]}], "default_root_object": [""], "enabled": [true], "origin": [{"custom_origin_config": [{"http_port": [80], "https_port": [443], "origin_protocol_policy": ["http-only"], "origin_ssl_protocols": [["TLSv1.2"]]}], "domain_name": ["aws_lb.internal.dns_name"], "origin_id": ["alb-origin"]}], "price_class": ["PriceClass_100"], "restrictions": [{"geo_restriction": [{"locations": [["AU", "CA", "DE", "FR", "GB", "IE", "NL", "US"]], "restriction_type": ["whitelist"]}]}], "tags": [{"Name": "openclaw-distribution"}], "viewer_certificate": [{"cloudfront_default_certificate": [true]}], "web_acl_id": ["aws_wafv2_web_acl.main.arn"], "__address__": "aws_cloudfront_distribution.main"}}}, "evaluated_keys": ["origin/*/s3_origin_config", "origin/*/origin_access_control_id", "resource_type"]}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-aws-cloudfromt-distribution-with-s3-have-origin-access-set-to-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}], "failed_checks": [{"check_id": "CKV_AWS_91", "bc_check_id": "BC_AWS_LOGGING_22", "check_name": "Ensure the ELBv2 (Application/Network) has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["access_logs/0/enabled/0"]}, "code_block": [[58, "resource \"aws_lb\" \"internal\" {\n"], [59, "  name                       = \"openclaw-internal-alb\"\n"], [60, "  internal                   = true # Not internet-facing\n"], [61, "  load_balancer_type         = \"application\"\n"], [62, "  security_groups            = [aws_security_group.alb.id]\n"], [63, "  subnets                    = [aws_subnet.private_a.id, aws_subnet.private_b.id]\n"], [64, "  enable_deletion_protection = true\n"], [65, "  drop_invalid_header_fields = true\n"], [66, "\n"], [67, "  tags = {\n"], [68, "    Name = \"openclaw-internal-alb\"\n"], [69, "  }\n"], [70, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [58, 70], "resource": "aws_lb.internal", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ELBv2AccessLogs", "fixed_definition": null, "entity_tags": {"Name": "openclaw-internal-alb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-22", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_2", "bc_check_id": "BC_AWS_NETWORKING_29", "check_name": "Ensure ALB protocol is HTTPS", "check_result": {"result": "FAILED", "evaluated_keys": ["protocol"]}, "code_block": [[100, "resource \"aws_lb_listener\" \"http\" {\n"], [101, "  load_balancer_arn = aws_lb.internal.arn\n"], [102, "  port              = 80\n"], [103, "  protocol          = \"HTTP\"\n"], [104, "\n"], [105, "  default_action {\n"], [106, "    type             = \"forward\"\n"], [107, "    target_group_arn = aws_lb_target_group.openclaw.arn\n"], [108, "  }\n"], [109, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [100, 109], "resource": "aws_lb_listener.http", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBListenerHTTPS", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-29", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_86", "bc_check_id": "BC_AWS_LOGGING_20", "check_name": "Ensure CloudFront distribution has Access Logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["logging_config/[0]/bucket"]}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionLogging", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-20", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_174", "bc_check_id": "BC_AWS_NETWORKING_63", "check_name": "Verify CloudFront Distribution Viewer Certificate is using TLS v1.2 or higher", "check_result": {"result": "FAILED", "evaluated_keys": ["viewer_certificate/[0]/minimum_protocol_version"]}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontTLS12", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-63", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_310", "bc_check_id": "BC_AWS_GENERAL_222", "check_name": "Ensure CloudFront distributions should have origin failover configured", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionOriginFailover", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-310", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_305", "bc_check_id": "BC_AWS_GENERAL_219", "check_name": "Ensure CloudFront distribution has a default root object configured", "check_result": {"result": "FAILED", "evaluated_keys": ["default_root_object"]}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.CloudfrontDistributionDefaultRoot", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-305", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_355", "bc_check_id": "BC_AWS_IAM_88", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[2]/Action"]}, "code_block": [[42, "resource \"aws_iam_role_policy\" \"janitor_lambda\" {\n"], [43, "  name = \"openclaw-janitor-policy\"\n"], [44, "  role = aws_iam_role.janitor_lambda.id\n"], [45, "\n"], [46, "  policy = jsonencode({\n"], [47, "    Version = \"2012-10-17\"\n"], [48, "    Statement = [\n"], [49, "      {\n"], [50, "        Sid    = \"EC2Operations\"\n"], [51, "        Effect = \"Allow\"\n"], [52, "        Action = [\n"], [53, "          \"ec2:DescribeInstances\",\n"], [54, "          \"ec2:StopInstances\",\n"], [55, "          \"ec2:StartInstances\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          StringEquals = {\n"], [60, "            \"ec2:ResourceTag/Project\" = \"hardened-openclaw\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"CloudWatchLogs\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Action = [\n"], [68, "          \"logs:CreateLogGroup\",\n"], [69, "          \"logs:CreateLogStream\",\n"], [70, "          \"logs:PutLogEvents\"\n"], [71, "        ]\n"], [72, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [73, "      },\n"], [74, "      {\n"], [75, "        Sid    = \"SSMRunCommand\"\n"], [76, "        Effect = \"Allow\"\n"], [77, "        Action = [\n"], [78, "          \"ssm:SendCommand\",\n"], [79, "          \"ssm:GetCommandInvocation\"\n"], [80, "        ]\n"], [81, "        Resource = \"*\"\n"], [82, "      },\n"], [83, "      {\n"], [84, "        Sid    = \"XRayTracing\"\n"], [85, "        Effect = \"Allow\"\n"], [86, "        Action = [\n"], [87, "          \"xray:PutTraceSegments\",\n"], [88, "          \"xray:PutTelemetryRecords\"\n"], [89, "        ]\n"], [90, "        Resource = \"*\"\n"], [91, "      }\n"], [92, "    ]\n"], [93, "  })\n"], [94, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [42, 94], "resource": "aws_iam_role_policy.janitor_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV_AWS_290", "bc_check_id": "BC_AWS_IAM_85", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "FAILED", "evaluated_keys": ["policy/Statement/[2]/Action"]}, "code_block": [[42, "resource \"aws_iam_role_policy\" \"janitor_lambda\" {\n"], [43, "  name = \"openclaw-janitor-policy\"\n"], [44, "  role = aws_iam_role.janitor_lambda.id\n"], [45, "\n"], [46, "  policy = jsonencode({\n"], [47, "    Version = \"2012-10-17\"\n"], [48, "    Statement = [\n"], [49, "      {\n"], [50, "        Sid    = \"EC2Operations\"\n"], [51, "        Effect = \"Allow\"\n"], [52, "        Action = [\n"], [53, "          \"ec2:DescribeInstances\",\n"], [54, "          \"ec2:StopInstances\",\n"], [55, "          \"ec2:StartInstances\"\n"], [56, "        ]\n"], [57, "        Resource = \"*\"\n"], [58, "        Condition = {\n"], [59, "          StringEquals = {\n"], [60, "            \"ec2:ResourceTag/Project\" = \"hardened-openclaw\"\n"], [61, "          }\n"], [62, "        }\n"], [63, "      },\n"], [64, "      {\n"], [65, "        Sid    = \"CloudWatchLogs\"\n"], [66, "        Effect = \"Allow\"\n"], [67, "        Action = [\n"], [68, "          \"logs:CreateLogGroup\",\n"], [69, "          \"logs:CreateLogStream\",\n"], [70, "          \"logs:PutLogEvents\"\n"], [71, "        ]\n"], [72, "        Resource = \"arn:aws:logs:*:*:*\"\n"], [73, "      },\n"], [74, "      {\n"], [75, "        Sid    = \"SSMRunCommand\"\n"], [76, "        Effect = \"Allow\"\n"], [77, "        Action = [\n"], [78, "          \"ssm:SendCommand\",\n"], [79, "          \"ssm:GetCommandInvocation\"\n"], [80, "        ]\n"], [81, "        Resource = \"*\"\n"], [82, "      },\n"], [83, "      {\n"], [84, "        Sid    = \"XRayTracing\"\n"], [85, "        Effect = \"Allow\"\n"], [86, "        Action = [\n"], [87, "          \"xray:PutTraceSegments\",\n"], [88, "          \"xray:PutTelemetryRecords\"\n"], [89, "        ]\n"], [90, "        Resource = \"*\"\n"], [91, "      }\n"], [92, "    ]\n"], [93, "  })\n"], [94, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [42, 94], "resource": "aws_iam_role_policy.janitor_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf"}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["vpc_config"]}, "code_block": [[101, "resource \"aws_lambda_function\" \"docker_cleanup\" {\n"], [102, "  filename                       = data.archive_file.docker_cleanup.output_path\n"], [103, "  function_name                  = \"openclaw-docker-cleanup\"\n"], [104, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [105, "  handler                        = \"index.handler\"\n"], [106, "  source_code_hash               = data.archive_file.docker_cleanup.output_base64sha256\n"], [107, "  runtime                        = \"python3.11\"\n"], [108, "  timeout                        = 300\n"], [109, "  reserved_concurrent_executions = 1\n"], [110, "\n"], [111, "  tracing_config {\n"], [112, "    mode = \"Active\"\n"], [113, "  }\n"], [114, "\n"], [115, "  environment {\n"], [116, "    variables = {\n"], [117, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [118, "    }\n"], [119, "  }\n"], [120, "\n"], [121, "  tags = {\n"], [122, "    Name = \"openclaw-docker-cleanup\"\n"], [123, "  }\n"], [124, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [101, 124], "resource": "aws_lambda_function.docker_cleanup", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": {"Name": "openclaw-docker-cleanup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.docker_cleanup", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["dead_letter_config/[0]/target_arn"]}, "code_block": [[101, "resource \"aws_lambda_function\" \"docker_cleanup\" {\n"], [102, "  filename                       = data.archive_file.docker_cleanup.output_path\n"], [103, "  function_name                  = \"openclaw-docker-cleanup\"\n"], [104, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [105, "  handler                        = \"index.handler\"\n"], [106, "  source_code_hash               = data.archive_file.docker_cleanup.output_base64sha256\n"], [107, "  runtime                        = \"python3.11\"\n"], [108, "  timeout                        = 300\n"], [109, "  reserved_concurrent_executions = 1\n"], [110, "\n"], [111, "  tracing_config {\n"], [112, "    mode = \"Active\"\n"], [113, "  }\n"], [114, "\n"], [115, "  environment {\n"], [116, "    variables = {\n"], [117, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [118, "    }\n"], [119, "  }\n"], [120, "\n"], [121, "  tags = {\n"], [122, "    Name = \"openclaw-docker-cleanup\"\n"], [123, "  }\n"], [124, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [101, 124], "resource": "aws_lambda_function.docker_cleanup", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": {"Name": "openclaw-docker-cleanup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.docker_cleanup", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environmental variable", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_arn"]}, "code_block": [[101, "resource \"aws_lambda_function\" \"docker_cleanup\" {\n"], [102, "  filename                       = data.archive_file.docker_cleanup.output_path\n"], [103, "  function_name                  = \"openclaw-docker-cleanup\"\n"], [104, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [105, "  handler                        = \"index.handler\"\n"], [106, "  source_code_hash               = data.archive_file.docker_cleanup.output_base64sha256\n"], [107, "  runtime                        = \"python3.11\"\n"], [108, "  timeout                        = 300\n"], [109, "  reserved_concurrent_executions = 1\n"], [110, "\n"], [111, "  tracing_config {\n"], [112, "    mode = \"Active\"\n"], [113, "  }\n"], [114, "\n"], [115, "  environment {\n"], [116, "    variables = {\n"], [117, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [118, "    }\n"], [119, "  }\n"], [120, "\n"], [121, "  tags = {\n"], [122, "    Name = \"openclaw-docker-cleanup\"\n"], [123, "  }\n"], [124, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [101, 124], "resource": "aws_lambda_function.docker_cleanup", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Name": "openclaw-docker-cleanup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.docker_cleanup", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_272", "bc_check_id": "BC_AWS_General_201", "check_name": "Ensure AWS Lambda function is configured to validate code-signing", "check_result": {"result": "FAILED", "evaluated_keys": ["code_signing_config_arn"]}, "code_block": [[101, "resource \"aws_lambda_function\" \"docker_cleanup\" {\n"], [102, "  filename                       = data.archive_file.docker_cleanup.output_path\n"], [103, "  function_name                  = \"openclaw-docker-cleanup\"\n"], [104, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [105, "  handler                        = \"index.handler\"\n"], [106, "  source_code_hash               = data.archive_file.docker_cleanup.output_base64sha256\n"], [107, "  runtime                        = \"python3.11\"\n"], [108, "  timeout                        = 300\n"], [109, "  reserved_concurrent_executions = 1\n"], [110, "\n"], [111, "  tracing_config {\n"], [112, "    mode = \"Active\"\n"], [113, "  }\n"], [114, "\n"], [115, "  environment {\n"], [116, "    variables = {\n"], [117, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [118, "    }\n"], [119, "  }\n"], [120, "\n"], [121, "  tags = {\n"], [122, "    Name = \"openclaw-docker-cleanup\"\n"], [123, "  }\n"], [124, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [101, 124], "resource": "aws_lambda_function.docker_cleanup", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaCodeSigningConfigured", "fixed_definition": null, "entity_tags": {"Name": "openclaw-docker-cleanup"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.docker_cleanup", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["vpc_config"]}, "code_block": [[214, "resource \"aws_lambda_function\" \"patch_check\" {\n"], [215, "  filename                       = data.archive_file.patch_check.output_path\n"], [216, "  function_name                  = \"openclaw-patch-check\"\n"], [217, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [218, "  handler                        = \"index.handler\"\n"], [219, "  source_code_hash               = data.archive_file.patch_check.output_base64sha256\n"], [220, "  runtime                        = \"python3.11\"\n"], [221, "  timeout                        = 300\n"], [222, "  reserved_concurrent_executions = 1\n"], [223, "\n"], [224, "  tracing_config {\n"], [225, "    mode = \"Active\"\n"], [226, "  }\n"], [227, "\n"], [228, "  environment {\n"], [229, "    variables = {\n"], [230, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [231, "      SNS_TOPIC   = aws_sns_topic.alerts.arn\n"], [232, "    }\n"], [233, "  }\n"], [234, "\n"], [235, "  tags = {\n"], [236, "    Name = \"openclaw-patch-check\"\n"], [237, "  }\n"], [238, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [214, 238], "resource": "aws_lambda_function.patch_check", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": {"Name": "openclaw-patch-check"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.patch_check", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["dead_letter_config/[0]/target_arn"]}, "code_block": [[214, "resource \"aws_lambda_function\" \"patch_check\" {\n"], [215, "  filename                       = data.archive_file.patch_check.output_path\n"], [216, "  function_name                  = \"openclaw-patch-check\"\n"], [217, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [218, "  handler                        = \"index.handler\"\n"], [219, "  source_code_hash               = data.archive_file.patch_check.output_base64sha256\n"], [220, "  runtime                        = \"python3.11\"\n"], [221, "  timeout                        = 300\n"], [222, "  reserved_concurrent_executions = 1\n"], [223, "\n"], [224, "  tracing_config {\n"], [225, "    mode = \"Active\"\n"], [226, "  }\n"], [227, "\n"], [228, "  environment {\n"], [229, "    variables = {\n"], [230, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [231, "      SNS_TOPIC   = aws_sns_topic.alerts.arn\n"], [232, "    }\n"], [233, "  }\n"], [234, "\n"], [235, "  tags = {\n"], [236, "    Name = \"openclaw-patch-check\"\n"], [237, "  }\n"], [238, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [214, 238], "resource": "aws_lambda_function.patch_check", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": {"Name": "openclaw-patch-check"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.patch_check", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environmental variable", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_arn"]}, "code_block": [[214, "resource \"aws_lambda_function\" \"patch_check\" {\n"], [215, "  filename                       = data.archive_file.patch_check.output_path\n"], [216, "  function_name                  = \"openclaw-patch-check\"\n"], [217, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [218, "  handler                        = \"index.handler\"\n"], [219, "  source_code_hash               = data.archive_file.patch_check.output_base64sha256\n"], [220, "  runtime                        = \"python3.11\"\n"], [221, "  timeout                        = 300\n"], [222, "  reserved_concurrent_executions = 1\n"], [223, "\n"], [224, "  tracing_config {\n"], [225, "    mode = \"Active\"\n"], [226, "  }\n"], [227, "\n"], [228, "  environment {\n"], [229, "    variables = {\n"], [230, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [231, "      SNS_TOPIC   = aws_sns_topic.alerts.arn\n"], [232, "    }\n"], [233, "  }\n"], [234, "\n"], [235, "  tags = {\n"], [236, "    Name = \"openclaw-patch-check\"\n"], [237, "  }\n"], [238, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [214, 238], "resource": "aws_lambda_function.patch_check", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"Name": "openclaw-patch-check"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.patch_check", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_272", "bc_check_id": "BC_AWS_General_201", "check_name": "Ensure AWS Lambda function is configured to validate code-signing", "check_result": {"result": "FAILED", "evaluated_keys": ["code_signing_config_arn"]}, "code_block": [[214, "resource \"aws_lambda_function\" \"patch_check\" {\n"], [215, "  filename                       = data.archive_file.patch_check.output_path\n"], [216, "  function_name                  = \"openclaw-patch-check\"\n"], [217, "  role                           = aws_iam_role.janitor_lambda.arn\n"], [218, "  handler                        = \"index.handler\"\n"], [219, "  source_code_hash               = data.archive_file.patch_check.output_base64sha256\n"], [220, "  runtime                        = \"python3.11\"\n"], [221, "  timeout                        = 300\n"], [222, "  reserved_concurrent_executions = 1\n"], [223, "\n"], [224, "  tracing_config {\n"], [225, "    mode = \"Active\"\n"], [226, "  }\n"], [227, "\n"], [228, "  environment {\n"], [229, "    variables = {\n"], [230, "      INSTANCE_ID = aws_instance.openclaw.id\n"], [231, "      SNS_TOPIC   = aws_sns_topic.alerts.arn\n"], [232, "    }\n"], [233, "  }\n"], [234, "\n"], [235, "  tags = {\n"], [236, "    Name = \"openclaw-patch-check\"\n"], [237, "  }\n"], [238, "}\n"]], "file_path": "/janitor.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "repo_file_path": "/janitor.tf", "file_line_range": [214, 238], "resource": "aws_lambda_function.patch_check", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaCodeSigningConfigured", "fixed_definition": null, "entity_tags": {"Name": "openclaw-patch-check"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-272", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "breadcrumbs": {"filename": [{"type": "data", "name": "archive_file.patch_check", "path": "/home/runner/work/openclaw_env/openclaw_env/janitor.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[209, "resource \"aws_subnet\" \"public_a\" {\n"], [210, "  vpc_id                  = aws_vpc.main.id\n"], [211, "  cidr_block              = \"10.0.2.0/24\"\n"], [212, "  availability_zone       = \"${var.aws_region}a\"\n"], [213, "  map_public_ip_on_launch = true\n"], [214, "\n"], [215, "  tags = {\n"], [216, "    Name = \"openclaw-public-subnet-a\"\n"], [217, "  }\n"], [218, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [209, 218], "resource": "aws_subnet.public_a", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "openclaw-public-subnet-a"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "aws_region", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[220, "resource \"aws_subnet\" \"public_b\" {\n"], [221, "  vpc_id                  = aws_vpc.main.id\n"], [222, "  cidr_block              = \"10.0.4.0/24\"\n"], [223, "  availability_zone       = \"${var.aws_region}b\"\n"], [224, "  map_public_ip_on_launch = true\n"], [225, "\n"], [226, "  tags = {\n"], [227, "    Name = \"openclaw-public-subnet-b\"\n"], [228, "  }\n"], [229, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [220, 229], "resource": "aws_subnet.public_b", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "openclaw-public-subnet-b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "aws_region", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_378", "bc_check_id": "BC_AWS_NETWORKING_103", "check_name": "Ensure AWS Load Balancer doesn't use HTTP protocol", "check_result": {"result": "FAILED", "entity": {"aws_lb_target_group": {"openclaw": {"__end_line__": 92, "__start_line__": 72, "health_check": [{"enabled": [true], "healthy_threshold": [2], "interval": [30], "path": ["/health"], "protocol": ["HTTP"], "timeout": [5], "unhealthy_threshold": [3]}], "name": ["openclaw-tg"], "port": [18789], "protocol": ["HTTP"], "tags": [{"Name": "openclaw-tg"}], "target_type": ["instance"], "vpc_id": ["aws_vpc.main.id"], "__address__": "aws_lb_target_group.openclaw"}}}, "evaluated_keys": ["resource_type", "protocol"]}, "code_block": [[72, "resource \"aws_lb_target_group\" \"openclaw\" {\n"], [73, "  name        = \"openclaw-tg\"\n"], [74, "  port        = 18789\n"], [75, "  protocol    = \"HTTP\"\n"], [76, "  vpc_id      = aws_vpc.main.id\n"], [77, "  target_type = \"instance\"\n"], [78, "\n"], [79, "  health_check {\n"], [80, "    enabled             = true\n"], [81, "    healthy_threshold   = 2\n"], [82, "    unhealthy_threshold = 3\n"], [83, "    timeout             = 5\n"], [84, "    interval            = 30\n"], [85, "    path                = \"/health\"\n"], [86, "    protocol            = \"HTTP\"\n"], [87, "  }\n"], [88, "\n"], [89, "  tags = {\n"], [90, "    Name = \"openclaw-tg\"\n"], [91, "  }\n"], [92, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [72, 92], "resource": "aws_lb_target_group.openclaw", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-tg"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[100, "resource \"aws_lb_listener\" \"http\" {\n"], [101, "  load_balancer_arn = aws_lb.internal.arn\n"], [102, "  port              = 80\n"], [103, "  protocol          = \"HTTP\"\n"], [104, "\n"], [105, "  default_action {\n"], [106, "    type             = \"forward\"\n"], [107, "    target_group_arn = aws_lb_target_group.openclaw.arn\n"], [108, "  }\n"], [109, "}\n"]], "file_path": "/cloudfront.tf", "file_line_range": [100, 109], "resource": "aws_lb_listener.http", "entity_tags": {}, "evaluations": null, "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-378", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV2_AWS_31", "bc_check_id": "BC_AWS_LOGGING_33", "check_name": "Ensure WAF2 has a Logging Configuration", "check_result": {"result": "FAILED", "entity": {"aws_wafv2_web_acl": {"main": {"__end_line__": 300, "__start_line__": 189, "default_action": [{"allow": [{}]}], "description": ["WAF rules for OpenClaw"], "name": ["openclaw-waf"], "rule": [{"name": ["RateLimitRule"], "override_action": [{"none": [{}]}], "priority": [1], "statement": [{"rate_based_statement": [{"aggregate_key_type": ["IP"], "limit": [2000]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["RateLimitRule"], "sampled_requests_enabled": [true]}]}, {"name": ["AWSManagedRulesCommonRuleSet"], "override_action": [{"none": [{}]}], "priority": [2], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesCommonRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesCommonRuleSet"], "sampled_requests_enabled": [true]}]}, {"name": ["AWSManagedRulesKnownBadInputsRuleSet"], "override_action": [{"none": [{}]}], "priority": [3], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesKnownBadInputsRuleSet"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesKnownBadInputsRuleSet"], "sampled_requests_enabled": [true]}]}, {"name": ["AWSManagedRulesAmazonIpReputationList"], "override_action": [{"none": [{}]}], "priority": [4], "statement": [{"managed_rule_group_statement": [{"name": ["AWSManagedRulesAmazonIpReputationList"], "vendor_name": ["AWS"]}]}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["AWSManagedRulesAmazonIpReputationList"], "sampled_requests_enabled": [true]}]}], "scope": ["CLOUDFRONT"], "tags": [{"Name": "openclaw-waf"}], "visibility_config": [{"cloudwatch_metrics_enabled": [true], "metric_name": ["openclaw-waf"], "sampled_requests_enabled": [true]}], "__address__": "aws_wafv2_web_acl.main"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[189, "resource \"aws_wafv2_web_acl\" \"main\" {\n"], [190, "  name        = \"openclaw-waf\"\n"], [191, "  description = \"WAF rules for OpenClaw\"\n"], [192, "  scope       = \"CLOUDFRONT\"\n"], [193, "\n"], [194, "  # Default action - allow traffic that doesn't match any rules\n"], [195, "  default_action {\n"], [196, "    allow {}\n"], [197, "  }\n"], [198, "\n"], [199, "  # Rule 1: Rate limiting - prevent DDoS/brute force\n"], [200, "  rule {\n"], [201, "    name     = \"RateLimitRule\"\n"], [202, "    priority = 1\n"], [203, "\n"], [204, "    override_action {\n"], [205, "      none {}\n"], [206, "    }\n"], [207, "\n"], [208, "    statement {\n"], [209, "      rate_based_statement {\n"], [210, "        limit              = var.waf_rate_limit\n"], [211, "        aggregate_key_type = \"IP\"\n"], [212, "      }\n"], [213, "    }\n"], [214, "\n"], [215, "    visibility_config {\n"], [216, "      cloudwatch_metrics_enabled = true\n"], [217, "      metric_name                = \"RateLimitRule\"\n"], [218, "      sampled_requests_enabled   = true\n"], [219, "    }\n"], [220, "  }\n"], [221, "\n"], [222, "  # Rule 2: AWS Managed Common Rule Set\n"], [223, "  rule {\n"], [224, "    name     = \"AWSManagedRulesCommonRuleSet\"\n"], [225, "    priority = 2\n"], [226, "\n"], [227, "    override_action {\n"], [228, "      none {}\n"], [229, "    }\n"], [230, "\n"], [231, "    statement {\n"], [232, "      managed_rule_group_statement {\n"], [233, "        name        = \"AWSManagedRulesCommonRuleSet\"\n"], [234, "        vendor_name = \"AWS\"\n"], [235, "      }\n"], [236, "    }\n"], [237, "\n"], [238, "    visibility_config {\n"], [239, "      cloudwatch_metrics_enabled = true\n"], [240, "      metric_name                = \"AWSManagedRulesCommonRuleSet\"\n"], [241, "      sampled_requests_enabled   = true\n"], [242, "    }\n"], [243, "  }\n"], [244, "\n"], [245, "  # Rule 3: Known Bad Inputs\n"], [246, "  rule {\n"], [247, "    name     = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [248, "    priority = 3\n"], [249, "\n"], [250, "    override_action {\n"], [251, "      none {}\n"], [252, "    }\n"], [253, "\n"], [254, "    statement {\n"], [255, "      managed_rule_group_statement {\n"], [256, "        name        = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [257, "        vendor_name = \"AWS\"\n"], [258, "      }\n"], [259, "    }\n"], [260, "\n"], [261, "    visibility_config {\n"], [262, "      cloudwatch_metrics_enabled = true\n"], [263, "      metric_name                = \"AWSManagedRulesKnownBadInputsRuleSet\"\n"], [264, "      sampled_requests_enabled   = true\n"], [265, "    }\n"], [266, "  }\n"], [267, "\n"], [268, "  # Rule 4: IP Reputation\n"], [269, "  rule {\n"], [270, "    name     = \"AWSManagedRulesAmazonIpReputationList\"\n"], [271, "    priority = 4\n"], [272, "\n"], [273, "    override_action {\n"], [274, "      none {}\n"], [275, "    }\n"], [276, "\n"], [277, "    statement {\n"], [278, "      managed_rule_group_statement {\n"], [279, "        name        = \"AWSManagedRulesAmazonIpReputationList\"\n"], [280, "        vendor_name = \"AWS\"\n"], [281, "      }\n"], [282, "    }\n"], [283, "\n"], [284, "    visibility_config {\n"], [285, "      cloudwatch_metrics_enabled = true\n"], [286, "      metric_name                = \"AWSManagedRulesAmazonIpReputationList\"\n"], [287, "      sampled_requests_enabled   = true\n"], [288, "    }\n"], [289, "  }\n"], [290, "\n"], [291, "  visibility_config {\n"], [292, "    cloudwatch_metrics_enabled = true\n"], [293, "    metric_name                = \"openclaw-waf\"\n"], [294, "    sampled_requests_enabled   = true\n"], [295, "  }\n"], [296, "\n"], [297, "  tags = {\n"], [298, "    Name = \"openclaw-waf\"\n"], [299, "  }\n"], [300, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [189, 300], "resource": "aws_wafv2_web_acl.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-waf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-33", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "breadcrumbs": {"rule.0.statement.rate_based_statement.limit": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "rule.0.statement.rate_based_statement": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "rule.0.statement": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}], "rule.0": [{"type": "variable", "name": "waf_rate_limit", "path": "/home/runner/work/openclaw_env/openclaw_env/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_47", "bc_check_id": "BC_AWS_GENERAL_186", "check_name": "Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability", "check_result": {"result": "FAILED", "entity": {"aws_cloudfront_distribution": {"main": {"__end_line__": 170, "__start_line__": 116, "comment": ["OpenClaw secure distribution"], "default_cache_behavior": [{"allowed_methods": [["DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT"]], "cache_policy_id": ["data.aws_cloudfront_cache_policy.disabled.id"], "cached_methods": [["GET", "HEAD"]], "compress": [true], "origin_request_policy_id": ["data.aws_cloudfront_origin_request_policy.all_viewer.id"], "target_origin_id": ["alb-origin"], "viewer_protocol_policy": ["https-only"]}], "default_root_object": [""], "enabled": [true], "origin": [{"custom_origin_config": [{"http_port": [80], "https_port": [443], "origin_protocol_policy": ["http-only"], "origin_ssl_protocols": [["TLSv1.2"]]}], "domain_name": ["aws_lb.internal.dns_name"], "origin_id": ["alb-origin"]}], "price_class": ["PriceClass_100"], "restrictions": [{"geo_restriction": [{"locations": [["AU", "CA", "DE", "FR", "GB", "IE", "NL", "US"]], "restriction_type": ["whitelist"]}]}], "tags": [{"Name": "openclaw-distribution"}], "viewer_certificate": [{"cloudfront_default_certificate": [true]}], "web_acl_id": ["aws_wafv2_web_acl.main.arn"], "__address__": "aws_cloudfront_distribution.main"}}}, "evaluated_keys": ["rule/*/statement/managed_rule_group_statement/name", "resource_type"]}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-47", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"compliance": {"__end_line__": 178, "__start_line__": 171, "bucket_prefix": ["openclaw-compliance-"], "force_destroy": [true], "tags": [{"Name": "openclaw-compliance-bucket"}], "__address__": "aws_s3_bucket.compliance"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm"]}, "code_block": [[171, "resource \"aws_s3_bucket\" \"compliance\" {\n"], [172, "  bucket_prefix = \"openclaw-compliance-\"\n"], [173, "  force_destroy = true # Allow deletion in dev\n"], [174, "\n"], [175, "  tags = {\n"], [176, "    Name = \"openclaw-compliance-bucket\"\n"], [177, "  }\n"], [178, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [171, 178], "resource": "aws_s3_bucket.compliance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-compliance-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[180, "resource \"aws_s3_bucket_server_side_encryption_configuration\" \"compliance\" {\n"], [181, "  bucket = aws_s3_bucket.compliance.id\n"], [182, "\n"], [183, "  rule {\n"], [184, "    apply_server_side_encryption_by_default {\n"], [185, "      sse_algorithm = \"AES256\"\n"], [186, "    }\n"], [187, "  }\n"], [188, "}\n"]], "file_path": "/ssm.tf", "file_line_range": [180, 188], "resource": "aws_s3_bucket_server_side_encryption_configuration.compliance", "entity_tags": {}, "evaluations": null, "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV2_AWS_57", "bc_check_id": "BC_AWS_GENERAL_192", "check_name": "Ensure Secrets Manager secrets should have automatic rotation enabled", "check_result": {"result": "FAILED", "entity": {"aws_secretsmanager_secret": {"api_keys": {"__end_line__": 107, "__start_line__": 95, "description": ["API keys for OpenClaw (Anthropic, OpenAI)"], "kms_key_id": ["aws_kms_key.openclaw.arn"], "name": ["openclaw/api-keys"], "recovery_window_in_days": [7], "tags": [{"Name": "openclaw-api-keys"}], "__address__": "aws_secretsmanager_secret.api_keys"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[95, "resource \"aws_secretsmanager_secret\" \"api_keys\" {\n"], [96, "  name        = \"openclaw/api-keys\"\n"], [97, "  description = \"API keys for OpenClaw (Anthropic, OpenAI)\"\n"], [98, "  kms_key_id  = aws_kms_key.openclaw.arn\n"], [99, "\n"], [100, "  # Recovery window - how long you can recover a deleted secret\n"], [101, "  # Set to 7 days minimum (can't set to 0 for safety)\n"], [102, "  recovery_window_in_days = 7\n"], [103, "\n"], [104, "  tags = {\n"], [105, "    Name = \"openclaw-api-keys\"\n"], [106, "  }\n"], [107, "}\n"]], "file_path": "/secrets.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/secrets.tf", "repo_file_path": "/secrets.tf", "file_line_range": [95, 107], "resource": "aws_secretsmanager_secret.api_keys", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-api-keys"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-57", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/secrets.tf"}, {"check_id": "CKV2_AWS_62", "bc_check_id": "BC_AWS_LOGGING_36", "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"compliance": {"__end_line__": 178, "__start_line__": 171, "bucket_prefix": ["openclaw-compliance-"], "force_destroy": [true], "tags": [{"Name": "openclaw-compliance-bucket"}], "__address__": "aws_s3_bucket.compliance"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[171, "resource \"aws_s3_bucket\" \"compliance\" {\n"], [172, "  bucket_prefix = \"openclaw-compliance-\"\n"], [173, "  force_destroy = true # Allow deletion in dev\n"], [174, "\n"], [175, "  tags = {\n"], [176, "    Name = \"openclaw-compliance-bucket\"\n"], [177, "  }\n"], [178, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [171, 178], "resource": "aws_s3_bucket.compliance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-compliance-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"compliance": {"__end_line__": 178, "__start_line__": 171, "bucket_prefix": ["openclaw-compliance-"], "force_destroy": [true], "tags": [{"Name": "openclaw-compliance-bucket"}], "__address__": "aws_s3_bucket.compliance"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": [[171, "resource \"aws_s3_bucket\" \"compliance\" {\n"], [172, "  bucket_prefix = \"openclaw-compliance-\"\n"], [173, "  force_destroy = true # Allow deletion in dev\n"], [174, "\n"], [175, "  tags = {\n"], [176, "    Name = \"openclaw-compliance-bucket\"\n"], [177, "  }\n"], [178, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [171, 178], "resource": "aws_s3_bucket.compliance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-compliance-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV2_AWS_42", "bc_check_id": "BC_AWS_NETWORKING_79", "check_name": "Ensure AWS CloudFront distribution uses custom SSL certificate", "check_result": {"result": "FAILED", "entity": {"aws_cloudfront_distribution": {"main": {"__end_line__": 170, "__start_line__": 116, "comment": ["OpenClaw secure distribution"], "default_cache_behavior": [{"allowed_methods": [["DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT"]], "cache_policy_id": ["data.aws_cloudfront_cache_policy.disabled.id"], "cached_methods": [["GET", "HEAD"]], "compress": [true], "origin_request_policy_id": ["data.aws_cloudfront_origin_request_policy.all_viewer.id"], "target_origin_id": ["alb-origin"], "viewer_protocol_policy": ["https-only"]}], "default_root_object": [""], "enabled": [true], "origin": [{"custom_origin_config": [{"http_port": [80], "https_port": [443], "origin_protocol_policy": ["http-only"], "origin_ssl_protocols": [["TLSv1.2"]]}], "domain_name": ["aws_lb.internal.dns_name"], "origin_id": ["alb-origin"]}], "price_class": ["PriceClass_100"], "restrictions": [{"geo_restriction": [{"locations": [["AU", "CA", "DE", "FR", "GB", "IE", "NL", "US"]], "restriction_type": ["whitelist"]}]}], "tags": [{"Name": "openclaw-distribution"}], "viewer_certificate": [{"cloudfront_default_certificate": [true]}], "web_acl_id": ["aws_wafv2_web_acl.main.arn"], "__address__": "aws_cloudfront_distribution.main"}}}, "evaluated_keys": ["viewer_certificate/iam_certificate_id", "viewer_certificate/acm_certificate_arn"]}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-cloudfront-distribution-uses-custom-ssl-certificate", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV2_AWS_32", "bc_check_id": "BC_AWS_NETWORKING_65", "check_name": "Ensure CloudFront distribution has a response headers policy attached", "check_result": {"result": "FAILED", "entity": {"aws_cloudfront_distribution": {"main": {"__end_line__": 170, "__start_line__": 116, "comment": ["OpenClaw secure distribution"], "default_cache_behavior": [{"allowed_methods": [["DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT"]], "cache_policy_id": ["data.aws_cloudfront_cache_policy.disabled.id"], "cached_methods": [["GET", "HEAD"]], "compress": [true], "origin_request_policy_id": ["data.aws_cloudfront_origin_request_policy.all_viewer.id"], "target_origin_id": ["alb-origin"], "viewer_protocol_policy": ["https-only"]}], "default_root_object": [""], "enabled": [true], "origin": [{"custom_origin_config": [{"http_port": [80], "https_port": [443], "origin_protocol_policy": ["http-only"], "origin_ssl_protocols": [["TLSv1.2"]]}], "domain_name": ["aws_lb.internal.dns_name"], "origin_id": ["alb-origin"]}], "price_class": ["PriceClass_100"], "restrictions": [{"geo_restriction": [{"locations": [["AU", "CA", "DE", "FR", "GB", "IE", "NL", "US"]], "restriction_type": ["whitelist"]}]}], "tags": [{"Name": "openclaw-distribution"}], "viewer_certificate": [{"cloudfront_default_certificate": [true]}], "web_acl_id": ["aws_wafv2_web_acl.main.arn"], "__address__": "aws_cloudfront_distribution.main"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[116, "resource \"aws_cloudfront_distribution\" \"main\" {\n"], [117, "  enabled             = true\n"], [118, "  comment             = \"OpenClaw secure distribution\"\n"], [119, "  default_root_object = \"\"\n"], [120, "  price_class         = \"PriceClass_100\" # US, Canada, Europe only (cheapest)\n"], [121, "\n"], [122, "  # Origin - Internal ALB\n"], [123, "  origin {\n"], [124, "    domain_name = aws_lb.internal.dns_name\n"], [125, "    origin_id   = \"alb-origin\"\n"], [126, "\n"], [127, "    custom_origin_config {\n"], [128, "      http_port              = 80\n"], [129, "      https_port             = 443\n"], [130, "      origin_protocol_policy = \"http-only\" # ALB is internal, uses HTTP\n"], [131, "      origin_ssl_protocols   = [\"TLSv1.2\"]\n"], [132, "    }\n"], [133, "  }\n"], [134, "\n"], [135, "  # Default behavior - forward all requests to ALB\n"], [136, "  default_cache_behavior {\n"], [137, "    allowed_methods  = [\"DELETE\", \"GET\", \"HEAD\", \"OPTIONS\", \"PATCH\", \"POST\", \"PUT\"]\n"], [138, "    cached_methods   = [\"GET\", \"HEAD\"]\n"], [139, "    target_origin_id = \"alb-origin\"\n"], [140, "\n"], [141, "    # Don't cache - OpenClaw is dynamic\n"], [142, "    cache_policy_id          = data.aws_cloudfront_cache_policy.disabled.id\n"], [143, "    origin_request_policy_id = data.aws_cloudfront_origin_request_policy.all_viewer.id\n"], [144, "\n"], [145, "    viewer_protocol_policy = \"https-only\" # HTTPS enforced, HTTP rejected\n"], [146, "    compress               = true\n"], [147, "  }\n"], [148, "\n"], [149, "  # Use CloudFront's default certificate\n"], [150, "  # Note: minimum_protocol_version only applies with custom certificates (ACM)\n"], [151, "  # CloudFront default certificate enforces TLS 1.0+ but we document this limitation\n"], [152, "  viewer_certificate {\n"], [153, "    cloudfront_default_certificate = true\n"], [154, "  }\n"], [155, "\n"], [156, "  # Restrict to US, Canada, Europe for cost and security\n"], [157, "  restrictions {\n"], [158, "    geo_restriction {\n"], [159, "      restriction_type = \"whitelist\"\n"], [160, "      locations        = [\"US\", \"CA\", \"GB\", \"DE\", \"FR\", \"IE\", \"NL\", \"AU\"]\n"], [161, "    }\n"], [162, "  }\n"], [163, "\n"], [164, "  # Attach WAF\n"], [165, "  web_acl_id = aws_wafv2_web_acl.main.arn\n"], [166, "\n"], [167, "  tags = {\n"], [168, "    Name = \"openclaw-distribution\"\n"], [169, "  }\n"], [170, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [116, 170], "resource": "aws_cloudfront_distribution.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-distribution"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-65", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"compliance": {"__end_line__": 178, "__start_line__": 171, "bucket_prefix": ["openclaw-compliance-"], "force_destroy": [true], "tags": [{"Name": "openclaw-compliance-bucket"}], "__address__": "aws_s3_bucket.compliance"}}}, "evaluated_keys": ["versioning/enabled", "resource_type", "versioning_configuration/status"]}, "code_block": [[171, "resource \"aws_s3_bucket\" \"compliance\" {\n"], [172, "  bucket_prefix = \"openclaw-compliance-\"\n"], [173, "  force_destroy = true # Allow deletion in dev\n"], [174, "\n"], [175, "  tags = {\n"], [176, "    Name = \"openclaw-compliance-bucket\"\n"], [177, "  }\n"], [178, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [171, 178], "resource": "aws_s3_bucket.compliance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-compliance-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV2_AWS_12", "bc_check_id": "BC_AWS_NETWORKING_4", "check_name": "Ensure the default security group of every VPC restricts all traffic", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"main": {"__end_line__": 66, "__start_line__": 56, "cidr_block": ["10.0.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "openclaw-vpc"}], "__address__": "aws_vpc.main", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["egress/from_port", "ingress/self", "ingress/to_port", "egress/cidr_blocks", "egress/protocol", "resource_type", "ingress/protocol", "egress/to_port", "ingress/from_port"]}, "code_block": [[56, "resource \"aws_vpc\" \"main\" {\n"], [57, "  cidr_block = \"10.0.0.0/16\"\n"], [58, "\n"], [59, "  # DNS settings - needed for ECS service discovery\n"], [60, "  enable_dns_hostnames = true\n"], [61, "  enable_dns_support   = true\n"], [62, "\n"], [63, "  tags = {\n"], [64, "    Name = \"openclaw-vpc\"\n"], [65, "  }\n"], [66, "}\n"]], "file_path": "/main.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf", "repo_file_path": "/main.tf", "file_line_range": [56, 66], "resource": "aws_vpc.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-vpc"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/main.tf"}, {"check_id": "CKV2_AWS_61", "bc_check_id": "BC_AWS_LOGGING_35", "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"compliance": {"__end_line__": 178, "__start_line__": 171, "bucket_prefix": ["openclaw-compliance-"], "force_destroy": [true], "tags": [{"Name": "openclaw-compliance-bucket"}], "__address__": "aws_s3_bucket.compliance"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[171, "resource \"aws_s3_bucket\" \"compliance\" {\n"], [172, "  bucket_prefix = \"openclaw-compliance-\"\n"], [173, "  force_destroy = true # Allow deletion in dev\n"], [174, "\n"], [175, "  tags = {\n"], [176, "    Name = \"openclaw-compliance-bucket\"\n"], [177, "  }\n"], [178, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [171, 178], "resource": "aws_s3_bucket.compliance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-compliance-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"compliance": {"__end_line__": 178, "__start_line__": 171, "bucket_prefix": ["openclaw-compliance-"], "force_destroy": [true], "tags": [{"Name": "openclaw-compliance-bucket"}], "__address__": "aws_s3_bucket.compliance"}}}, "evaluated_keys": ["replication_configuration/rules/*/status", "resource_type", "rule/*/status"]}, "code_block": [[171, "resource \"aws_s3_bucket\" \"compliance\" {\n"], [172, "  bucket_prefix = \"openclaw-compliance-\"\n"], [173, "  force_destroy = true # Allow deletion in dev\n"], [174, "\n"], [175, "  tags = {\n"], [176, "    Name = \"openclaw-compliance-bucket\"\n"], [177, "  }\n"], [178, "}\n"]], "file_path": "/ssm.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf", "repo_file_path": "/ssm.tf", "file_line_range": [171, 178], "resource": "aws_s3_bucket.compliance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-compliance-bucket"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/ssm.tf"}, {"check_id": "CKV2_AWS_3", "bc_check_id": "BC_AWS_GENERAL_66", "check_name": "Ensure GuardDuty is enabled to specific org/region", "check_result": {"result": "FAILED", "entity": {"aws_guardduty_detector": {"main": {"__end_line__": 56, "__start_line__": 43, "datasources": [{"s3_logs": [{"enable": [true]}]}], "enable": [true], "tags": [{"Name": "openclaw-guardduty"}], "__address__": "aws_guardduty_detector.main"}}}, "evaluated_keys": ["auto_enable_organization_members", "enable", "auto_enable", "resource_type"]}, "code_block": [[43, "resource \"aws_guardduty_detector\" \"main\" {\n"], [44, "  enable = true\n"], [45, "\n"], [46, "  # S3 protection (if you add S3 later)\n"], [47, "  datasources {\n"], [48, "    s3_logs {\n"], [49, "      enable = true\n"], [50, "    }\n"], [51, "  }\n"], [52, "\n"], [53, "  tags = {\n"], [54, "    Name = \"openclaw-guardduty\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/monitoring.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf", "repo_file_path": "/monitoring.tf", "file_line_range": [43, 56], "resource": "aws_guardduty_detector.main", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-guardduty"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-guardduty-is-enabled-to-specific-orgregion", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/monitoring.tf"}, {"check_id": "CKV2_AWS_20", "bc_check_id": "BC_AWS_NETWORKING_49", "check_name": "Ensure that ALB redirects HTTP requests into HTTPS ones", "check_result": {"result": "FAILED", "entity": {"aws_lb": {"internal": {"__end_line__": 70, "__start_line__": 58, "drop_invalid_header_fields": [true], "enable_deletion_protection": [true], "internal": [true], "load_balancer_type": ["application"], "name": ["openclaw-internal-alb"], "security_groups": [["aws_security_group.alb.id"]], "subnets": [["aws_subnet.private_a.id", "aws_subnet.private_b.id"]], "tags": [{"Name": "openclaw-internal-alb"}], "__address__": "aws_lb.internal"}}}, "evaluated_keys": ["default_action/redirect/*/port", "default_action/redirect/*/protocol", "port", "resource_type", "default_action/type", "protocol"]}, "code_block": [[58, "resource \"aws_lb\" \"internal\" {\n"], [59, "  name                       = \"openclaw-internal-alb\"\n"], [60, "  internal                   = true # Not internet-facing\n"], [61, "  load_balancer_type         = \"application\"\n"], [62, "  security_groups            = [aws_security_group.alb.id]\n"], [63, "  subnets                    = [aws_subnet.private_a.id, aws_subnet.private_b.id]\n"], [64, "  enable_deletion_protection = true\n"], [65, "  drop_invalid_header_fields = true\n"], [66, "\n"], [67, "  tags = {\n"], [68, "    Name = \"openclaw-internal-alb\"\n"], [69, "  }\n"], [70, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [58, 70], "resource": "aws_lb.internal", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "openclaw-internal-alb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": {"code_block": [[100, "resource \"aws_lb_listener\" \"http\" {\n"], [101, "  load_balancer_arn = aws_lb.internal.arn\n"], [102, "  port              = 80\n"], [103, "  protocol          = \"HTTP\"\n"], [104, "\n"], [105, "  default_action {\n"], [106, "    type             = \"forward\"\n"], [107, "    target_group_arn = aws_lb_target_group.openclaw.arn\n"], [108, "  }\n"], [109, "}\n"]], "file_path": "/cloudfront.tf", "file_line_range": [100, 109], "resource": "aws_lb_listener.http", "entity_tags": {}, "evaluations": null, "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "resource_address": null}, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-alb-redirects-http-requests-into-https-ones", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}, {"check_id": "CKV_AWS_103", "bc_check_id": "BC_AWS_GENERAL_43", "check_name": "Ensure that load balancer is using at least TLS 1.2", "check_result": {"result": "FAILED", "entity": {"aws_lb_listener": {"http": {"__end_line__": 109, "__start_line__": 100, "default_action": [{"target_group_arn": ["aws_lb_target_group.openclaw.arn"], "type": ["forward"]}], "load_balancer_arn": ["aws_lb.internal.arn"], "port": [80], "protocol": ["HTTP"], "__address__": "aws_lb_listener.http"}}}, "evaluated_keys": ["load_balancer_type", "default_action/redirect/protocol", "ssl_policy", "resource_type", "default_action/type", "protocol"]}, "code_block": [[100, "resource \"aws_lb_listener\" \"http\" {\n"], [101, "  load_balancer_arn = aws_lb.internal.arn\n"], [102, "  port              = 80\n"], [103, "  protocol          = \"HTTP\"\n"], [104, "\n"], [105, "  default_action {\n"], [106, "    type             = \"forward\"\n"], [107, "    target_group_arn = aws_lb_target_group.openclaw.arn\n"], [108, "  }\n"], [109, "}\n"]], "file_path": "/cloudfront.tf", "file_abs_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf", "repo_file_path": "/cloudfront.tf", "file_line_range": [100, 109], "resource": "aws_lb_listener.http", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-43", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/openclaw_env/openclaw_env/cloudfront.tf"}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 147, "failed": 34, "skipped": 0, "parsing_errors": 0, "resource_count": 87, "checkov_version": "3.2.500"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}